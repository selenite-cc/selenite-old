{"version":3,"file":"js/addon-default-entry.js","sources":["webpack://GUI/./src/addons/addons/color-picker/style.css","webpack://GUI/./src/addons/addons/editor-comment-previews/userstyle.css","webpack://GUI/./src/addons/addons/editor-devtools/userscript.css","webpack://GUI/./src/addons/addons/editor-searchable-dropdowns/userscript.css","webpack://GUI/./src/addons/addons/folders/style.css","webpack://GUI/./src/addons/addons/onion-skinning/style.css","webpack://GUI/./src/addons/addons/pick-colors-from-stage/style.css","webpack://GUI/./src/addons/addons/editor-devtools/icon--close.svg","webpack://GUI/./src/addons/addons/folders/folder.svg","webpack://GUI/./src/addons/addons/onion-skinning/decrement.svg","webpack://GUI/./src/addons/addons/onion-skinning/increment.svg","webpack://GUI/./src/addons/addons/onion-skinning/settings.svg","webpack://GUI/./src/addons/addons/onion-skinning/toggle.svg","webpack://GUI/./src/addons/addons/bitmap-copy/_runtime_entry.js","webpack://GUI/./src/addons/addons/bitmap-copy/userscript.js","webpack://GUI/./src/addons/addons/block-cherry-picking/_runtime_entry.js","webpack://GUI/./src/addons/addons/block-cherry-picking/userscript.js","webpack://GUI/./src/addons/addons/block-duplicate/_runtime_entry.js","webpack://GUI/./src/addons/addons/block-duplicate/module.js","webpack://GUI/./src/addons/addons/block-duplicate/userscript.js","webpack://GUI/./src/addons/addons/block-switching/_runtime_entry.js","webpack://GUI/./src/addons/addons/block-switching/blockToDom.js","webpack://GUI/./src/addons/addons/block-switching/userscript.js","webpack://GUI/./src/addons/addons/color-picker/_runtime_entry.js","webpack://GUI/./src/addons/addons/color-picker/code-editor.js","webpack://GUI/./src/addons/addons/color-picker/userscript.js","webpack://GUI/./src/addons/addons/editor-comment-previews/_runtime_entry.js","webpack://GUI/./src/addons/addons/editor-comment-previews/userscript.js","webpack://GUI/./src/addons/addons/editor-devtools/BlockInstance.js","webpack://GUI/./src/addons/addons/editor-devtools/BlockItem.js","webpack://GUI/./src/addons/addons/editor-devtools/DevTools.js","webpack://GUI/./src/addons/addons/editor-devtools/DomHelpers.js","webpack://GUI/./src/addons/addons/editor-devtools/XML.js","webpack://GUI/./src/addons/addons/editor-devtools/_runtime_entry.js","webpack://GUI/./src/addons/addons/editor-devtools/blockly/BlockFlasher.js","webpack://GUI/./src/addons/addons/editor-devtools/blockly/UndoGroup.js","webpack://GUI/./src/addons/addons/editor-devtools/blockly/Utils.js","webpack://GUI/./src/addons/addons/editor-devtools/userscript.js","webpack://GUI/./src/addons/addons/editor-searchable-dropdowns/_runtime_entry.js","webpack://GUI/./src/addons/addons/editor-searchable-dropdowns/userscript.js","webpack://GUI/./src/addons/addons/folders/_runtime_entry.js","webpack://GUI/./src/addons/addons/folders/userscript.js","webpack://GUI/./src/addons/addons/move-to-top-bottom/_runtime_entry.js","webpack://GUI/./src/addons/addons/move-to-top-bottom/userscript.js","webpack://GUI/./src/addons/addons/onion-skinning/_runtime_entry.js","webpack://GUI/./src/addons/addons/onion-skinning/userscript.js","webpack://GUI/./src/addons/addons/pick-colors-from-stage/_runtime_entry.js","webpack://GUI/./src/addons/addons/pick-colors-from-stage/userscript.js","webpack://GUI/./src/addons/addons/rename-broadcasts/_runtime_entry.js","webpack://GUI/./src/addons/addons/rename-broadcasts/userscript.js","webpack://GUI/./src/addons/libraries/common/cs/normalize-color.js","webpack://GUI/./src/addons/libraries/common/cs/rate-limiter.js","webpack://GUI/./src/addons/libraries/thirdparty/cs/tinycolor-min.js"],"sourcesContent":["exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".sa-color-picker {\\n  display: flex;\\n}\\n\\n.sa-color-picker-code {\\n  margin: 8px 0;\\n}\\n\\n.sa-color-picker-paint {\\n  margin-top: 16px;\\n  margin-bottom: 4px;\\n}\\n\\n.sa-color-picker > .sa-color-picker-color {\\n  border: none;\\n  border-top-left-radius: 1rem;\\n  border-bottom-left-radius: 1rem;\\n  padding: 0;\\n  padding-left: 0.6rem;\\n  padding-right: 0.4rem;\\n  margin-left: 0.5rem;\\n  outline: none;\\n  box-sizing: border-box;\\n  width: 3rem;\\n  height: 2rem;\\n}\\n[theme=\\\"dark\\\"] .sa-color-picker > .sa-color-picker-color {\\n  background: var(--ui-secondary);\\n}\\n\\n.sa-color-picker > .sa-color-picker-text {\\n  box-sizing: border-box;\\n  width: calc(150px - 3rem);\\n  border-top-left-radius: 0;\\n  border-bottom-left-radius: 0;\\n}\\n\\n[dir=\\\"rtl\\\"] .sa-color-picker > .sa-color-picker-color {\\n  border-top-left-radius: 0;\\n  border-bottom-left-radius: 0;\\n  border-top-right-radius: 1rem;\\n  border-bottom-right-radius: 1rem;\\n  margin-left: 0;\\n  margin-right: 0.5rem;\\n}\\n\\n[dir=\\\"rtl\\\"] .sa-color-picker > .sa-color-picker-text {\\n  border-top-left-radius: 1rem;\\n  border-bottom-left-radius: 1rem;\\n  border-top-right-radius: 0;\\n  border-bottom-right-radius: 0;\\n}\\n\\nbody.sa-hide-eye-dropper-background div[class*=\\\"stage_color-picker-background\\\"] {\\n  /* Do not show eye dropper background if the color picker is \\\"fake\\\" */\\n  display: none;\\n}\\n\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".sa-comment-preview-outer {\\n  position: fixed;\\n  top: 0;\\n  left: 0;\\n  z-index: 100000000;\\n  pointer-events: none;\\n}\\n\\n.sa-comment-preview-inner {\\n  width: calc(200px - 16px);\\n  max-height: calc(132px - 8px);\\n  padding: 8px;\\n  overflow: hidden;\\n\\n  font-size: 12px;\\n  white-space: pre-wrap;\\n  pointer-events: none;\\n\\n  color: rgb(87, 94, 117);\\n  background-color: rgb(255 255 255 / 90%);\\n  border-style: none;\\n  border-radius: 8px;\\n  filter: drop-shadow(0px 5px 5px rgb(0 0 0 / 10%));\\n\\n  transform: perspective(200px);\\n}\\n\\n@supports (backdrop-filter: blur(16px)) {\\n  .sa-comment-preview-inner {\\n    background-color: rgb(255 255 255 / 75%);\\n    backdrop-filter: blur(16px);\\n  }\\n}\\n\\n.sa-comment-preview-fade {\\n  transition: opacity 0.1s, filter 0.1s, transform 0.1s linear;\\n}\\n\\n.sa-comment-preview-hidden {\\n  opacity: 0;\\n  filter: none;\\n  transform: perspective(200px) translateZ(-20px);\\n}\\n\\n.sa-comment-preview-reduce-transparency {\\n  background-color: rgb(255 255 255);\\n  backdrop-filter: none;\\n}\\n\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"#s3devToolBar {\\n  display: flex;\\n  white-space: nowrap;\\n  font-family: \\\"Helvetica Neue\\\", Helvetica, Arial, sans-serif;\\n  width: 100%;\\n}\\n\\n.s3devLabel {\\n  display: flex;\\n  width: 100%;\\n}\\n\\n.s3devLabel > label {\\n  /* padding instead of margin so clicking on the empty area will select the input */\\n  padding-left: 1.5em;\\n  padding-right: 1em;\\n  font-weight: bold;\\n  font-size: 0.625rem;\\n  user-select: none;\\n  cursor: default;\\n  white-space: nowrap;\\n  padding-top: 2px;\\n  line-height: 2;\\n}\\n\\n[dir=\\\"rtl\\\"] .s3devLabel > label {\\n  padding-right: 1.5em;\\n  padding-left: 1em;\\n}\\n\\n.s3devAction {\\n  transition: opacity 200ms ease-in;\\n  /*font-weight: bold;*/\\n  opacity: 0;\\n}\\n\\n.s3devLabel:hover .s3devAction {\\n  opacity: 0.7;\\n}\\n\\n/* Wrapper around find button and drop down */\\n.s3devWrap {\\n  overflow: visible;\\n  /*margin-left:3em;*/\\n  position: relative;\\n}\\n\\n#s3devFind {\\n  height: 2rem;\\n  width: 100%;\\n}\\n\\n/* We need to modify Scratch styles so that the place where the find bar is injected */\\n/* has actually correct size information, which is used to make the find bar not cover up controls */\\n[class*=\\\"gui_tab-list_\\\"] {\\n  width: 100%;\\n}\\n[class*=\\\"gui_tab_\\\"] {\\n  flex-grow: 0;\\n}\\n\\n/* Find Input Box */\\ninput.s3devInp {\\n  width: 100%;\\n  box-sizing: border-box !important;\\n  /* !important required for extension, because CSS injection method (and hence order) differs from addon */\\n  height: 1.5rem;\\n\\n  /* Change Scratch default styles */\\n  border-radius: 0.25rem;\\n  font-size: 0.75rem;\\n  padding-left: 0.4em;\\n}\\n[theme=\\\"dark\\\"] input.s3devInp {\\n  color: #eee;\\n  background: #3333;\\n}\\n[theme=\\\"dark\\\"] input.s3devInp:hover {\\n  background: #333;\\n}\\n\\ninput.s3devInp:focus {\\n  /* Change Scratch default styles */\\n  box-shadow: none;\\n}\\n\\n/* Drop down from find button */\\n.s3devDDOut {\\n  display: block;\\n  top: -6px;\\n  z-index: 100;\\n  width: 100%;\\n  max-width: 16em;\\n  position: relative;\\n  /*padding: 2.2em 0 0;*/\\n  /*background-color: white;*/\\n  padding: 4px;\\n}\\n\\n/* Drop down from find button */\\nul.s3devDD {\\n  display: none;\\n  position: relative;\\n  padding: 0.2em 0;\\n  font-size: 0.75rem;\\n  line-height: 1;\\n  overflow-y: auto;\\n  min-height: 128px;\\n  max-height: 65vh;\\n  user-select: none;\\n  max-width: 100%;\\n}\\n\\n.s3devDDOut.vis {\\n  position: absolute;\\n  width: 16em;\\n  /*box-shadow: 0 2px 3px rgba(0,0,0,0.3), 0 5px 8px rgba(0,0,0,0.2);*/\\n  box-shadow: 0px 0px 8px 1px rgba(0, 0, 0, 0.3);\\n  background-color: white;\\n  border: none;\\n  border-radius: 4px;\\n}\\n[theme=\\\"dark\\\"] .s3devDDOut.vis {\\n  background-color: #111;\\n  box-shadow: 0px 0px 0px 1px var(--ui-black-transparent);\\n}\\n\\n.s3devDDOut.vis ul.s3devDD {\\n  display: block;\\n  border: none;\\n}\\n\\n/* Drop down items */\\n.s3devDD > li {\\n  display: block;\\n  padding: 0.5em 0.3em;\\n  white-space: nowrap;\\n  margin: 0;\\n  font-weight: bold;\\n  text-overflow: ellipsis;\\n  overflow: hidden;\\n}\\n\\n.s3devDD > li > b {\\n  background-color: #aaffaa;\\n  color: black;\\n}\\n\\n/* Drop down items */\\n.s3devDD > li:hover,\\n.s3devDD > li.sel {\\n  color: white;\\n  cursor: pointer;\\n}\\n\\n#s3devDD > li::before {\\n  content: \\\"\\\\25CF   \\\"; /* ● */\\n}\\n\\n.define {\\n  color: rgb(255, 102, 128);\\n}\\n.define:hover,\\n.define.sel {\\n  background-color: rgb(255, 102, 128);\\n}\\n\\n.flag {\\n  color: #4cbf56;\\n}\\n.flag:hover,\\n.flag.sel {\\n  background-color: #4cbf56;\\n}\\n\\n.receive {\\n  color: rgb(255, 191, 0);\\n}\\n.receive:hover,\\n.receive.sel {\\n  background-color: rgb(255, 191, 0);\\n}\\n\\n.event {\\n  color: rgb(255, 191, 0);\\n}\\n.event:hover,\\n.event.sel {\\n  background-color: rgb(255, 191, 0);\\n}\\n\\n.var,\\n.VAR {\\n  color: rgb(255, 120, 26);\\n}\\n.var:hover,\\n.var.sel,\\n.VAR:hover,\\n.VAR.sel {\\n  background-color: rgb(255, 120, 26);\\n}\\n\\n.list,\\n.LIST {\\n  color: rgb(255, 102, 26);\\n}\\n.list:hover,\\n.list.sel,\\n.LIST:hover,\\n.LIST.sel {\\n  background-color: rgb(255, 102, 26);\\n}\\n\\n.costume {\\n  color: rgb(26, 66, 255);\\n}\\n.costume:hover,\\n.costume.sel {\\n  background-color: rgb(26, 66, 255);\\n}\\n\\n.operators {\\n  background-color: rgb(64, 191, 74);\\n  color: rgb(56, 148, 56);\\n}\\n.operators:hover,\\n.operators.sel {\\n  background-color: rgb(56, 148, 56);\\n}\\n\\n.data {\\n  background-color: rgb(255, 140, 26);\\n  color: rgb(219, 110, 0);\\n}\\n.data:hover,\\n.data.sel {\\n  background-color: rgb(219, 110, 0);\\n}\\n\\n.data-lists {\\n  background-color: rgb(255, 102, 26);\\n  color: rgb(255, 102, 26);\\n}\\n.data-lists:hover,\\n.data-lists.sel {\\n  background-color: rgb(207, 81, 20);\\n}\\n\\n.sensing {\\n  background-color: rgb(76, 191, 230);\\n  color: rgb(46, 142, 184);\\n}\\n.sensing:hover,\\n.sensing.sel {\\n  background-color: rgb(46, 142, 184);\\n}\\n\\n.looks {\\n  background-color: rgb(153, 102, 255);\\n  color: rgb(119, 77, 203);\\n}\\n.looks:hover,\\n.looks.sel {\\n  background-color: rgb(119, 77, 203);\\n}\\n\\n.sounds {\\n  background-color: rgb(214, 92, 214);\\n  color: rgb(189, 66, 189);\\n}\\n.sounds:hover,\\n.sounds.sel {\\n  background-color: rgb(189, 66, 189);\\n}\\n\\n.motion {\\n  background-color: rgb(76, 151, 255);\\n  color: rgb(51, 115, 204);\\n}\\n.motion:hover,\\n.motion.sel {\\n  background-color: rgb(51, 115, 204);\\n}\\n\\n.events {\\n  background-color: rgb(255, 213, 0);\\n  color: rgb(204, 153, 0);\\n}\\n.events:hover,\\n.events.sel {\\n  background-color: rgb(204, 153, 0);\\n}\\n\\n.control {\\n  background-color: rgb(255, 171, 25);\\n  color: rgb(207, 139, 23);\\n}\\n.control:hover,\\n.control.sel {\\n  background-color: rgb(207, 139, 23);\\n}\\n\\n.TurboWarp {\\n  background-color: #ff4c4c;\\n  color: rgb(207, 139, 23);\\n}\\n.TurboWarp:hover,\\n.TurboWarp.sel {\\n  background-color: #e64444;\\n}\\n\\n.null {\\n  background-color: rgb(255, 102, 128);\\n  color: rgb(255, 77, 106);\\n}\\n.null:hover,\\n.null.sel {\\n  background-color: rgb(255, 77, 106);\\n}\\n\\n.extension {\\n  background-color: rgb(15 189 140);\\n}\\n.extension:hover,\\n.extension.sel {\\n  background-color: rgb(11 158 117);\\n}\\n\\n/*.s3devDD>li.hat::before {                           content: '◠ ';}*/\\n/*.s3devDD>li.hat::before {                           content: '▲ ';}*/\\n/*.s3devDD>li.block::before {                         content: '■ ';}*/\\n/*.s3devDD>li.reporter::before {                      content: '● ';}*/\\n/*.s3devDD>li.boolean::before {                       content: '◆ ';}*/\\n\\n#s3devIDD > li {\\n  height: 19px;\\n  padding: 3px 8px;\\n  margin: 2px 0.3em;\\n  box-sizing: border-box;\\n  position: relative;\\n  color: white;\\n  font-weight: bold;\\n  width: min-content;\\n}\\n\\n.s3devDD > li.hat {\\n  border-radius: 14px 14px 3px 3px;\\n}\\n.s3devDD > li.block {\\n  border-radius: 3px;\\n}\\n.s3devDD > li.reporter {\\n  border-radius: 10px;\\n}\\n\\n.s3devDD > li.boolean {\\n  width: min-content;\\n}\\n.s3devDD > li.boolean::before {\\n  content: \\\"\\\";\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  width: 0;\\n  height: 0;\\n  border-right: 9px solid transparent;\\n  border-top: 9px solid white;\\n  border-bottom: 10px solid white;\\n}\\n.s3devDD > li.boolean::after {\\n  content: \\\"\\\";\\n  position: absolute;\\n  right: 0;\\n  top: 0;\\n  width: 0;\\n  height: 0;\\n  border-left: 9px solid transparent;\\n  border-top: 9px solid white;\\n  border-bottom: 10px solid white;\\n}\\n[theme=\\\"dark\\\"] .s3devDD > li.boolean::before {\\n  border-top-color: #111;\\n  border-bottom-color: #111;\\n}\\n[theme=\\\"dark\\\"] .s3devDD > li.boolean::after {\\n  border-top-color: #111;\\n  border-bottom-color: #111;\\n}\\n\\n#s3devOverlay {\\n  position: fixed;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  background-color: rgba(80, 80, 80, 0.5);\\n  z-index: 9999;\\n  padding: 10em;\\n  color: white;\\n  font-weight: bold;\\n}\\n\\n.s3devMulti {\\n  font-weight: normal;\\n  position: absolute;\\n  right: 0;\\n  white-space: nowrap;\\n  background-color: inherit;\\n  z-index: 1;\\n  padding: 0;\\n}\\n\\n.s3devNav {\\n  padding: 0 6px;\\n}\\n\\n.s3devNav:hover {\\n  color: #ffff80;\\n}\\n\\n.s3devAction {\\n  margin-left: 2em;\\n}\\n\\n@media screen and (max-width: 1180px) {\\n  .s3devAction {\\n    display: none;\\n  }\\n}\\n\\n.s3devHide {\\n  display: none;\\n}\\n\\n.s3dev-mi:hover {\\n  background-color: #d6e9f8;\\n}\\n[theme=\\\"dark\\\"] .s3dev-mi:hover {\\n  background-color: var(--ui-tertiary);\\n}\\n\\n#s3devHelpPop > div {\\n  box-sizing: border-box;\\n  width: 800px;\\n  height: 60vh;\\n  max-height: 800px;\\n  max-width: 85%;\\n  margin: auto;\\n  margin-top: 20vh;\\n}\\n\\n#s3devHelpPop [class*=\\\"modal_header-item-title\\\"] {\\n  margin: 0 -20rem 0 0;\\n}\\n#s3devHelpPop[dir=\\\"rtl\\\"] [class*=\\\"modal_header-item-title\\\"] {\\n  margin: 0 0 0 -20rem;\\n}\\n\\n#s3devHelpContent {\\n  height: calc(100% - 3.125rem);\\n  overflow-y: auto;\\n  padding: 1em 2em 4em;\\n  background-color: white;\\n  user-select: text;\\n}\\n[theme=\\\"dark\\\"] #s3devHelpPop > div {\\n  background: #111;\\n}\\n\\n#s3devFloatingBar {\\n  display: flex;\\n  white-space: nowrap;\\n  font-family: \\\"Helvetica Neue\\\", Helvetica, Arial, sans-serif;\\n\\n  position: absolute;\\n  min-width: 128px;\\n  background-color: white;\\n  border-radius: 4px;\\n  box-shadow: rgba(0, 0, 0, 0.3) 0 0 3px, rgba(0, 0, 0, 0.2) 0 3px 10px;\\n\\n  z-index: 999;\\n}\\n[theme=\\\"dark\\\"] #s3devFloatingBar {\\n  background-color: #111;\\n}\\n\\n#s3devInsertLabel {\\n  padding: 0;\\n  align-items: center;\\n}\\n\\n/* Drop down from find button */\\nul#s3devIDD {\\n  max-height: 200px;\\n  margin-bottom: 0;\\n}\\n\\n#s3devIDD > li > b {\\n  background-color: rgba(0, 0, 0, 0.6);\\n  color: white;\\n}\\n\\n[data-highlighted=\\\"true\\\"] {\\n  background-color: hsla(30, 100%, 55%, 1) !important; /* orange */\\n  color: white !important;\\n}\\n\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".u-dropdown-searchbar {\\n  width: 100%;\\n  box-sizing: border-box;\\n  /* based on styles for the title input */\\n  color: white;\\n  background-color: hsla(0, 100%, 100%, 0.25);\\n  border: 1px solid hsla(0, 0%, 0%, 0.15);\\n  padding: 0.5rem;\\n  outline: none;\\n  transition: 0.25s ease-out;\\n  font-size: 13px;\\n  font-weight: bold;\\n  border-radius: 4px;\\n}\\n.u-dropdown-searchbar:hover {\\n  background-color: hsla(0, 100%, 100%, 0.5);\\n}\\n.u-dropdown-searchbar:focus {\\n  background-color: white;\\n  color: black;\\n}\\n.blocklyDropDownDiv .goog-menu {\\n  overflow-x: hidden;\\n}\\n\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".sa-folders-contextmenu-item {\\n  max-width: 250px;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n}\\n\\n[sa-folders-context-type=\\\"folder\\\"] .react-contextmenu > :not(.sa-ctx-menu) {\\n  display: none;\\n}\\n\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".sa-onion-controls-container {\\n  display: flex;\\n  flex-direction: row;\\n  height: calc(1.95rem + 2px);\\n}\\n\\n.sa-onion-button {\\n  position: relative;\\n}\\n.sa-onion-button:focus-within {\\n  background-color: hsla(0, 100%, 65%, 0.2);\\n}\\n.sa-onion-button[data-enabled=\\\"true\\\"] {\\n  background-color: #ff4c4c;\\n}\\n\\n.sa-onion-settings {\\n  position: absolute;\\n  bottom: 0;\\n  right: 16px;\\n  /* based on the styles for the color dropdown */\\n  padding: 4px;\\n  border-radius: 4px;\\n  border: 1px solid #ddd;\\n  box-shadow: 0px 0px 8px 1px rgba(0, 0, 0, 0.3);\\n  transition-property: bottom, opacity;\\n  transition-duration: 500ms;\\n  transition-timing-function: cubic-bezier(0.23, 1, 0.32, 1);\\n  opacity: 0;\\n  pointer-events: none;\\n  background: white;\\n  color: black;\\n}\\n.sa-onion-settings[data-visible=\\\"true\\\"] {\\n  bottom: 16px;\\n  pointer-events: auto;\\n  opacity: 1;\\n}\\n[dir=\\\"rtl\\\"] .sa-onion-settings {\\n  right: initial;\\n  left: 24px;\\n}\\n.sa-onion-settings .sa-onion-button {\\n  border-color: #d9d9d9 !important; /* override dark mode */\\n}\\n\\n.sa-onion-settings-line {\\n  display: flex;\\n  justify-content: flex-end;\\n  align-items: baseline;\\n}\\n\\n.sa-onion-settings-input {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  width: 100%;\\n  height: 100%;\\n  box-sizing: border-box;\\n  text-align: center;\\n  border: 0;\\n  background: transparent;\\n  -moz-appearance: textfield;\\n  border: 0;\\n  outline: 0;\\n}\\n\\n.sa-onion-settings-input::-webkit-outer-spin-button,\\n.sa-onion-settings-input::-webkit-inner-spin-button {\\n  -webkit-appearance: none;\\n  margin: 0;\\n}\\n\\n.sa-onion-settings-tip {\\n  position: absolute;\\n  bottom: 0;\\n  transform: translateY(100%);\\n  right: 138px;\\n}\\n[dir=\\\"rtl\\\"] .sa-onion-settings-tip {\\n  right: 84px;\\n}\\n.sa-onion-settings-polygon {\\n  fill: white;\\n  stroke: #ddd;\\n}\\n\\n[theme=\\\"dark\\\"] .sa-onion-image[data-image=\\\"settings\\\"] {\\n  filter: invert(1);\\n}\\n[theme=\\\"dark\\\"] .sa-onion-image[data-image=\\\"increment\\\"] {\\n  filter: none;\\n}\\n[theme=\\\"dark\\\"] .sa-onion-image[data-image=\\\"decrement\\\"] {\\n  filter: none;\\n}\\n\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".sa-stage-color-picker-picking [class^=\\\"stage_color-picker-background_\\\"] {\\n  display: none;\\n}\\n\", \"\"]);\n\n// exports\n","export default \"data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA3LjQ4IDcuNDgiPjxkZWZzPjxzdHlsZT4uY2xzLTF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6MnB4O308L3N0eWxlPjwvZGVmcz48dGl0bGU+aWNvbi0tYWRkPC90aXRsZT48bGluZSBjbGFzcz0iY2xzLTEiIHgxPSIzLjc0IiB5MT0iNi40OCIgeDI9IjMuNzQiIHkyPSIxIi8+PGxpbmUgY2xhc3M9ImNscy0xIiB4MT0iMSIgeTE9IjMuNzQiIHgyPSI2LjQ4IiB5Mj0iMy43NCIvPjwvc3ZnPg==\"","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjQiIHdpZHRoPSIyNCI+PHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGQ9Ik0xMCA0SDRjLTEuMSAwLTEuOTkuOS0xLjk5IDJMMiAxOGMwIDEuMS45IDIgMiAyaDE2YzEuMSAwIDItLjkgMi0yVjhjMC0xLjEtLjktMi0yLTJoLThsLTItMnoiLz48L3N2Zz4=\"","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PHBhdGggc3R5bGU9ImZpbGw6IzU3NWU3NTtzdHJva2Utd2lkdGg6LjczNDczNiIgZD0iTTMuMjUgMTEuMzU4aDE3LjUwMXYxLjI4NUgzLjI1eiIvPjwvc3ZnPg==\"","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjQiIHdpZHRoPSIyNCI+PHBhdGggc3R5bGU9ImZpbGw6IzU3NWU3NTtzdHJva2Utd2lkdGg6LjczNDczNiIgZD0iTTMuMjUgMTEuMzU4aDE3LjUwMXYxLjI4NUgzLjI1eiIvPjxwYXRoIHRyYW5zZm9ybT0icm90YXRlKDkwKSIgc3R5bGU9ImZpbGw6IzU3NWU3NTtzdHJva2Utd2lkdGg6LjczNDczNiIgZD0iTTMuMjUtMTIuNjQyaDE3LjUwMXYxLjI4NUgzLjI1eiIvPjwvc3ZnPg==\"","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PHBhdGggc3R5bGU9Im9wYWNpdHk6Ljc1O2ZpbGw6bm9uZTtzdHJva2U6IzAwMDtzdHJva2Utd2lkdGg6NDtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MSIgZD0iTTU2IDE2djk2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMi4zNzYgLTIuMzc2KSBzY2FsZSguMjI0NjIpIi8+PHBhdGggc3R5bGU9Im9wYWNpdHk6LjU7ZmlsbDpub25lO3N0cm9rZTojMDAwO3N0cm9rZS13aWR0aDo0O3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2Utb3BhY2l0eToxIiBkPSJNNDAgMzJ2NjQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yLjM3NiAtMi4zNzYpIHNjYWxlKC4yMjQ2MikiLz48cGF0aCBzdHlsZT0ib3BhY2l0eTouMjU7ZmlsbDpub25lO3N0cm9rZTojMDAwO3N0cm9rZS13aWR0aDo0O3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2Utb3BhY2l0eToxIiBkPSJNMjQgNDh2MzIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yLjM3NiAtMi4zNzYpIHNjYWxlKC4yMjQ2MikiLz48cGF0aCBzdHlsZT0ib3BhY2l0eTouNzU7ZmlsbDpub25lO3N0cm9rZTojMDAwO3N0cm9rZS13aWR0aDo0O3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2Utb3BhY2l0eToxIiBkPSJNNzIgMTZ2OTYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yLjM3NiAtMi4zNzYpIHNjYWxlKC4yMjQ2MikiLz48cGF0aCBzdHlsZT0ib3BhY2l0eTouNTtmaWxsOm5vbmU7c3Ryb2tlOiMwMDA7c3Ryb2tlLXdpZHRoOjQ7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1vcGFjaXR5OjEiIGQ9Ik04OCAzMnY2NCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTIuMzc2IC0yLjM3Nikgc2NhbGUoLjIyNDYyKSIvPjxwYXRoIHN0eWxlPSJvcGFjaXR5Oi4yNTtmaWxsOm5vbmU7c3Ryb2tlOiMwMDA7c3Ryb2tlLXdpZHRoOjQ7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1vcGFjaXR5OjEiIGQ9Ik0xMDQgNDh2MzIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yLjM3NiAtMi4zNzYpIHNjYWxlKC4yMjQ2MikiLz48L3N2Zz4=\"","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PGcgc3Ryb2tlLXdpZHRoPSIxLjIiIHN0cm9rZT0iIzAwMTAyNiI+PGcgc3R5bGU9Im9wYWNpdHk6LjU7c3Ryb2tlLXdpZHRoOjQ7c3Ryb2tlLW1pdGVybGltaXQ6MTA7c3Ryb2tlLWRhc2hhcnJheTpub25lIj48cGF0aCBzdHlsZT0ibWl4LWJsZW5kLW1vZGU6bm9ybWFsO2ZpbGw6bm9uZTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2Utd2lkdGg6NDtzdHJva2UtbWl0ZXJsaW1pdDoxMDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MCIgZmlsbD0iI2JmYmZiZiIgZD0iTTY4LjQ1IDMyLjQ1N2MuMy0uMi44LS4xLjkuM2wyLjYgMTAuN3M2LjQgNC43IDguMyA4YzMuMiA1LjUgMy4zIDEwIDMuMyAxMHM3LjEgMi4xIDguMyA3LjhjMS4yIDUuNy0zLjIgMTYuNS0yMiAyMC4yLTE4LjggMy43LTMzLjktMS40LTQxLTEyLjgtNy4xLTExLjQgNC4xLTI1IDMuNS0yNC4ybC0yLjEtMTcuOWMtLjEtLjQuNC0uNy44LS41bDEyLjEgNy45czQuNS0xLjcgOS4yLTEuOWMyLjgtLjIgNS4yIDAgNy41LjR6IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNC42NTIgLTQuNjUpIHNjYWxlKC4yMzI5KSIvPjxwYXRoIHN0eWxlPSJtaXgtYmxlbmQtbW9kZTpub3JtYWw7ZmlsbDpub25lO2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZS13aWR0aDo0O3N0cm9rZS1taXRlcmxpbWl0OjEwO3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2UtZGFzaG9mZnNldDowIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGZpbGw9Im5vbmUiIGQ9Ik0xMDEuNjUgNjIuOTU3Yy00LjcgMy44LTExLjkgMy45LTExLjkgMy45bTEwLjYgNy4zYy02LjMuNS0xMC4yLTEuNC0xMC4yLTEuNG0tNjguOC0xMC4xczguNiAyLjggMTIuMSA1LjltLjMgMy41Yy00LjMgMS43LTExLjcuNi0xMS43LjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC00LjY1MiAtNC42NSkgc2NhbGUoLjIzMjkpIi8+PC9nPjxnIHN0eWxlPSJvcGFjaXR5Oi43NTtzdHJva2Utd2lkdGg6NDtzdHJva2UtbWl0ZXJsaW1pdDoxMDtzdHJva2UtZGFzaGFycmF5Om5vbmUiPjxwYXRoIHN0eWxlPSJtaXgtYmxlbmQtbW9kZTpub3JtYWw7ZmlsbDpub25lO2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZS13aWR0aDo0O3N0cm9rZS1taXRlcmxpbWl0OjEwO3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2UtZGFzaG9mZnNldDowIiBmaWxsPSIjYmZiZmJmIiBkPSJNNjguNDUgMzIuNDU3Yy4zLS4yLjgtLjEuOS4zbDIuNiAxMC43czYuNCA0LjcgOC4zIDhjMy4yIDUuNSAzLjMgMTAgMy4zIDEwczcuMSAyLjEgOC4zIDcuOGMxLjIgNS43LTMuMiAxNi41LTIyIDIwLjItMTguOCAzLjctMzMuOS0xLjQtNDEtMTIuOC03LjEtMTEuNCA0LjEtMjUgMy41LTI0LjJsLTIuMS0xNy45Yy0uMS0uNC40LS43LjgtLjVsMTIuMSA3LjlzNC41LTEuNyA5LjItMS45YzIuOC0uMiA1LjIgMCA3LjUuNHoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yLjMyMyAtMi4zMjEpIHNjYWxlKC4yMzI5KSIvPjxwYXRoIHN0eWxlPSJtaXgtYmxlbmQtbW9kZTpub3JtYWw7ZmlsbDpub25lO2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZS13aWR0aDo0O3N0cm9rZS1taXRlcmxpbWl0OjEwO3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2UtZGFzaG9mZnNldDowIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGZpbGw9Im5vbmUiIGQ9Ik0xMDEuNjUgNjIuOTU3Yy00LjcgMy44LTExLjkgMy45LTExLjkgMy45bTEwLjYgNy4zYy02LjMuNS0xMC4yLTEuNC0xMC4yLTEuNG0tNjguOC0xMC4xczguNiAyLjggMTIuMSA1LjltLjMgMy41Yy00LjMgMS43LTExLjcuNi0xMS43LjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yLjMyMyAtMi4zMjEpIHNjYWxlKC4yMzI5KSIvPjwvZz48ZyBzdHlsZT0ic3Ryb2tlLXdpZHRoOjQ7c3Ryb2tlLW1pdGVybGltaXQ6MTA7c3Ryb2tlLWRhc2hhcnJheTpub25lIj48cGF0aCBzdHlsZT0ibWl4LWJsZW5kLW1vZGU6bm9ybWFsO2ZpbGw6I2ZmZjtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2Utd2lkdGg6NDtzdHJva2UtbWl0ZXJsaW1pdDoxMDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MCIgZmlsbD0iI2JmYmZiZiIgZD0iTTczLjQ1IDM3LjQ1N2MuMy0uMi44LS4xLjkuM2wyLjYgMTAuN3M2LjQgNC43IDguMyA4YzMuMiA1LjUgMy4zIDEwIDMuMyAxMHM3LjEgMi4xIDguMyA3LjhjMS4yIDUuNy0zLjIgMTYuNS0yMiAyMC4yLTE4LjggMy43LTMzLjktMS40LTQxLTEyLjgtNy4xLTExLjQgNC4xLTI1IDMuNS0yNC4ybC0yLjEtMTcuOWMtLjEtLjQuNC0uNy44LS41bDEyLjEgNy45czQuNS0xLjcgOS4yLTEuOWMyLjgtLjIgNS4yIDAgNy41LjR6IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMS4xNTkgLTEuMTU3KSBzY2FsZSguMjMyOSkiLz48cGF0aCBzdHlsZT0ibWl4LWJsZW5kLW1vZGU6bm9ybWFsO2ZpbGw6bm9uZTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2Utd2lkdGg6NDtzdHJva2UtbWl0ZXJsaW1pdDoxMDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBmaWxsPSJub25lIiBkPSJNMTA2LjY1IDY3Ljk1N2MtNC43IDMuOC0xMS45IDMuOS0xMS45IDMuOW0xMC42IDcuM2MtNi4zLjUtMTAuMi0xLjQtMTAuMi0xLjRtLTY4LjgtMTAuMXM4LjYgMi44IDEyLjEgNS45bS4zIDMuNWMtNC4zIDEuNy0xMS43LjYtMTEuNy42IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMS4xNTkgLTEuMTU3KSBzY2FsZSguMjMyOSkiLz48L2c+PC9nPjwvc3ZnPg==\"","/* generated by pull.js */\nimport _js from \"./userscript.js\";\nexport const resources = {\n  \"userscript.js\": _js,\n};\n","export default async ({ addon, console }) => {\n  if (!addon.tab.redux.state) return console.warn(\"Redux is not available!\");\n  addon.tab.redux.initialize();\n  addon.tab.redux.addEventListener(\"statechanged\", ({ detail }) => {\n    if (addon.self.disabled) return;\n    const e = detail;\n    if (!e.action || e.action.type !== \"scratch-paint/clipboard/SET\") return;\n    const items = e.next.scratchPaint.clipboard.items;\n    if (items.length !== 1) return;\n    const firstItem = items[0];\n    // TODO vector support\n    if (!Array.isArray(firstItem) || firstItem[0] !== \"Raster\") return console.log(\"copied element is vector\");\n    const dataURL = firstItem[1].source;\n    addon.tab\n      .copyImage(dataURL)\n      .then(() => console.log(\"Image successfully copied\"))\n      .catch((e) => console.error(`Image could not be copied: ${e}`));\n  });\n};\n","/* generated by pull.js */\nimport _js from \"./userscript.js\";\nexport const resources = {\n  \"userscript.js\": _js,\n};\n","import * as sharedModule from \"../block-duplicate/module.js\";\n\nexport default async function ({ addon, global, console }) {\n  const update = () => {\n    sharedModule.setCherryPicking(!addon.self.disabled, addon.settings.get(\"invertDrag\"));\n  };\n  addon.self.addEventListener(\"disabled\", update);\n  addon.self.addEventListener(\"reenabled\", update);\n  addon.settings.addEventListener(\"change\", update);\n  update();\n  sharedModule.load(addon);\n}\n","/* generated by pull.js */\nimport _js from \"./userscript.js\";\nexport const resources = {\n  \"userscript.js\": _js,\n};\n","let enableCherryPicking = false;\nlet invertCherryPicking = false;\nexport function setCherryPicking(newEnabled, newInverted) {\n  enableCherryPicking = newEnabled;\n  invertCherryPicking = newInverted;\n}\n\nlet enableDuplication = false;\nexport function setDuplication(newEnabled) {\n  enableDuplication = newEnabled;\n}\n\n// mostRecentEvent_ is sometimes a fake event, so we can't rely on reading its properties.\nlet ctrlOrMetaPressed = false;\nlet altPressed = false;\ndocument.addEventListener(\n  \"mousedown\",\n  function (e) {\n    ctrlOrMetaPressed = e.ctrlKey || e.metaKey;\n    altPressed = e.altKey;\n  },\n  {\n    capture: true,\n  }\n);\n\nlet loaded = false;\n\nexport async function load(addon) {\n  if (loaded) {\n    return;\n  }\n  loaded = true;\n\n  const ScratchBlocks = await addon.tab.traps.getBlockly();\n\n  // https://github.com/LLK/scratch-blocks/blob/912b8cc728bea8fd91af85078c64fcdbfe21c87a/core/gesture.js#L454\n  const originalStartDraggingBlock = ScratchBlocks.Gesture.prototype.startDraggingBlock_;\n  ScratchBlocks.Gesture.prototype.startDraggingBlock_ = function (...args) {\n    let block = this.targetBlock_;\n\n    // Scratch uses fake mouse events to implement right click > duplicate\n    const isRightClickDuplicate = !(this.mostRecentEvent_ instanceof MouseEvent);\n\n    const isDuplicating =\n      enableDuplication &&\n      altPressed &&\n      !isRightClickDuplicate &&\n      !this.flyout_ &&\n      !this.shouldDuplicateOnDrag_ &&\n      this.targetBlock_.type !== \"procedures_definition\";\n\n    const isCherryPickingInverted = invertCherryPicking && !isRightClickDuplicate && block.getParent();\n    const isCherryPicking = isDuplicating\n      ? ctrlOrMetaPressed\n      : enableCherryPicking && ctrlOrMetaPressed === !isCherryPickingInverted && !block.isShadow();\n\n    if (isDuplicating || isCherryPicking) {\n      if (!ScratchBlocks.Events.getGroup()) {\n        // Scratch will disable grouping on its own later.\n        ScratchBlocks.Events.setGroup(true);\n      }\n    }\n\n    if (isDuplicating) {\n      // Based on https://github.com/LLK/scratch-blocks/blob/feda366947432b9d82a4f212f43ff6d4ab6f252f/core/scratch_blocks_utils.js#L171\n      // Setting this.shouldDuplicateOnDrag_ = true does NOT work because it doesn't call changeObscuredShadowIds\n      this.startWorkspace_.setResizesEnabled(false);\n      ScratchBlocks.Events.disable();\n      let newBlock;\n      try {\n        const xmlBlock = ScratchBlocks.Xml.blockToDom(block);\n        newBlock = ScratchBlocks.Xml.domToBlock(xmlBlock, this.startWorkspace_);\n        ScratchBlocks.scratchBlocksUtils.changeObscuredShadowIds(newBlock);\n        const xy = block.getRelativeToSurfaceXY();\n        newBlock.moveBy(xy.x, xy.y);\n      } catch (e) {\n        console.error(e);\n      }\n      ScratchBlocks.Events.enable();\n\n      if (newBlock) {\n        block = newBlock;\n        this.targetBlock_ = newBlock;\n        if (ScratchBlocks.Events.isEnabled()) {\n          ScratchBlocks.Events.fire(new ScratchBlocks.Events.BlockCreate(newBlock));\n        }\n      }\n    }\n\n    if (isCherryPicking) {\n      if (isRightClickDuplicate || isDuplicating) {\n        const nextBlock = block.getNextBlock();\n        if (nextBlock) {\n          nextBlock.dispose();\n        }\n      }\n      block.unplug(true);\n    }\n\n    return originalStartDraggingBlock.call(this, ...args);\n  };\n}\n","import * as sharedModule from \"./module.js\";\n\nexport default async function ({ addon, global, console }) {\n  const update = () => {\n    sharedModule.setDuplication(!addon.self.disabled);\n  };\n  addon.self.addEventListener(\"disabled\", update);\n  addon.self.addEventListener(\"reenabled\", update);\n  update();\n  sharedModule.load(addon);\n}\n","/* generated by pull.js */\nimport _js from \"./userscript.js\";\nexport const resources = {\n  \"userscript.js\": _js,\n};\n","/**\n * This file is imported from https://github.com/LLK/scratch-blocks/\n * It has been cleaned up and unnecessary functions have been removed.\n * Original license is below.\n *\n * @license\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * https://developers.google.com/blockly/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable */\n\nconst INPUT_VALUE = 1;\nconst NEXT_STATEMENT = 3;\nconst DUMMY_INPUT = 5;\n\n// Partially implements goog.dom.createDom.\nconst createDom = function (tagName, /* unused */ _params, children) {\n  const element = document.createElement(tagName);\n  if (children !== undefined) {\n    if (!Array.isArray(children)) {\n      children = [children];\n    }\n    for (const child of children) {\n      if (typeof child === \"string\") {\n        element.appendChild(document.createTextNode(child));\n      } else {\n        element.appendChild(child);\n      }\n    }\n  }\n  return element;\n};\n\n// Partially implements goog.dom.removeNode\nconst removeNode = (node) => {\n  if (node.parentNode) {\n    node.parentNode.removeChild(node);\n  }\n};\n\nconst fieldToDomVariable_ = function (field) {\n  // The field had not been initialized fully before being serialized.\n  // This can happen if a block is created directly through a call to\n  // workspace.newBlock instead of from XML.\n  // The new block will be serialized for the first time when firing a block\n  // creation event.\n  if (field.getValue() == null) {\n    field.initModel();\n  }\n  // Get the variable directly from the field, instead of doing a lookup.  This\n  // will work even if the variable has already been deleted.  This can happen\n  // because the flyout defers deleting blocks until the next time the flyout is\n  // opened.\n  var variable = field.getVariable();\n\n  if (!variable) {\n    throw Error(\"Tried to serialize a variable field with no variable.\");\n  }\n  var container = createDom(\"field\", null, variable.name);\n  container.setAttribute(\"name\", field.name);\n  container.setAttribute(\"id\", variable.getId());\n  container.setAttribute(\"variabletype\", variable.type);\n  return container;\n};\n\nconst fieldToDom_ = function (field) {\n  if (field.name && field.SERIALIZABLE) {\n    if (field.referencesVariables()) {\n      return fieldToDomVariable_(field);\n    } else {\n      var container = createDom(\"field\", null, field.getValue());\n      container.setAttribute(\"name\", field.name);\n      return container;\n    }\n  }\n  return null;\n};\n\nconst allFieldsToDom_ = function (block, element) {\n  for (var i = 0, input; (input = block.inputList[i]); i++) {\n    for (var j = 0, field; (field = input.fieldRow[j]); j++) {\n      var fieldDom = fieldToDom_(field);\n      if (fieldDom) {\n        element.appendChild(fieldDom);\n      }\n    }\n  }\n};\n\nconst blockToDom = function (block, opt_noId) {\n  var element = createDom(block.isShadow() ? \"shadow\" : \"block\");\n  element.setAttribute(\"type\", block.type);\n  if (!opt_noId) {\n    element.setAttribute(\"id\", block.id);\n  }\n  if (block.mutationToDom) {\n    // Custom data for an advanced block.\n    var mutation = block.mutationToDom();\n    if (mutation && (mutation.hasChildNodes() || mutation.hasAttributes())) {\n      element.appendChild(mutation);\n    }\n  }\n\n  allFieldsToDom_(block, element);\n\n  scratchCommentToDom_(block, element);\n\n  if (block.data) {\n    var dataElement = createDom(\"data\", null, block.data);\n    element.appendChild(dataElement);\n  }\n\n  for (var i = 0, input; (input = block.inputList[i]); i++) {\n    var container;\n    var empty = true;\n    if (input.type == DUMMY_INPUT) {\n      continue;\n    } else {\n      var childBlock = input.connection.targetBlock();\n      if (input.type == INPUT_VALUE) {\n        container = createDom(\"value\");\n      } else if (input.type == NEXT_STATEMENT) {\n        container = createDom(\"statement\");\n      }\n      var shadow = input.connection.getShadowDom();\n      if (shadow && (!childBlock || !childBlock.isShadow())) {\n        var shadowClone = cloneShadow_(shadow);\n        // Remove the ID from the shadow dom clone if opt_noId\n        // is specified to true.\n        if (opt_noId && shadowClone.getAttribute(\"id\")) {\n          shadowClone.removeAttribute(\"id\");\n        }\n        container.appendChild(shadowClone);\n      }\n      if (childBlock) {\n        container.appendChild(blockToDom(childBlock, opt_noId));\n        empty = false;\n      }\n    }\n    container.setAttribute(\"name\", input.name);\n    if (!empty) {\n      element.appendChild(container);\n    }\n  }\n  if (block.inputsInlineDefault != block.inputsInline) {\n    element.setAttribute(\"inline\", block.inputsInline);\n  }\n  if (block.isCollapsed()) {\n    element.setAttribute(\"collapsed\", true);\n  }\n  if (block.disabled) {\n    element.setAttribute(\"disabled\", true);\n  }\n  if (!block.isDeletable() && !block.isShadow()) {\n    element.setAttribute(\"deletable\", false);\n  }\n  if (!block.isMovable() && !block.isShadow()) {\n    element.setAttribute(\"movable\", false);\n  }\n  if (!block.isEditable()) {\n    element.setAttribute(\"editable\", false);\n  }\n\n  var nextBlock = block.getNextBlock();\n  if (nextBlock) {\n    var container = createDom(\"next\", null, blockToDom(nextBlock, opt_noId));\n    element.appendChild(container);\n  }\n  var shadow = block.nextConnection && block.nextConnection.getShadowDom();\n  if (shadow && (!nextBlock || !nextBlock.isShadow())) {\n    container.appendChild(cloneShadow_(shadow));\n  }\n\n  return element;\n};\n\nconst scratchCommentToDom_ = function (block, element) {\n  var commentText = block.getCommentText();\n  if (commentText) {\n    var commentElement = createDom(\"comment\", null, commentText);\n    if (typeof block.comment == \"object\") {\n      commentElement.setAttribute(\"id\", block.comment.id);\n      commentElement.setAttribute(\"pinned\", block.comment.isVisible());\n      var hw;\n      // TODO: scratch-blocks uses `block.comment instanceof Blockly.ScratchBlockComment`\n      if (block.comment.getHeightWidth) {\n        hw = block.comment.getHeightWidth();\n      } else {\n        hw = block.comment.getBubbleSize();\n      }\n      commentElement.setAttribute(\"h\", hw.height);\n      commentElement.setAttribute(\"w\", hw.width);\n      var xy = block.comment.getXY();\n      commentElement.setAttribute(\"x\", xy.x);\n      commentElement.setAttribute(\"y\", xy.y);\n      commentElement.setAttribute(\"minimized\", block.comment.isMinimized());\n    }\n    element.appendChild(commentElement);\n  }\n};\n\nconst cloneShadow_ = function (shadow) {\n  shadow = shadow.cloneNode(true);\n  // Walk the tree looking for whitespace.  Don't prune whitespace in a tag.\n  var node = shadow;\n  var textNode;\n  while (node) {\n    if (node.firstChild) {\n      node = node.firstChild;\n    } else {\n      while (node && !node.nextSibling) {\n        textNode = node;\n        node = node.parentNode;\n        if (textNode.nodeType == 3 && textNode.data.trim() == \"\" && node.firstChild != textNode) {\n          // Prune whitespace after a tag.\n          removeNode(textNode);\n        }\n      }\n      if (node) {\n        textNode = node;\n        node = node.nextSibling;\n        if (textNode.nodeType == 3 && textNode.data.trim() == \"\") {\n          // Prune whitespace before a tag.\n          removeNode(textNode);\n        }\n      }\n    }\n  }\n  return shadow;\n};\n\nconst blockToDomWithXY = (block) => {\n  const xml = blockToDom(block, false);\n  const position = block.getRelativeToSurfaceXY();\n  xml.setAttribute(\"x\", Math.round(block.workspace.RTL ? -position.x : position.x));\n  xml.setAttribute(\"y\", Math.round(position.y));\n  return xml;\n};\n\nexport default blockToDomWithXY;\n","import blockToDom from \"./blockToDom.js\";\n\nexport default async function ({ addon, global, console, msg }) {\n  const ScratchBlocks = await addon.tab.traps.getBlockly();\n  const vm = addon.tab.traps.vm;\n\n  let blockSwitches = {};\n  let procedureSwitches = {};\n  const noopSwitch = {\n    isNoop: true,\n  };\n\n  const buildSwitches = () => {\n    blockSwitches = {};\n    procedureSwitches = {};\n\n    if (addon.settings.get(\"motion\")) {\n      blockSwitches[\"motion_turnright\"] = [\n        noopSwitch,\n        {\n          opcode: \"motion_turnleft\",\n        },\n      ];\n      blockSwitches[\"motion_turnleft\"] = [\n        {\n          opcode: \"motion_turnright\",\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"motion_setx\"] = [\n        noopSwitch,\n        {\n          opcode: \"motion_changexby\",\n          remap: { X: \"DX\" },\n        },\n        {\n          opcode: \"motion_sety\",\n          remap: { X: \"Y\" },\n        },\n        {\n          opcode: \"motion_changeyby\",\n          remap: { X: \"DY\" },\n        },\n      ];\n      blockSwitches[\"motion_changexby\"] = [\n        {\n          opcode: \"motion_setx\",\n          remap: { DX: \"X\" },\n        },\n        noopSwitch,\n        {\n          opcode: \"motion_sety\",\n          remap: { DX: \"Y\" },\n        },\n        {\n          opcode: \"motion_changeyby\",\n          remap: { DX: \"DY\" },\n        },\n      ];\n      blockSwitches[\"motion_sety\"] = [\n        {\n          opcode: \"motion_setx\",\n          remap: { Y: \"X\" },\n        },\n        {\n          opcode: \"motion_changexby\",\n          remap: { Y: \"DX\" },\n        },\n        noopSwitch,\n        {\n          opcode: \"motion_changeyby\",\n          remap: { Y: \"DY\" },\n        },\n      ];\n      blockSwitches[\"motion_changeyby\"] = [\n        {\n          opcode: \"motion_setx\",\n          remap: { DY: \"X\" },\n        },\n        {\n          opcode: \"motion_changexby\",\n          remap: { DY: \"DX\" },\n        },\n        {\n          opcode: \"motion_sety\",\n          remap: { DY: \"Y\" },\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"motion_xposition\"] = [\n        noopSwitch,\n        {\n          opcode: \"motion_yposition\",\n        },\n      ];\n      blockSwitches[\"motion_yposition\"] = [\n        {\n          opcode: \"motion_xposition\",\n        },\n        noopSwitch,\n      ];\n    }\n\n    if (addon.settings.get(\"looks\")) {\n      blockSwitches[\"looks_seteffectto\"] = [\n        noopSwitch,\n        {\n          opcode: \"looks_changeeffectby\",\n          remap: { VALUE: \"CHANGE\" },\n        },\n      ];\n      blockSwitches[\"looks_changeeffectby\"] = [\n        {\n          opcode: \"looks_seteffectto\",\n          remap: { CHANGE: \"VALUE\" },\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"looks_setsizeto\"] = [\n        noopSwitch,\n        {\n          opcode: \"looks_changesizeby\",\n          remap: { SIZE: \"CHANGE\" },\n        },\n      ];\n      blockSwitches[\"looks_changesizeby\"] = [\n        {\n          opcode: \"looks_setsizeto\",\n          remap: { CHANGE: \"SIZE\" },\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"looks_costumenumbername\"] = [\n        noopSwitch,\n        {\n          opcode: \"looks_backdropnumbername\",\n        },\n      ];\n      blockSwitches[\"looks_backdropnumbername\"] = [\n        {\n          opcode: \"looks_costumenumbername\",\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"looks_show\"] = [\n        noopSwitch,\n        {\n          opcode: \"looks_hide\",\n        },\n      ];\n      blockSwitches[\"looks_hide\"] = [\n        {\n          opcode: \"looks_show\",\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"looks_nextcostume\"] = [\n        noopSwitch,\n        {\n          opcode: \"looks_nextbackdrop\",\n        },\n      ];\n      blockSwitches[\"looks_nextbackdrop\"] = [\n        {\n          opcode: \"looks_nextcostume\",\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"looks_think\"] = [\n        noopSwitch,\n        {\n          opcode: \"looks_say\",\n        },\n      ];\n      blockSwitches[\"looks_say\"] = [\n        {\n          opcode: \"looks_think\",\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"looks_thinkforsecs\"] = [\n        noopSwitch,\n        {\n          opcode: \"looks_sayforsecs\",\n        },\n      ];\n      blockSwitches[\"looks_sayforsecs\"] = [\n        {\n          opcode: \"looks_thinkforsecs\",\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"looks_switchbackdropto\"] = [\n        noopSwitch,\n        {\n          opcode: \"looks_switchbackdroptoandwait\",\n        },\n      ];\n      blockSwitches[\"looks_switchbackdroptoandwait\"] = [\n        {\n          opcode: \"looks_switchbackdropto\",\n        },\n        noopSwitch,\n      ];\n    }\n\n    if (addon.settings.get(\"sound\")) {\n      blockSwitches[\"sound_play\"] = [\n        noopSwitch,\n        {\n          opcode: \"sound_playuntildone\",\n        },\n      ];\n      blockSwitches[\"sound_playuntildone\"] = [\n        {\n          opcode: \"sound_play\",\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"sound_seteffectto\"] = [\n        noopSwitch,\n        {\n          opcode: \"sound_changeeffectby\",\n        },\n      ];\n      blockSwitches[\"sound_changeeffectby\"] = [\n        {\n          opcode: \"sound_seteffectto\",\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"sound_setvolumeto\"] = [\n        noopSwitch,\n        {\n          opcode: \"sound_changevolumeby\",\n        },\n      ];\n      blockSwitches[\"sound_changevolumeby\"] = [\n        {\n          opcode: \"sound_setvolumeto\",\n        },\n        noopSwitch,\n      ];\n    }\n\n    if (addon.settings.get(\"event\")) {\n      blockSwitches[\"event_broadcast\"] = [\n        noopSwitch,\n        {\n          opcode: \"event_broadcastandwait\",\n        },\n      ];\n      blockSwitches[\"event_broadcastandwait\"] = [\n        {\n          opcode: \"event_broadcast\",\n        },\n        noopSwitch,\n      ];\n    }\n\n    if (addon.settings.get(\"control\")) {\n      blockSwitches[\"control_if\"] = [\n        noopSwitch,\n        {\n          opcode: \"control_if_else\",\n        },\n      ];\n      blockSwitches[\"control_if_else\"] = [\n        {\n          opcode: \"control_if\",\n          remap: { SUBSTACK2: \"split\" },\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"control_repeat_until\"] = [\n        noopSwitch,\n        {\n          opcode: \"control_wait_until\",\n          remap: { SUBSTACK: \"split\" },\n        },\n        {\n          opcode: \"control_forever\",\n          remap: { CONDITION: \"split\" },\n        },\n      ];\n      blockSwitches[\"control_forever\"] = [\n        {\n          opcode: \"control_repeat_until\",\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"control_wait_until\"] = [\n        {\n          opcode: \"control_repeat_until\",\n        },\n        noopSwitch,\n      ];\n    }\n\n    if (addon.settings.get(\"operator\")) {\n      blockSwitches[\"operator_equals\"] = [\n        {\n          opcode: \"operator_gt\",\n        },\n        noopSwitch,\n        {\n          opcode: \"operator_lt\",\n        },\n      ];\n      blockSwitches[\"operator_gt\"] = [\n        noopSwitch,\n        {\n          opcode: \"operator_equals\",\n        },\n        {\n          opcode: \"operator_lt\",\n        },\n      ];\n      blockSwitches[\"operator_lt\"] = [\n        {\n          opcode: \"operator_gt\",\n        },\n        {\n          opcode: \"operator_equals\",\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"operator_add\"] = [\n        noopSwitch,\n        {\n          opcode: \"operator_subtract\",\n        },\n        {\n          opcode: \"operator_multiply\",\n        },\n        {\n          opcode: \"operator_divide\",\n        },\n        {\n          opcode: \"operator_mod\",\n        },\n      ];\n      blockSwitches[\"operator_subtract\"] = [\n        {\n          opcode: \"operator_add\",\n        },\n        noopSwitch,\n        {\n          opcode: \"operator_multiply\",\n        },\n        {\n          opcode: \"operator_divide\",\n        },\n        {\n          opcode: \"operator_mod\",\n        },\n      ];\n      blockSwitches[\"operator_multiply\"] = [\n        {\n          opcode: \"operator_add\",\n        },\n        {\n          opcode: \"operator_subtract\",\n        },\n        noopSwitch,\n        {\n          opcode: \"operator_divide\",\n        },\n        {\n          opcode: \"operator_mod\",\n        },\n      ];\n      blockSwitches[\"operator_divide\"] = [\n        {\n          opcode: \"operator_add\",\n        },\n        {\n          opcode: \"operator_subtract\",\n        },\n        {\n          opcode: \"operator_multiply\",\n        },\n        noopSwitch,\n        {\n          opcode: \"operator_mod\",\n        },\n      ];\n      blockSwitches[\"operator_mod\"] = [\n        {\n          opcode: \"operator_add\",\n        },\n        {\n          opcode: \"operator_subtract\",\n        },\n        {\n          opcode: \"operator_multiply\",\n        },\n        {\n          opcode: \"operator_divide\",\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"operator_and\"] = [\n        noopSwitch,\n        {\n          opcode: \"operator_or\",\n        },\n      ];\n      blockSwitches[\"operator_or\"] = [\n        {\n          opcode: \"operator_and\",\n        },\n        noopSwitch,\n      ];\n    }\n\n    if (addon.settings.get(\"sensing\")) {\n      blockSwitches[\"sensing_mousex\"] = [\n        noopSwitch,\n        {\n          opcode: \"sensing_mousey\",\n        },\n      ];\n      blockSwitches[\"sensing_mousey\"] = [\n        {\n          opcode: \"sensing_mousex\",\n        },\n        noopSwitch,\n      ];\n    }\n\n    if (addon.settings.get(\"data\")) {\n      blockSwitches[\"data_setvariableto\"] = [\n        noopSwitch,\n        {\n          opcode: \"data_changevariableby\",\n          remapValueType: { VALUE: \"math_number\" },\n        },\n      ];\n      blockSwitches[\"data_changevariableby\"] = [\n        {\n          opcode: \"data_setvariableto\",\n          remapValueType: { VALUE: \"text\" },\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"data_showvariable\"] = [\n        noopSwitch,\n        {\n          opcode: \"data_hidevariable\",\n        },\n      ];\n      blockSwitches[\"data_hidevariable\"] = [\n        {\n          opcode: \"data_showvariable\",\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"data_showlist\"] = [\n        noopSwitch,\n        {\n          opcode: \"data_hidelist\",\n        },\n      ];\n      blockSwitches[\"data_hidelist\"] = [\n        {\n          opcode: \"data_showlist\",\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"data_replaceitemoflist\"] = [\n        noopSwitch,\n        {\n          opcode: \"data_insertatlist\",\n        },\n      ];\n      blockSwitches[\"data_insertatlist\"] = [\n        {\n          opcode: \"data_replaceitemoflist\",\n        },\n        noopSwitch,\n      ];\n    }\n\n    if (addon.settings.get(\"extension\")) {\n      blockSwitches[\"pen_penDown\"] = [\n        noopSwitch,\n        {\n          opcode: \"pen_penUp\",\n        },\n      ];\n      blockSwitches[\"pen_penUp\"] = [\n        {\n          opcode: \"pen_penDown\",\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"pen_setPenColorParamTo\"] = [\n        noopSwitch,\n        {\n          opcode: \"pen_changePenColorParamBy\",\n        },\n      ];\n      blockSwitches[\"pen_changePenColorParamBy\"] = [\n        {\n          opcode: \"pen_setPenColorParamTo\",\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"pen_setPenHueToNumber\"] = [\n        noopSwitch,\n        {\n          opcode: \"pen_changePenHueBy\",\n        },\n      ];\n      blockSwitches[\"pen_changePenHueBy\"] = [\n        {\n          opcode: \"pen_setPenHueToNumber\",\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"pen_setPenShadeToNumber\"] = [\n        noopSwitch,\n        {\n          opcode: \"pen_changePenShadeBy\",\n        },\n      ];\n      blockSwitches[\"pen_changePenShadeBy\"] = [\n        {\n          opcode: \"pen_setPenShadeToNumber\",\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"pen_setPenSizeTo\"] = [\n        noopSwitch,\n        {\n          opcode: \"pen_changePenSizeBy\",\n        },\n      ];\n      blockSwitches[\"pen_changePenSizeBy\"] = [\n        {\n          opcode: \"pen_setPenSizeTo\",\n        },\n        noopSwitch,\n      ];\n      blockSwitches[\"music_setTempo\"] = [\n        noopSwitch,\n        {\n          opcode: \"music_changeTempo\",\n        },\n      ];\n      blockSwitches[\"music_changeTempo\"] = [\n        {\n          opcode: \"music_setTempo\",\n        },\n        noopSwitch,\n      ];\n    }\n\n    if (addon.settings.get(\"sa\")) {\n      const logProc = \"\\u200B\\u200Blog\\u200B\\u200B %s\";\n      const warnProc = \"\\u200B\\u200Bwarn\\u200B\\u200B %s\";\n      const errorProc = \"\\u200B\\u200Berror\\u200B\\u200B %s\";\n      const logMessage = msg(\"debugger_log\");\n      const warnMessage = msg(\"debugger_warn\");\n      const errorMessage = msg(\"debugger_error\");\n      const logSwitch = {\n        mutate: {\n          proccode: logProc,\n        },\n        msg: logMessage,\n      };\n      const warnSwitch = {\n        mutate: {\n          proccode: warnProc,\n        },\n        msg: warnMessage,\n      };\n      const errorSwitch = {\n        mutate: {\n          proccode: errorProc,\n        },\n        msg: errorMessage,\n      };\n      procedureSwitches[logProc] = [\n        {\n          msg: logMessage,\n          isNoop: true,\n        },\n        warnSwitch,\n        errorSwitch,\n      ];\n      procedureSwitches[warnProc] = [\n        logSwitch,\n        {\n          msg: warnMessage,\n          isNoop: true,\n        },\n        errorSwitch,\n      ];\n      procedureSwitches[errorProc] = [\n        logSwitch,\n        warnSwitch,\n        {\n          msg: errorMessage,\n          isNoop: true,\n        },\n      ];\n    }\n\n    // Switching for these is implemented by Scratch. We only define them here to optionally add a border.\n    // Because we don't implement the switching ourselves, this is not controlled by the data category option.\n    blockSwitches[\"data_variable\"] = [];\n    blockSwitches[\"data_listcontents\"] = [];\n  };\n  buildSwitches();\n  addon.settings.addEventListener(\"change\", buildSwitches);\n\n  const menuCallbackFactory = (block, opcodeData) => () => {\n    if (opcodeData.isNoop) {\n      return;\n    }\n\n    if (opcodeData.fieldValue) {\n      block.setFieldValue(opcodeData.fieldValue, \"VALUE\");\n      return;\n    }\n\n    const workspace = block.workspace;\n\n    // Make a copy of the block with the proper type set.\n    // It doesn't seem to be possible to change a Block's type after it's created, so we'll just make a new block instead.\n    const xml = blockToDom(block);\n    if (opcodeData.opcode) {\n      xml.setAttribute(\"type\", opcodeData.opcode);\n    }\n\n    const id = block.id;\n    const parent = block.getParent();\n\n    let parentConnection;\n    let blockConnectionType;\n    if (parent) {\n      // If the block has a parent, find the parent -> child connection that will be reattached later.\n      const parentConnections = parent.getConnections_();\n      parentConnection = parentConnections.find((c) => c.targetConnection && c.targetConnection.sourceBlock_ === block);\n      // There's two types of connections from child -> parent. We need to figure out which one is used.\n      const blockConnections = block.getConnections_();\n      const blockToParentConnection = blockConnections.find(\n        (c) => c.targetConnection && c.targetConnection.sourceBlock_ === parent\n      );\n      blockConnectionType = blockToParentConnection.type;\n    }\n\n    const pasteSeparately = [];\n\n    // Apply input remappings.\n    if (opcodeData.remap) {\n      for (const child of Array.from(xml.children)) {\n        const oldName = child.getAttribute(\"name\");\n        const newName = opcodeData.remap[oldName];\n        if (newName) {\n          if (newName === \"split\") {\n            // This input will be split off into its own script.\n            const inputXml = child.firstChild;\n            const inputId = inputXml.id;\n            const inputBlock = workspace.getBlockById(inputId);\n            const position = inputBlock.getRelativeToSurfaceXY();\n            inputXml.setAttribute(\"x\", Math.round(workspace.RTL ? -position.x : position.x));\n            inputXml.setAttribute(\"y\", Math.round(position.y));\n            pasteSeparately.push(inputXml);\n            xml.removeChild(child);\n          } else {\n            child.setAttribute(\"name\", newName);\n          }\n        }\n      }\n    }\n    if (opcodeData.remapValueType) {\n      for (const child of Array.from(xml.children)) {\n        const name = child.getAttribute(\"name\");\n        const newType = opcodeData.remapValueType[name];\n        if (newType) {\n          const valueNode = child.firstChild;\n          const fieldNode = valueNode.firstChild;\n          valueNode.setAttribute(\"type\", newType);\n          fieldNode.setAttribute(\"name\", newType === \"text\" ? \"TEXT\" : \"NUM\");\n        }\n      }\n    }\n    if (opcodeData.mutate) {\n      const mutation = xml.querySelector(\"mutation\");\n      for (const [key, value] of Object.entries(opcodeData.mutate)) {\n        mutation.setAttribute(key, value);\n      }\n    }\n\n    try {\n      ScratchBlocks.Events.setGroup(true);\n\n      // Remove the old block and insert the new one.\n      block.dispose();\n      workspace.paste(xml);\n      for (const separateBlock of pasteSeparately) {\n        workspace.paste(separateBlock);\n      }\n      // The new block will have the same ID as the old one.\n      const newBlock = workspace.getBlockById(id);\n      if (parentConnection) {\n        // Search for the same type of connection on the new block as on the old block.\n        const newBlockConnections = newBlock.getConnections_();\n        const newBlockConnection = newBlockConnections.find((c) => c.type === blockConnectionType);\n        newBlockConnection.connect(parentConnection);\n      }\n    } finally {\n      ScratchBlocks.Events.setGroup(false);\n    }\n  };\n\n  const uniques = (array) => [...new Set(array)];\n\n  addon.tab.createBlockContextMenu(\n    (items, block) => {\n      if (!addon.self.disabled) {\n        const type = block.type;\n        let switches = blockSwitches[block.type] || [];\n\n        const customArgsMode = addon.settings.get(\"customargs\") ? addon.settings.get(\"customargsmode\") : \"off\";\n        if (\n          customArgsMode !== \"off\" &&\n          [\"argument_reporter_boolean\", \"argument_reporter_string_number\"].includes(type) &&\n          // if the arg is a shadow, it's in a procedures_prototype so we don't want it to be switchable\n          !block.isShadow()\n        ) {\n          const customBlocks = getCustomBlocks();\n          if (customArgsMode === \"all\") {\n            switch (type) {\n              case \"argument_reporter_string_number\":\n                switches = Object.values(customBlocks)\n                  .map((cb) => cb.stringArgs)\n                  .flat(1);\n                break;\n              case \"argument_reporter_boolean\":\n                switches = Object.values(customBlocks)\n                  .map((cb) => cb.boolArgs)\n                  .flat(1);\n                break;\n            }\n          } else if (customArgsMode === \"defOnly\") {\n            const root = block.getRootBlock();\n            if (root.type !== \"procedures_definition\") return items;\n            const customBlockObj = customBlocks[root.getChildren(true)[0].getProcCode()];\n            switch (type) {\n              case \"argument_reporter_string_number\":\n                switches = customBlockObj.stringArgs;\n                break;\n              case \"argument_reporter_boolean\":\n                switches = customBlockObj.boolArgs;\n                break;\n            }\n          }\n          const currentValue = block.getFieldValue(\"VALUE\");\n          switches = uniques(switches).map((i) => ({\n            isNoop: i === currentValue,\n            fieldValue: i,\n            msg: i,\n          }));\n        }\n\n        if (block.type === \"procedures_call\") {\n          const proccode = block.getProcCode();\n          if (procedureSwitches[proccode]) {\n            switches = procedureSwitches[proccode];\n          }\n        }\n\n        if (!addon.settings.get(\"noop\")) {\n          switches = switches.filter((i) => !i.isNoop);\n        }\n\n        switches.forEach((opcodeData, i) => {\n          const makeSpaceItemIndex = items.findIndex((obj) => obj._isDevtoolsFirstItem);\n          const insertBeforeIndex =\n            makeSpaceItemIndex !== -1\n              ? // If \"make space\" button exists, add own items before it\n                makeSpaceItemIndex\n              : // If there's no such button, insert at end\n                items.length;\n          const text = opcodeData.msg ? opcodeData.msg : opcodeData.opcode ? msg(opcodeData.opcode) : msg(block.type);\n          items.splice(insertBeforeIndex, 0, {\n            enabled: true,\n            text,\n            callback: menuCallbackFactory(block, opcodeData),\n            separator: addon.settings.get(\"border\") && i === 0,\n          });\n        });\n\n        if (addon.settings.get(\"border\") && (block.type === \"data_variable\" || block.type === \"data_listcontents\")) {\n          // Add top border to first variable (if it exists)\n          const delBlockIndex = items.findIndex((item) => item.text === ScratchBlocks.Msg.DELETE_BLOCK);\n          // firstVariableItem might be undefined, a variable to switch to,\n          // or an item added by editor-devtools (or any addon before this one)\n          const firstVariableItem = items[delBlockIndex + 1];\n          if (firstVariableItem) firstVariableItem.separator = true;\n        }\n      }\n      return items;\n    },\n    { blocks: true }\n  );\n\n  // https://github.com/LLK/scratch-blocks/blob/abbfe93136fef57fdfb9a077198b0bc64726f012/blocks_vertical/procedures.js#L207-L215\n  // Returns a list like [\"%s\", \"%d\"]\n  const parseArguments = (code) =>\n    code\n      .split(/(?=[^\\\\]%[nbs])/g)\n      .map((i) => i.trim())\n      .filter((i) => i.charAt(0) === \"%\")\n      .map((i) => i.substring(0, 2));\n\n  const getCustomBlocks = () => {\n    const customBlocks = {};\n    const target = vm.editingTarget;\n    Object.values(target.blocks._blocks)\n      .filter((block) => block.opcode === \"procedures_prototype\")\n      .forEach((block) => {\n        const procCode = block.mutation.proccode;\n        const argumentNames = JSON.parse(block.mutation.argumentnames);\n        // argumentdefaults is unreliable, so we have to parse the procedure code to determine argument types\n        const parsedArguments = parseArguments(procCode);\n        const stringArgs = [];\n        const boolArgs = [];\n        for (let i = 0; i < argumentNames.length; i++) {\n          if (parsedArguments[i] === \"%b\") {\n            boolArgs.push(argumentNames[i]);\n          } else {\n            stringArgs.push(argumentNames[i]);\n          }\n        }\n        customBlocks[procCode] = {\n          stringArgs,\n          boolArgs,\n        };\n      });\n    return customBlocks;\n  };\n}\n","/* generated by pull.js */\nimport _js from \"./userscript.js\";\nimport _css from \"!css-loader!./style.css\";\nexport const resources = {\n  \"userscript.js\": _js,\n  \"style.css\": _css,\n};\n","import { normalizeHex, getHexRegex } from \"../../libraries/common/cs/normalize-color.js\";\nimport RateLimiter from \"../../libraries/common/cs/rate-limiter.js\";\nimport tinycolor from \"../../libraries/thirdparty/cs/tinycolor-min.js\";\n\nexport default async ({ addon, console, msg }) => {\n  // 250-ms rate limit\n  const rateLimiter = new RateLimiter(250);\n  const getColor = (element) => {\n    const { children } = element.parentElement;\n    // h: 0 - 360\n    const h = children[1].getAttribute(\"aria-valuenow\");\n    // s: 0 - 1\n    const s = children[3].getAttribute(\"aria-valuenow\");\n    // v: 0 - 255, divide by 255\n    const vMultipliedBy255 = children[5].getAttribute(\"aria-valuenow\");\n    const v = Number(vMultipliedBy255) / 255;\n    return tinycolor(`hsv(${h}, ${s}, ${v || 0})`).toHexString();\n  };\n  const setColor = (hex, element) => {\n    hex = normalizeHex(hex);\n    if (!addon.tab.redux.state || !addon.tab.redux.state.scratchGui) return;\n    // The only way to reliably set color is to invoke eye dropper via click()\n    // then faking that the eye dropper reported the value.\n    const onEyeDropperClosed = ({ detail }) => {\n      if (detail.action.type !== \"scratch-gui/color-picker/DEACTIVATE_COLOR_PICKER\") return;\n      addon.tab.redux.removeEventListener(\"statechanged\", onEyeDropperClosed);\n      setTimeout(() => {\n        document.body.classList.remove(\"sa-hide-eye-dropper-background\");\n      }, 50);\n    };\n    const onEyeDropperOpened = ({ detail }) => {\n      if (detail.action.type !== \"scratch-gui/color-picker/ACTIVATE_COLOR_PICKER\") return;\n      addon.tab.redux.removeEventListener(\"statechanged\", onEyeDropperOpened);\n      addon.tab.redux.addEventListener(\"statechanged\", onEyeDropperClosed);\n      setTimeout(() => {\n        addon.tab.redux.dispatch({\n          type: \"scratch-gui/color-picker/DEACTIVATE_COLOR_PICKER\",\n          color: hex,\n        });\n      }, 50);\n    };\n    addon.tab.redux.addEventListener(\"statechanged\", onEyeDropperOpened);\n    document.body.classList.add(\"sa-hide-eye-dropper-background\");\n    element.click();\n  };\n  const addColorPicker = () => {\n    const element = document.querySelector(\"button.scratchEyedropper\");\n    rateLimiter.abort(false);\n    addon.tab.redux.initialize();\n    const defaultColor = getColor(element);\n    const saColorPicker = Object.assign(document.createElement(\"div\"), {\n      className: \"sa-color-picker sa-color-picker-code\",\n    });\n    addon.tab.displayNoneWhileDisabled(saColorPicker, { display: \"flex\" });\n    const saColorPickerColor = Object.assign(document.createElement(\"input\"), {\n      className: \"sa-color-picker-color sa-color-picker-code-color\",\n      type: \"color\",\n      value: defaultColor || \"#000000\",\n    });\n    const saColorPickerText = Object.assign(document.createElement(\"input\"), {\n      className: addon.tab.scratchClass(\"input_input-form\", {\n        others: \"sa-color-picker-text sa-color-picker-code-text\",\n      }),\n      type: \"text\",\n      pattern: \"^#?([0-9a-fA-F]{3}){1,2}$\",\n      placeholder: msg(\"hex\"),\n      value: defaultColor || \"\",\n    });\n    saColorPickerColor.addEventListener(\"input\", () =>\n      rateLimiter.limit(() => setColor((saColorPickerText.value = saColorPickerColor.value), element))\n    );\n    saColorPickerText.addEventListener(\"change\", () => {\n      const { value } = saColorPickerText;\n      if (!getHexRegex().test(value)) return;\n      setColor((saColorPickerColor.value = normalizeHex(value)), element);\n    });\n    saColorPicker.appendChild(saColorPickerColor);\n    saColorPicker.appendChild(saColorPickerText);\n    element.parentElement.insertBefore(saColorPicker, element);\n  };\n  const ScratchBlocks = await addon.tab.traps.getBlockly();\n  const originalShowEditor = ScratchBlocks.FieldColourSlider.prototype.showEditor_;\n  ScratchBlocks.FieldColourSlider.prototype.showEditor_ = function (...args) {\n    const r = originalShowEditor.call(this, ...args);\n    addColorPicker();\n    return r;\n  };\n};\n","import codeEditorHandler from \"./code-editor.js\";\n\nexport default async (api) => {\n  codeEditorHandler(api);\n};\n","/* generated by pull.js */\nimport _js from \"./userscript.js\";\nimport _css from \"!css-loader!./userstyle.css\";\nexport const resources = {\n  \"userscript.js\": _js,\n  \"userstyle.css\": _css,\n};\n","export default async function ({ addon, global, console }) {\n  const vm = addon.tab.traps.vm;\n\n  const updateStyles = () => {\n    previewInner.classList.toggle(\"sa-comment-preview-delay\", addon.settings.get(\"delay\") !== \"none\");\n    previewInner.classList.toggle(\"sa-comment-preview-reduce-transparency\", addon.settings.get(\"reduce-transparency\"));\n    previewInner.classList.toggle(\"sa-comment-preview-fade\", !addon.settings.get(\"reduce-animation\"));\n  };\n\n  const afterDelay = (cb) => {\n    if (!previewInner.classList.contains(\"sa-comment-preview-hidden\")) {\n      // If not hidden, updating immediately is preferred\n      cb();\n      return;\n    }\n    const delay = addon.settings.get(\"delay\");\n    if (delay === \"long\") return setTimeout(cb, 500);\n    if (delay === \"short\") return setTimeout(cb, 300);\n    cb();\n  };\n\n  let hoveredElement = null;\n  let showTimeout = null;\n  let mouseX = 0;\n  let mouseY = 0;\n  let doNotShowUntilMoveMouse = false;\n\n  const previewOuter = document.createElement(\"div\");\n  previewOuter.classList.add(\"sa-comment-preview-outer\");\n  const previewInner = document.createElement(\"div\");\n  previewInner.classList.add(\"sa-comment-preview-inner\");\n  previewInner.classList.add(\"sa-comment-preview-hidden\");\n  updateStyles();\n  addon.settings.addEventListener(\"change\", updateStyles);\n  previewOuter.appendChild(previewInner);\n  document.body.appendChild(previewOuter);\n\n  const getBlock = (id) => vm.editingTarget.blocks.getBlock(id) || vm.runtime.flyoutBlocks.getBlock(id);\n  const getComment = (block) => block && block.comment && vm.editingTarget.comments[block.comment];\n  const getProcedureDefinitionBlock = (procCode) => {\n    const procedurePrototype = Object.values(vm.editingTarget.blocks._blocks).find(\n      (i) => i.opcode === \"procedures_prototype\" && i.mutation.proccode === procCode\n    );\n    if (procedurePrototype) {\n      // Usually `parent` will exist but sometimes it doesn't\n      if (procedurePrototype.parent) {\n        return getBlock(procedurePrototype.parent);\n      }\n      const id = procedurePrototype.id;\n      return Object.values(vm.editingTarget.blocks._blocks).find(\n        (i) => i.opcode === \"procedures_definition\" && i.inputs.custom_block && i.inputs.custom_block.block === id\n      );\n    }\n    return null;\n  };\n\n  const setText = (text) => {\n    previewInner.innerText = text;\n    previewInner.classList.remove(\"sa-comment-preview-hidden\");\n    updateMousePosition();\n  };\n\n  const updateMousePosition = () => {\n    previewOuter.style.transform = `translate(${mouseX + 8}px, ${mouseY + 8}px)`;\n  };\n\n  const hidePreview = () => {\n    if (hoveredElement) {\n      hoveredElement = null;\n      previewInner.classList.add(\"sa-comment-preview-hidden\");\n    }\n  };\n\n  document.addEventListener(\"mouseover\", (e) => {\n    if (addon.self.disabled) {\n      return;\n    }\n    clearTimeout(showTimeout);\n    if (doNotShowUntilMoveMouse) {\n      return;\n    }\n\n    const el = e.target.closest(\".blocklyBubbleCanvas > g, .blocklyBlockCanvas .blocklyDraggable[data-id]\");\n    if (el === hoveredElement) {\n      // Nothing to do.\n      return;\n    }\n    if (!el) {\n      hidePreview();\n      return;\n    }\n\n    let text = null;\n    if (\n      addon.settings.get(\"hover-view\") &&\n      e.target.closest(\".blocklyBubbleCanvas > g\") &&\n      // Hovering over the thin line that connects comments to blocks should never show a preview\n      !e.target.closest(\"line\")\n    ) {\n      const collapsedText = el.querySelector(\"text.scratchCommentText\");\n      if (collapsedText.getAttribute(\"display\") !== \"none\") {\n        const textarea = el.querySelector(\"textarea\");\n        text = textarea.value;\n      }\n    } else if (e.target.closest(\".blocklyBlockCanvas .blocklyDraggable[data-id]\")) {\n      const id = el.dataset.id;\n      const block = getBlock(id);\n      const comment = getComment(block);\n      if (addon.settings.get(\"hover-view-block\") && comment) {\n        text = comment.text;\n      } else if (block && block.opcode === \"procedures_call\" && addon.settings.get(\"hover-view-procedure\")) {\n        const procCode = block.mutation.proccode;\n        const procedureDefinitionBlock = getProcedureDefinitionBlock(procCode);\n        const procedureComment = getComment(procedureDefinitionBlock);\n        if (procedureComment) {\n          text = procedureComment.text;\n        }\n      }\n    }\n\n    if (text !== null && text.trim() !== \"\") {\n      showTimeout = afterDelay(() => {\n        hoveredElement = el;\n        setText(text);\n      });\n    } else {\n      hidePreview();\n    }\n  });\n\n  document.addEventListener(\"mousemove\", (e) => {\n    mouseX = e.clientX;\n    mouseY = e.clientY;\n    doNotShowUntilMoveMouse = false;\n    if (addon.settings.get(\"follow-mouse\") && !previewInner.classList.contains(\"sa-comment-preview-hidden\")) {\n      updateMousePosition();\n    }\n  });\n\n  document.addEventListener(\n    \"mousedown\",\n    () => {\n      hidePreview();\n      doNotShowUntilMoveMouse = true;\n    },\n    {\n      capture: true,\n    }\n  );\n}\n","/**\n * Encapsulates a block (either in this sprite or another / Blockly, or native JSON block\n */\nexport default class BlockInstance {\n  constructor(target, block) {\n    this.targetId = target.id;\n    this.id = block.id;\n  }\n}\n","export default class BlockItem {\n  constructor(cls, procCode, labelID, y) {\n    this.cls = cls;\n    this.procCode = procCode;\n    this.labelID = labelID;\n    this.y = y;\n    this.lower = procCode.toLowerCase();\n    /**\n     * An Array of block ids\n     * @type {Array.<string>}\n     */\n    this.clones = null;\n    this.eventName = null;\n  }\n\n  /**\n   * True if the blockID matches a black represented by this BlockItem\n   * @param id\n   * @returns {boolean}\n   */\n  matchesID(id) {\n    if (this.labelID === id) {\n      return true;\n    }\n    if (this.clones) {\n      for (const cloneID of this.clones) {\n        if (cloneID === id) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n}\n","// import ShowBroadcast from \"./show-broadcast.js\";\nimport Utils from \"./blockly/Utils.js\";\nimport DomHelpers from \"./DomHelpers.js\";\nimport BlockInstance from \"./BlockInstance.js\";\nimport XML from \"./XML.js\";\nimport BlockItem from \"./BlockItem.js\";\nimport UndoGroup from \"./blockly/UndoGroup.js\";\n\nexport default class DevTools {\n  constructor(addon, msg, m, helpHTML) {\n    this.addon = addon;\n    this.msg = msg;\n    this.m = m;\n    /**\n     * @type {VirtualMachine}\n     */\n    this.vm = addon.tab.traps.vm;\n    this.utils = new Utils(addon);\n    this.domHelpers = new DomHelpers(addon);\n    this.multi = new Multi(this.utils);\n\n    this._helpHTML = helpHTML;\n    this.find = null;\n    this.findInp = null;\n    this.ddOut = null;\n    this.dd = null;\n    this.codeTab = null;\n    this.costTab = null;\n    this.costTabBody = null;\n    this.selVarID = null;\n    this.floatInp = null;\n    this.blockCursor = null;\n    this.canShare = false;\n\n    this.mouseXY = { x: 0, y: 0 };\n  }\n\n  async init() {\n    this.addContextMenus();\n    while (true) {\n      const root = await this.addon.tab.waitForElement(\"ul[class*=gui_tab-list_]\", {\n        markAsSeen: true,\n        reduxEvents: [\n          \"scratch-gui/mode/SET_PLAYER\",\n          \"fontsLoaded/SET_FONTS_LOADED\",\n          \"scratch-gui/locales/SELECT_LOCALE\",\n        ],\n        reduxCondition: (state) => !state.scratchGui.mode.isPlayerOnly,\n      });\n      this.initInner(root);\n    }\n  }\n  async addContextMenus() {\n    const blockly = await this.addon.tab.traps.getBlockly();\n    const oldCleanUpFunc = blockly.WorkspaceSvg.prototype.cleanUp;\n    const self = this;\n    blockly.WorkspaceSvg.prototype.cleanUp = function () {\n      if (self.addon.settings.get(\"enableCleanUpPlus\")) {\n        self.doCleanUp();\n      } else {\n        oldCleanUpFunc.call(this);\n      }\n    };\n\n    let originalMsg = blockly.Msg.CLEAN_UP;\n    if (this.addon.settings.get(\"enableCleanUpPlus\")) blockly.Msg.CLEAN_UP = this.m(\"clean-plus\");\n    this.addon.settings.addEventListener(\"change\", () => {\n      if (this.addon.settings.get(\"enableCleanUpPlus\")) blockly.Msg.CLEAN_UP = this.m(\"clean-plus\");\n      else blockly.Msg.CLEAN_UP = originalMsg;\n    });\n\n    this.addon.tab.createBlockContextMenu(\n      (items, block) => {\n        items.push({\n          enabled: blockly.clipboardXml_,\n          text: this.m(\"paste\"),\n          separator: true,\n          _isDevtoolsFirstItem: true,\n          callback: () => {\n            let ids = this.getTopBlockIDs();\n\n            document.dispatchEvent(\n              new KeyboardEvent(\"keydown\", {\n                keyCode: 86,\n                ctrlKey: true,\n                griff: true,\n              })\n            );\n\n            setTimeout(() => {\n              this.beginDragOfNewBlocksNotInIDs(ids);\n            }, 10);\n          },\n        });\n        return items;\n      },\n      { workspace: true }\n    );\n    this.addon.tab.createBlockContextMenu(\n      (items, block) => {\n        items.push(\n          {\n            enabled: true,\n            text: this.m(\"make-space\"),\n            _isDevtoolsFirstItem: true,\n            callback: () => {\n              this.doCleanUp(block);\n            },\n            separator: true,\n          },\n          {\n            enabled: true,\n            text: this.m(\"copy-all\"),\n            callback: () => {\n              this.eventCopyClick(block);\n            },\n            separator: true,\n          },\n          {\n            enabled: true,\n            text: this.m(\"copy-block\"),\n            callback: () => {\n              this.eventCopyClick(block, 1);\n            },\n          },\n          {\n            enabled: true,\n            text: this.m(\"cut-block\"),\n            callback: () => {\n              this.eventCopyClick(block, 2);\n            },\n          }\n        );\n        // const BROADCAST_BLOCKS = [\"event_whenbroadcastreceived\", \"event_broadcast\", \"event_broadcastandwait\"];\n        // if (BROADCAST_BLOCKS.includes(block.type)) {\n        //   // Show Broadcast\n        //   const broadcastId = this.showBroadcastSingleton.getAssociatedBroadcastId(block.id);\n        //   if (broadcastId) {\n        //     [\"Senders\", \"Receivers\"].forEach((showKey, i) => {\n        //       items.push({\n        //         enabled: true,\n        //         text: this.msg(`show-${showKey}`.toLowerCase()),\n        //         callback: () => {\n        //           this.showBroadcastSingleton[`show${showKey}`](broadcastId);\n        //         },\n        //         separator: i == 0,\n        //       });\n        //     });\n        //   }\n        // }\n        return items;\n      },\n      { blocks: true }\n    );\n    this.addon.tab.createBlockContextMenu(\n      (items, block) => {\n        if (block.getCategory() === \"data\" || block.getCategory() === \"data-lists\") {\n          this.selVarID = block.getVars()[0];\n          items.push({\n            enabled: true,\n            text: this.m(\"swap\", { var: block.getCategory() === \"data\" ? this.m(\"variables\") : this.m(\"lists\") }),\n            callback: () => {\n              let wksp = this.utils.getWorkspace();\n              let v = wksp.getVariableById(this.selVarID);\n              let varName = window.prompt(this.msg(\"replace\", { name: v.name }));\n              if (varName) {\n                this.doReplaceVariable(this.selVarID, varName, v.type);\n              }\n            },\n            separator: true,\n          });\n        }\n        return items;\n      },\n      { blocks: true, flyout: true }\n    );\n  }\n\n  isScriptEditor() {\n    return this.codeTab.className.indexOf(\"gui_is-selected\") >= 0;\n  }\n\n  isCostumeEditor() {\n    return this.costTab.className.indexOf(\"gui_is-selected\") >= 0;\n  }\n\n  eventClickHelp(e) {\n    if (!document.getElementById(\"s3devHelpPop\")) {\n      document.body.insertAdjacentHTML(\"beforeend\", this._helpHTML);\n      document.getElementById(\"s3devHelpPop\").addEventListener(\"mousedown\", function (e) {\n        if (e.target.id === \"s3devHelpPop\") {\n          e.target.remove();\n        }\n      });\n      document.querySelector(\"#s3devHelpPop .close-button\").addEventListener(\"click\", function (e) {\n        document.getElementById(\"s3devHelpPop\").remove();\n      });\n    }\n    e.preventDefault();\n  }\n\n  getScratchCostumes() {\n    let costumes = this.costTabBody.querySelectorAll(\"div[class^='sprite-selector-item_sprite-name']\");\n    // this.costTab[0].click();\n\n    let myBlocks = [];\n    let myBlocksByProcCode = {};\n\n    /**\n     * @param cls\n     * @param txt\n     * @param root\n     * @returns BlockItem\n     */\n    function addBlock(cls, txt, root) {\n      let id = root.className;\n      let items = new BlockItem(cls, txt, id, 0);\n      myBlocks.push(items);\n      myBlocksByProcCode[txt] = items;\n      return items;\n    }\n\n    let i = 0;\n    for (const costume of costumes) {\n      addBlock(\"costume\", costume.innerText, costume).y = i;\n      i++;\n    }\n\n    return { procs: myBlocks };\n  }\n\n  /**\n   * Fetch the scratch 3 block list\n   * @returns jsonFetch object\n   */\n  getScratchBlocks() {\n    // Access Blockly!\n\n    let myBlocks = [];\n    let myBlocksByProcCode = {};\n\n    // todo - get blockly from an svg???\n\n    let wksp = this.utils.getWorkspace();\n    let topBlocks = wksp.getTopBlocks();\n\n    // console.log(topBlocks);\n\n    /**\n     * @param cls\n     * @param txt\n     * @param root\n     * @returns BlockItem\n     */\n    function addBlock(cls, txt, root) {\n      let id = root.id ? root.id : root.getId ? root.getId() : null;\n      let clone = myBlocksByProcCode[txt];\n      if (clone) {\n        if (!clone.clones) {\n          clone.clones = [];\n        }\n        clone.clones.push(id);\n        return clone;\n      }\n      let items = new BlockItem(cls, txt, id, 0);\n      items.y = root.getRelativeToSurfaceXY ? root.getRelativeToSurfaceXY().y : null;\n      myBlocks.push(items);\n      myBlocksByProcCode[txt] = items;\n      return items;\n    }\n\n    function getDescFromField(root) {\n      let fields = root.inputList[0];\n      let desc;\n      for (const fieldRow of fields.fieldRow) {\n        desc = (desc ? desc + \" \" : \"\") + fieldRow.getText();\n      }\n      return desc;\n    }\n\n    for (const root of topBlocks) {\n      if (root.type === \"procedures_definition\") {\n        const label = root.getChildren()[0];\n        const procCode = label.getProcCode();\n        if (!procCode) {\n          continue;\n        }\n        const indexOfLabel = root.inputList.findIndex((i) => i.fieldRow.length > 0);\n        if (indexOfLabel === -1) {\n          continue;\n        }\n        const translatedDefine = root.inputList[indexOfLabel].fieldRow[0].getText();\n        const message = indexOfLabel === 0 ? `${translatedDefine} ${procCode}` : `${procCode} ${translatedDefine}`;\n        addBlock(\"define\", message, root);\n        continue;\n      }\n\n      if (root.type === \"event_whenflagclicked\") {\n        addBlock(\"flag\", getDescFromField(root), root); // \"When Flag Clicked\"\n        continue;\n      }\n\n      if (root.type === \"event_whenbroadcastreceived\") {\n        try {\n          // let wksp2 = Blockly.getMainWorkspace().getTopBlocks()[2].inputList[0].fieldRow[1];\n          let fields = root.inputList[0];\n          // let typeDesc = fields.fieldRow[0].getText();\n          let eventName = fields.fieldRow[1].getText();\n          // addBlock('receive', typeDesc + ' ' + eventName, root).eventName = eventName;\n          addBlock(\"receive\", \"event \" + eventName, root).eventName = eventName;\n        } catch (e) {\n          // eat\n        }\n        continue;\n      }\n\n      if (root.type.substr(0, 10) === \"event_when\") {\n        addBlock(\"event\", getDescFromField(root), root); // \"When Flag Clicked\"\n        continue;\n      }\n\n      if (root.type === \"control_start_as_clone\") {\n        addBlock(\"event\", getDescFromField(root), root); // \"when I start as a clone\"\n        continue;\n      }\n    }\n\n    let map = wksp.getVariableMap();\n\n    let vars = map.getVariablesOfType(\"\");\n    for (const row of vars) {\n      addBlock(row.isLocal ? \"var\" : \"VAR\", (row.isLocal ? \"var \" : \"VAR \") + row.name, row);\n    }\n\n    let lists = map.getVariablesOfType(\"list\");\n    for (const row of lists) {\n      addBlock(row.isLocal ? \"list\" : \"LIST\", (row.isLocal ? \"list \" : \"LIST \") + row.name, row);\n    }\n\n    const events = this.getCallsToEvents();\n    for (const event of events) {\n      addBlock(\"receive\", \"event \" + event.eventName, event.block).eventName = event.eventName;\n    }\n\n    /*\n                  const runtime = vm.runtime;\n                  // Now let's also add event broadcasts (not just hat blocks)\n                  const target = runtime.getEditingTarget();\n                  const blocks = target.blocks;\n                  if (blocks._blocks) {\n                      for (const id in blocks._blocks) {\n                          if (!blocks._blocks.hasOwnProperty(id)) {\n                              continue;\n                          }\n                          const block = blocks._blocks[id];\n                          if (block.opcode === 'event_broadcast_menu') {\n\n                              debugger;\n\n                              // Now get the parent block that is the actual broadcast or broadcast and wait\n                              const broadcastBlock = blocks.getBlock(block.parent);\n                              let b = new BlockInstance(target, broadcastBlock);\n\n                              const fieldName = block.fields.BROADCAST_OPTION.value;\n                              addBlock('receive', 'event ' + fieldName, b).eventName = broadcastBlock.eventName;\n\n                              //\n                              // let fields = root.inputList[0];\n                              // let typeDesc = fields.fieldRow[0].getText();\n                              // let eventName = fields.fieldRow[1].getText();\n                              // addBlock('receive', 'event ' + eventName, root).eventName = eventName;\n                          }\n                      }\n                  }\n          */\n\n    const clsOrder = { flag: 0, receive: 1, event: 2, define: 3, var: 4, VAR: 5, list: 6, LIST: 7 };\n\n    myBlocks.sort((a, b) => {\n      let t = clsOrder[a.cls] - clsOrder[b.cls];\n      if (t !== 0) {\n        return t;\n      }\n      if (a.lower < b.lower) {\n        return -1;\n      }\n      if (a.lower > b.lower) {\n        return 1;\n      }\n      return a.y - b.y;\n    });\n\n    return { procs: myBlocks };\n  }\n\n  showDropDown(e, focusID, instanceBlock) {\n    clearTimeout(rhdd);\n    rhdd = 0;\n\n    if (!focusID && this.ddOut.classList.contains(\"vis\")) {\n      return;\n    }\n\n    // special '' vs null... - null forces a reevaluation\n    prevVal = focusID ? \"\" : null; // Clear the previous value of the input search\n\n    this.ddOut.classList.add(\"vis\");\n    let scratchBlocks = this.isCostumeEditor() ? this.getScratchCostumes() : this.getScratchBlocks();\n\n    this.dom_removeChildren(this.dd);\n\n    let foundLi = null;\n    /**\n     * @type {[BlockItem]}\n     */\n    const procs = scratchBlocks.procs;\n    for (const proc of procs) {\n      let li = document.createElement(\"li\");\n      li.innerText = proc.procCode;\n      li.data = proc;\n      li.className = proc.cls;\n      if (focusID) {\n        if (proc.matchesID(focusID)) {\n          foundLi = li;\n          li.classList.add(\"sel\");\n        } else {\n          li.style.display = \"none\";\n        }\n      }\n      this.dd.appendChild(li);\n    }\n\n    let label = document.getElementById(\"s3devFindLabel\");\n    this.utils.offsetX = this.ddOut.getBoundingClientRect().right - label.getBoundingClientRect().left + 26;\n    this.utils.offsetY = 32;\n\n    if (foundLi) {\n      this.clickDropDownRow(foundLi, this.utils.getWorkspace(), instanceBlock);\n    }\n  }\n\n  hideDropDown() {\n    clearTimeout(rhdd);\n    rhdd = setTimeout(() => this.reallyHideDropDown(), 250);\n  }\n\n  reallyHideDropDown() {\n    // Check focus of find box\n    if (this.findInp === document.activeElement) {\n      this.hideDropDown();\n      return;\n    }\n\n    // document.getElementById('s3devReplace').classList.add('s3devHide');\n\n    this.ddOut.classList.remove(\"vis\");\n    rhdd = 0;\n  }\n\n  hideFloatDropDown() {\n    clearTimeout(rhdd2);\n    rhdd2 = setTimeout(() => this.reallyHideFloatDropDown(), 50);\n  }\n\n  reallyHideFloatDropDown(force) {\n    // Check focus of find box\n    if (!force && this.floatInp === document.activeElement) {\n      this.hideFloatDropDown();\n      return;\n    }\n\n    let float = document.getElementById(\"s3devFloatingBar\");\n    if (float) {\n      float.remove();\n    }\n    this.floatInp = null;\n    rhdd2 = 0;\n  }\n\n  dom_removeChildren(myNode) {\n    while (myNode.firstChild) {\n      myNode.removeChild(myNode.firstChild);\n    }\n  }\n\n  /**\n   * A nicely ordered version of the top blocks\n   * @returns {[Blockly.Block]}\n   */\n  getTopBlocks() {\n    let result = this.getOrderedTopBlockColumns();\n    let columns = result.cols;\n    /**\n     * @type {[[Blockly.Block]]}\n     */\n    let topBlocks = [];\n    for (const col of columns) {\n      topBlocks = topBlocks.concat(col.blocks);\n    }\n    return topBlocks;\n  }\n\n  /**\n   * A much nicer way of laying out the blocks into columns\n   */\n  doCleanUp(block) {\n    let workspace = this.utils.getWorkspace();\n    let makeSpaceForBlock = block && block.getRootBlock();\n\n    UndoGroup.startUndoGroup(workspace);\n\n    let result = this.getOrderedTopBlockColumns(true);\n    let columns = result.cols;\n    let orphanCount = result.orphans.blocks.length;\n    if (orphanCount > 0 && !block) {\n      let message = this.msg(\"orphaned\", {\n        count: orphanCount,\n      });\n      if (confirm(message)) {\n        for (const block of result.orphans.blocks) {\n          block.dispose();\n        }\n      } else {\n        columns.unshift(result.orphans);\n      }\n    }\n\n    let cursorX = 48;\n\n    let maxWidths = result.maxWidths;\n\n    for (const column of columns) {\n      let cursorY = 64;\n      let maxWidth = 0;\n\n      for (const block of column.blocks) {\n        let extraWidth = block === makeSpaceForBlock ? 380 : 0;\n        let extraHeight = block === makeSpaceForBlock ? 480 : 72;\n        let xy = block.getRelativeToSurfaceXY();\n        if (cursorX - xy.x !== 0 || cursorY - xy.y !== 0) {\n          block.moveBy(cursorX - xy.x, cursorY - xy.y);\n        }\n        let heightWidth = block.getHeightWidth();\n        cursorY += heightWidth.height + extraHeight;\n\n        let maxWidthWithComments = maxWidths[block.id] || 0;\n        maxWidth = Math.max(maxWidth, Math.max(heightWidth.width + extraWidth, maxWidthWithComments));\n      }\n\n      cursorX += maxWidth + 96;\n    }\n\n    let topComments = workspace.getTopComments();\n    for (const comment of topComments) {\n      if (comment.setVisible) {\n        comment.setVisible(false);\n        comment.needsAutoPositioning_ = true;\n        comment.setVisible(true);\n      }\n    }\n\n    setTimeout(() => {\n      // Locate unused local variables...\n      let workspace = this.utils.getWorkspace();\n      let map = workspace.getVariableMap();\n      let vars = map.getVariablesOfType(\"\");\n      let unusedLocals = [];\n\n      for (const row of vars) {\n        if (row.isLocal) {\n          let usages = map.getVariableUsesById(row.getId());\n          if (!usages || usages.length === 0) {\n            unusedLocals.push(row);\n          }\n        }\n      }\n\n      if (unusedLocals.length > 0) {\n        const unusedCount = unusedLocals.length;\n        let message = this.msg(\"unused-var\", {\n          count: unusedCount,\n        });\n        for (let i = 0; i < unusedLocals.length; i++) {\n          let orphan = unusedLocals[i];\n          if (i > 0) {\n            message += \", \";\n          }\n          message += orphan.name;\n        }\n        if (confirm(message)) {\n          for (const orphan of unusedLocals) {\n            workspace.deleteVariableById(orphan.getId());\n          }\n        }\n      }\n\n      // Locate unused local lists...\n      let lists = map.getVariablesOfType(\"list\");\n      let unusedLists = [];\n\n      for (const row of lists) {\n        if (row.isLocal) {\n          let usages = map.getVariableUsesById(row.getId());\n          if (!usages || usages.length === 0) {\n            unusedLists.push(row);\n          }\n        }\n      }\n      if (unusedLists.length > 0) {\n        const unusedCount = unusedLists.length;\n        let message = this.msg(\"unused-list\", {\n          count: unusedCount,\n        });\n        for (let i = 0; i < unusedLists.length; i++) {\n          let orphan = unusedLists[i];\n          if (i > 0) {\n            message += \", \";\n          }\n          message += orphan.name;\n        }\n        if (confirm(message)) {\n          for (const orphan of unusedLists) {\n            workspace.deleteVariableById(orphan.getId());\n          }\n        }\n      }\n\n      UndoGroup.endUndoGroup(workspace);\n    }, 100);\n  }\n\n  /**\n   * Badly Orphaned - might want to delete these!\n   * @param topBlock\n   * @returns {boolean}\n   */\n  isBlockAnOrphan(topBlock) {\n    return !!topBlock.outputConnection;\n  }\n\n  /**\n   * Split the top blocks into ordered columns\n   * @param separateOrphans true to keep all orphans separate\n   * @returns {{orphans: {blocks: [Block], x: number, count: number}, cols: [Col]}}\n   */\n  getOrderedTopBlockColumns(separateOrphans) {\n    let w = this.utils.getWorkspace();\n    let topBlocks = w.getTopBlocks();\n    let maxWidths = {};\n\n    if (separateOrphans) {\n      let topComments = w.getTopComments();\n\n      // todo: tie comments to blocks... find widths and width of block stack row...\n      for (const comment of topComments) {\n        // comment.autoPosition_();\n        // Hiding and showing repositions the comment right next to it's block - nice!\n        if (comment.setVisible) {\n          comment.setVisible(false);\n          comment.needsAutoPositioning_ = true;\n          comment.setVisible(true);\n\n          // let bb = comment.block_.svgPath_.getBBox();\n          let right = comment.getBoundingRectangle().bottomRight.x;\n\n          // Get top block for stack...\n          let root = comment.block_.getRootBlock();\n          let left = root.getBoundingRectangle().topLeft.x;\n          maxWidths[root.id] = Math.max(right - left, maxWidths[root.id] || 0);\n        }\n      }\n    }\n\n    // Default scratch ordering is horrid... Lets try something more clever.\n\n    /**\n     * @type {Col[]}\n     */\n    let cols = [];\n    const TOLERANCE = 256;\n    let orphans = { x: -999999, count: 0, blocks: [] };\n\n    for (const topBlock of topBlocks) {\n      // let r = b.getBoundingRectangle();\n      let position = topBlock.getRelativeToSurfaceXY();\n      /**\n       * @type {Col}\n       */\n      let bestCol = null;\n      let bestError = TOLERANCE;\n\n      if (separateOrphans && this.isBlockAnOrphan(topBlock)) {\n        orphans.blocks.push(topBlock);\n        continue;\n      }\n\n      // Find best columns\n      for (const col of cols) {\n        let err = Math.abs(position.x - col.x);\n        if (err < bestError) {\n          bestError = err;\n          bestCol = col;\n        }\n      }\n\n      if (bestCol) {\n        // We found a column that we fitted into\n        bestCol.x = (bestCol.x * bestCol.count + position.x) / ++bestCol.count; // re-average the columns as more items get added...\n        bestCol.blocks.push(topBlock);\n      } else {\n        // Create a new column\n        cols.push(new Col(position.x, 1, [topBlock]));\n      }\n    }\n\n    // if (orphans.blocks.length > 0) {\n    //     cols.push(orphans);\n    // }\n\n    // Sort columns, then blocks inside the columns\n    cols.sort((a, b) => a.x - b.x);\n    for (const col of cols) {\n      col.blocks.sort((a, b) => a.getRelativeToSurfaceXY().y - b.getRelativeToSurfaceXY().y);\n    }\n\n    return { cols: cols, orphans: orphans, maxWidths: maxWidths };\n  }\n\n  /**\n   * Find all the uses of a named variable.\n   * @param {string} id ID of the variable to find.\n   * @return {!Array.<!Blockly.Block>} Array of block usages.\n   */\n  getVariableUsesById(id) {\n    let uses = [];\n\n    let topBlocks = this.getTopBlocks(true); // todo: Confirm this was the right getTopBlocks?\n    for (const topBlock of topBlocks) {\n      /** @type {!Array<!Blockly.Block>} */\n      let kids = topBlock.getDescendants();\n      for (const block of kids) {\n        /** @type {!Array<!Blockly.VariableModel>} */\n        let blockVariables = block.getVarModels();\n        if (blockVariables) {\n          for (const blockVar of blockVariables) {\n            if (blockVar.getId() === id) {\n              uses.push(block);\n            }\n          }\n        }\n      }\n    }\n\n    return uses;\n  }\n\n  /**\n   * Find all the uses of a named procedure.\n   * @param {string} id ID of the variable to find.\n   * @return {!Array.<!Blockly.Block>} Array of block usages.\n   */\n  getCallsToProcedureById(id) {\n    let w = this.utils.getWorkspace();\n    let procBlock = w.getBlockById(id);\n    let label = procBlock.getChildren()[0];\n    let procCode = label.getProcCode();\n\n    let uses = [procBlock]; // Definition First, then calls to it\n    let topBlocks = this.getTopBlocks(true);\n    for (const topBlock of topBlocks) {\n      /** @type {!Array<!Blockly.Block>} */\n      let kids = topBlock.getDescendants();\n      for (const block of kids) {\n        if (block.type === \"procedures_call\") {\n          if (block.getProcCode() === procCode) {\n            uses.push(block);\n          }\n        }\n      }\n    }\n\n    return uses;\n  }\n\n  /**\n   * Find all the uses of a named procedure.\n   * @param {string} name name of the variable to find.\n   * @return {!Array.<!Blockly.Block>} Array of block usages.\n   */\n  getCallsToEventsByName(name) {\n    let uses = []; // Definition First, then calls to it\n\n    const runtime = this.vm.runtime;\n    const targets = runtime.targets; // The sprites / stage\n\n    for (const target of targets) {\n      if (!target.isOriginal) {\n        continue; // Skip clones\n      }\n\n      const blocks = target.blocks;\n      if (!blocks._blocks) {\n        continue;\n      }\n\n      for (const id of Object.keys(blocks._blocks)) {\n        const block = blocks._blocks[id];\n        // To find event broadcaster blocks, we look for the nested \"event_broadcast_menu\" blocks first that match the event name\n        if (block.opcode === \"event_broadcast_menu\" && block.fields.BROADCAST_OPTION.value === name) {\n          // Now get the parent block that is the actual broadcast or broadcast and wait\n          const broadcastBlock = blocks.getBlock(block.parent);\n          uses.push(new BlockInstance(target, broadcastBlock));\n        } else if (block.opcode === \"event_whenbroadcastreceived\" && block.fields.BROADCAST_OPTION.value === name) {\n          uses.push(new BlockInstance(target, block));\n        }\n      }\n    }\n\n    return uses;\n  }\n\n  /**\n   * Find all the event broadcasters.\n   * @return {[{eventName:string, block:Block}]} Array of event names and blocks.\n   */\n  getCallsToEvents() {\n    const uses = []; // Definition First, then calls to it\n    const found = {};\n\n    let topBlocks = this.getTopBlocks(true);\n    for (const topBlock of topBlocks) {\n      /** @type {!Array<!Blockly.Block>} */\n      let kids = topBlock.getDescendants();\n      for (const block of kids) {\n        if (block.type === \"event_broadcast\" || block.type === \"event_broadcastandwait\") {\n          const eventName = block.getChildren()[0].inputList[0].fieldRow[0].getText();\n          if (!found[eventName]) {\n            found[eventName] = block;\n            uses.push({ eventName: eventName, block: block });\n          }\n        }\n      }\n    }\n\n    return uses;\n  }\n\n  buildNavigationCarousel(nav, li, blocks, instanceBlock) {\n    if (nav && nav.parentNode === li) {\n      // Same control... click again to go to next\n      this.multi.navRight();\n    } else {\n      if (nav) {\n        nav.remove();\n      }\n      li.insertAdjacentHTML(\n        \"beforeend\",\n        `\n                    <span id=\"s3devMulti\" class=\"s3devMulti\">\n                        <span id=\"s3devMultiLeft\" class=\"s3devNav\">◀</span><span id=\"s3devMultiCount\"></span><span id=\"s3devMultiRight\" class=\"s3devNav\">▶</span>\n                    </span>\n                `\n      );\n      document.getElementById(\"s3devMultiLeft\").addEventListener(\"mousedown\", (...e) => this.multi.navLeft(...e));\n      document.getElementById(\"s3devMultiRight\").addEventListener(\"mousedown\", (...e) => this.multi.navRight(...e));\n\n      this.multi.idx = 0;\n\n      if (instanceBlock) {\n        for (let i = 0; i < blocks.length; i++) {\n          const block = blocks[i];\n          if (block.id === instanceBlock.id) {\n            this.multi.idx = i;\n            break;\n          }\n        }\n        // multi.idx = blocks.indexOf(instanceBlock);\n      }\n\n      this.multi.blocks = blocks;\n      this.multi.update();\n\n      if (this.multi.idx < blocks.length) {\n        this.centerTop(blocks[this.multi.idx]);\n      }\n    }\n  }\n\n  /**\n   * Move a costume to the top or bottom of the list\n   * @param top true for the top, false for the bottom\n   * @param selected optional parameter to pass in the costume div to be moved\n   */\n  moveCostumeTo(top, selected) {\n    let isSelected = !selected || selected.className.indexOf(\"sprite-selector-item_is-selected\") >= 0;\n    if (!selected) {\n      selected = this.costTabBody.querySelectorAll(\"div[class*='sprite-selector-item_is-selected']\");\n      if (selected.length === 0) {\n        return;\n      }\n      selected = selected[0].querySelectorAll(\"div[class^='sprite-selector-item_sprite-name']\")[0];\n    }\n    let costumes = this.costTabBody.querySelectorAll(\"div[class^='sprite-selector-item_sprite-name']\");\n\n    // First scroll sprite view to reveal top or bottom otherwise this won't work.\n    let scroller = selected.closest(\"div[class*=selector_list-area]\");\n    let lastScroll = scroller.scrollTop;\n    scroller.scrollTop = top ? 0 : scroller.scrollHeight;\n\n    this.domHelpers.triggerDragAndDrop(selected, costumes[top ? 0 : costumes.length - 1], undefined);\n    if (!isSelected) {\n      // Restore Scroll position\n      scroller.scrollTop = lastScroll;\n    }\n  }\n\n  /**\n   *\n   * @param li\n   * @param workspace\n   * @param instanceBlock the instance to be highlighted (or null)\n   */\n  clickDropDownRow(li, workspace, instanceBlock) {\n    let nav = document.getElementById(\"s3devMulti\");\n\n    let cls = li.data.cls;\n    if (cls === \"costume\") {\n      // Viewing costumes - jump to selected costume\n      let costumes = this.costTabBody.querySelectorAll(\"div[class^='sprite-selector-item_sprite-name']\");\n      let costume = costumes[li.data.y];\n      if (costume) {\n        costume.click();\n        setTimeout(() => {\n          let wrapper = costume.closest(\"div[class*=gui_flex-wrapper]\");\n          costume.parentElement.parentElement.scrollIntoView({\n            behavior: \"auto\",\n            block: \"center\",\n            inline: \"start\",\n          });\n          wrapper.scrollTop = 0;\n        }, 10);\n      }\n    } else if (cls === \"var\" || cls === \"VAR\" || cls === \"list\" || cls === \"LIST\") {\n      // Search now for all instances\n      // let wksp = getWorkspace();\n      // let blocks = wksp.getVariableUsesById(li.data.labelID);\n      let blocks = this.getVariableUsesById(li.data.labelID);\n      this.buildNavigationCarousel(nav, li, blocks, instanceBlock);\n    } else if (cls === \"define\") {\n      let blocks = this.getCallsToProcedureById(li.data.labelID);\n      this.buildNavigationCarousel(nav, li, blocks, instanceBlock);\n    } else if (cls === \"receive\") {\n      /*\n                          let blocks = [workspace.getBlockById(li.data.labelID)];\n                          if (li.data.clones) {\n                              for (const cloneID of li.data.clones) {\n                                  blocks.push(workspace.getBlockById(cloneID))\n                              }\n                          }\n                          blocks = blocks.concat(getCallsToEventsByName(li.data.eventName));\n              */\n      // Now, fetch the events from the scratch runtime instead of blockly\n      let blocks = this.getCallsToEventsByName(li.data.eventName);\n      if (!instanceBlock) {\n        // Can we start by selecting the first block on 'this' sprite\n        const currentTargetID = this.utils.getEditingTarget().id;\n        for (const block of blocks) {\n          if (block.targetId === currentTargetID) {\n            instanceBlock = block;\n            break;\n          }\n        }\n      }\n      this.buildNavigationCarousel(nav, li, blocks, instanceBlock);\n    } else if (li.data.clones) {\n      let blocks = [workspace.getBlockById(li.data.labelID)];\n      for (const cloneID of li.data.clones) {\n        blocks.push(workspace.getBlockById(cloneID));\n      }\n      this.buildNavigationCarousel(nav, li, blocks, instanceBlock);\n    } else {\n      this.multi.blocks = null;\n      this.centerTop(li.data.labelID);\n      if (nav) {\n        nav.remove();\n      }\n    }\n  }\n\n  dropDownClick(e) {\n    // console.log(e);\n    let workspace = this.utils.getWorkspace();\n\n    if (prevVal === null) {\n      prevVal = this.findInp.value; // Hack to stop filter change if not entered data into edt box, but clicked on row\n    }\n\n    let li = e.target;\n    for (;;) {\n      if (!li || li === this.dd) {\n        return;\n      }\n      if (li.data) {\n        break;\n      }\n      li = li.parentNode;\n    }\n\n    // If this was a mouse click, unselect the keyboard selection\n    // e.navKey is set when this is called from the keyboard handler...\n    if (!e.navKey) {\n      let sel = this.dd.getElementsByClassName(\"sel\");\n      sel = sel.length > 0 ? sel[0] : null;\n      if (sel && sel !== li) {\n        try {\n          sel.classList.remove(\"sel\");\n        } catch (e) {\n          console.log(sel);\n          console.error(e);\n        }\n      }\n      if (li !== sel) {\n        li.classList.add(\"sel\");\n      }\n    }\n\n    this.clickDropDownRow(li, workspace);\n    if (e && e.preventDefault) {\n      e.preventDefault();\n      e.cancelBubble = true;\n    }\n    return false;\n  }\n\n  /**\n   * Based on wksp.centerOnBlock(li.data.labelID);\n   * @param e\n   * @param force if true, the view always moves, otherwise only move if the selected element is not entirely visible\n   */\n  centerTop(e, force) {\n    this.utils.scrollBlockIntoView(e, force);\n  }\n\n  inputChange(e) {\n    if (!this.ddOut.classList.contains(\"vis\")) {\n      this.showDropDown();\n      this.hideDropDown(); // Start timer to hide if not got focus\n    }\n\n    // Filter the list...\n    let val = (this.findInp.value || \"\").toLowerCase();\n    if (val === prevVal) {\n      // No change so don't re-filter\n      return;\n    }\n\n    prevVal = val;\n    this.multi.blocks = null;\n\n    //\n    // Hide items in list that do not contain filter text, and highlight the parts of words that match the filter text\n\n    let listLI = this.dd.getElementsByTagName(\"li\");\n    for (const li of listLI) {\n      let procCode = li.data.procCode;\n      let i = li.data.lower.indexOf(val);\n      if (i >= 0) {\n        li.style.display = \"block\";\n        this.dom_removeChildren(li);\n        if (i > 0) {\n          li.appendChild(document.createTextNode(procCode.substring(0, i)));\n        }\n        let bText = document.createElement(\"b\");\n        bText.appendChild(document.createTextNode(procCode.substr(i, val.length)));\n        li.appendChild(bText);\n        if (i + val.length < procCode.length) {\n          li.appendChild(document.createTextNode(procCode.substr(i + val.length)));\n        }\n        // li.innerHTML = enc(procCode.substring(0, i)) + '<b>' + enc(procCode.substr(i, val.length)) + \"</b>\" + enc(procCode.substr(i + val.length));\n      } else {\n        li.style.display = \"none\";\n      }\n    }\n  }\n\n  /**\n   * Select previous or next item in the drop down filter list\n   * @param dir direction of navigation: -1=up, 1=down\n   */\n  navigateFilter(dir) {\n    let sel = this.dd.getElementsByClassName(\"sel\");\n    let nxt;\n    if (sel.length > 0 && sel[0].style.display !== \"none\") {\n      nxt = dir === -1 ? sel[0].previousSibling : sel[sel.length - 1].nextSibling;\n    } else {\n      nxt = this.dd.children[0];\n      dir = 1;\n    }\n    while (nxt && nxt.style.display === \"none\") {\n      nxt = dir === -1 ? nxt.previousSibling : nxt.nextSibling;\n    }\n    if (nxt) {\n      for (const i of sel) {\n        i.classList.remove(\"sel\");\n      }\n      nxt.classList.add(\"sel\");\n      this.dropDownClick({ target: nxt, navKey: true });\n      // centerTop(nxt.data.labelID);\n    }\n  }\n\n  inputKeyDown(e) {\n    // Up Arrow\n    if (e.keyCode === 38) {\n      this.navigateFilter(-1);\n      e.preventDefault();\n      return;\n    }\n\n    // Down Arrow\n    if (e.keyCode === 40) {\n      this.navigateFilter(1);\n      e.preventDefault();\n      return;\n    }\n\n    // Left Arrow\n    if (e.keyCode === 37) {\n      let sel = this.dd.getElementsByClassName(\"sel\");\n      if (sel && this.multi.blocks) {\n        this.multi.navLeft(e);\n      }\n    }\n\n    // Right Arrow\n    if (e.keyCode === 39) {\n      let sel = this.dd.getElementsByClassName(\"sel\");\n      if (sel && this.multi.blocks) {\n        this.multi.navRight(e);\n      }\n    }\n\n    // Enter\n    if (e.keyCode === 13) {\n      // Any selected on enter? if not select now\n      let sel = this.dd.getElementsByClassName(\"sel\");\n      if (sel.length === 0) {\n        this.navigateFilter(1);\n      }\n      // noinspection JSUnresolvedFunction\n      document.activeElement.blur();\n      e.preventDefault();\n      return;\n    }\n\n    // Escape\n    if (e.keyCode === 27) {\n      if (this.findInp.value.length > 0) {\n        this.findInp.value = \"\"; // Clear search first, then close on second press\n        this.inputChange(e);\n      } else {\n        // noinspection JSUnresolvedFunction\n        document.activeElement.blur();\n      }\n      e.preventDefault();\n      return;\n    }\n  }\n\n  /*\n    function deepSearch(e) {\n      document.body.insertAdjacentHTML(\n        \"beforeend\",\n        `\n              <div id=\"s3devOverlay\">\n              </div>\n          `\n      );\n\n      let overlay = document.getElementById(\"s3devOverlay\");\n      overlay.addEventListener(\"click\", function (e) {\n        overlay.remove();\n      });\n\n      // todo: use scratch runtime instead!\n\n      const runtime = vm.runtime;\n      const targets = runtime.targets; // The sprites / stage\n\n      let dict = {};\n\n      for (const target of targets) {\n        if (!target.isOriginal) {\n          continue; // Skip clones\n        }\n\n        const name = target.getName();\n        const isStage = target.isStage;\n        const blocks = target.blocks;\n        const scripts = blocks.getScripts();\n\n        let divElement = document.createElement(\"div\");\n        divElement.appendChild(document.createTextNode(\"Searching in \" + name));\n        divElement.appendChild(document.createTextNode(\", Top Scripts x\" + scripts.length));\n        overlay.appendChild(divElement);\n\n        const sprite = (dict[name] = {});\n        sprite.scripts = [];\n\n        for (const script of scripts) {\n          const block = blocks.getBlock(script);\n          const top = { id: script, opcode: block.opcode, block: block };\n          sprite.scripts.push(top);\n        }\n      }\n\n      e.preventDefault();\n      return true;\n    }\n  */\n\n  /**\n   * Quick and dirty replace all instances of one variable / list with another variable / list\n   * @param varId original variable name\n   * @param newVarName new variable name\n   * @param type type of variable (\"\" = variable, anything else is a list?\n   */\n  doReplaceVariable(varId, newVarName, type) {\n    let wksp = this.utils.getWorkspace();\n    let v = wksp.getVariable(newVarName, type);\n    if (!v) {\n      alert(this.msg(\"var-not-exist\"));\n      return;\n    }\n    let newVId = v.getId();\n\n    UndoGroup.startUndoGroup(wksp);\n    let blocks = this.getVariableUsesById(varId);\n    for (const block of blocks) {\n      try {\n        if (type === \"\") {\n          block.getField(\"VARIABLE\").setValue(newVId);\n        } else {\n          block.getField(\"LIST\").setValue(newVId);\n        }\n      } catch (e) {\n        // ignore\n      }\n    }\n    UndoGroup.endUndoGroup(wksp);\n  }\n\n  /*\n    function doInjectScripts(codeString) {\n      let w = getWorkspace();\n      let xml = new XML(); // document.implementation.createDocument(null, \"xml\");\n      let x = xml.xmlDoc.firstChild;\n\n      let tree = math.parse(codeString);\n      console.log(tree);\n\n      const binaryOperatorTypes = {\n        add: \"operator_add\",\n        subtract: \"operator_subtract\",\n        this.multiply: \"operator_multiply\",\n        divide: \"operator_divide\",\n      };\n\n      const BLOCK_TYPE = {\n        number: \"math_number\",\n        text: \"text\",\n      };\n\n      function translateMathToXml(x, tree, shadowType) {\n        let xShadowField = null;\n        if (shadowType) {\n          let xShadow = xml.newXml(x, \"shadow\", { type: shadowType });\n          if (shadowType === BLOCK_TYPE.number) {\n            xShadowField = xml.newXml(xShadow, \"field\", { name: \"NUM\" });\n          } else if (shadowType === BLOCK_TYPE.text) {\n            xShadowField = xml.newXml(xShadow, \"field\", { name: \"TEXT\" });\n          }\n        }\n\n        if (!tree || !tree.type) {\n          return;\n        }\n\n        if (tree.type === \"OperatorNode\") {\n          let operatorType = binaryOperatorTypes[tree.fn];\n          if (operatorType) {\n            let xOp = newXml(x, \"block\", { type: operatorType });\n            translateMathToXml(xml.newXml(xOp, \"value\", { name: \"NUM1\" }), tree.args[0], BLOCK_TYPE.number);\n            translateMathToXml(xml.newXml(xOp, \"value\", { name: \"NUM2\" }), tree.args[1], BLOCK_TYPE.number);\n            return;\n          }\n\n          return;\n        }\n\n        if (tree.type === \"ConstantNode\") {\n          // number or text in quotes\n          if (xShadowField) {\n            xml.setAttr(xShadowField, { text: tree.value });\n          }\n          return;\n        }\n\n        if (tree.type === \"SymbolNode\") {\n          // variable\n          let xVar = xml.newXml(x, \"block\", { type: \"data_variable\" });\n          xml.newXml(xVar, \"field\", { name: \"VARIABLE\", text: tree.name });\n          return;\n        }\n\n        if (tree.type === \"FunctionNode\") {\n          // Method Call\n          if (tree.fn.name === \"join\") {\n            let xOp = newXml(x, \"block\", { type: \"operator_join\" });\n            translateMathToXml(xml.newXml(xOp, \"value\", { name: \"STRING1\" }), tree.args[0], BLOCK_TYPE.text);\n            translateMathToXml(xml.newXml(xOp, \"value\", { name: \"STRING2\" }), tree.args[1], BLOCK_TYPE.text);\n            return;\n          }\n        }\n      }\n\n      translateMathToXml(x, tree);\n      console.log(x);\n\n      let ids = Blockly.Xml.domToWorkspace(x, w);\n      console.log(ids);\n    }\n     */\n  /*\n    function clickInject(e) {\n      let codeString = window.prompt(\"Griffpatch: Enter an expression (i.e. a+2*3)\");\n      if (codeString) {\n        doInjectScripts(codeString);\n      }\n      e.preventDefault();\n      return false;\n    }\n    */\n\n  /**\n   * Returns a Set of the top blocks in this workspace / sprite\n   * @returns {Set<any>} Set of top blocks\n   */\n  getTopBlockIDs() {\n    let wksp = this.utils.getWorkspace();\n    let topBlocks = wksp.getTopBlocks();\n    let ids = new Set();\n    for (const block of topBlocks) {\n      ids.add(block.id);\n    }\n    return ids;\n  }\n\n  /**\n   * Initiates a drag event for all block stacks except those in the set of ids.\n   * But why? - Because we know all the ids of the existing stacks before we paste / duplicate - so we can find the\n   * new stack by excluding all the known ones.\n   * @param ids Set of previously known ids\n   */\n  beginDragOfNewBlocksNotInIDs(ids) {\n    if (!this.addon.settings.get(\"enablePasteBlocksAtMouse\")) {\n      return;\n    }\n    let wksp = this.utils.getWorkspace();\n    let topBlocks = wksp.getTopBlocks();\n    for (const block of topBlocks) {\n      if (!ids.has(block.id)) {\n        // console.log(\"I found a new block!!! - \" + block.id);\n        // todo: move the block to the mouse pointer?\n        let mouseXYClone = { x: this.mouseXY.x, y: this.mouseXY.y };\n        block.setIntersects(true); // fixes offscreen block pasting in TurboWarp\n        this.domHelpers.triggerDragAndDrop(block.svgPath_, null, mouseXYClone);\n      }\n    }\n  }\n\n  updateMousePosition(e) {\n    this.mouseXY.x = e.clientX;\n    this.mouseXY.y = e.clientY;\n  }\n\n  eventMouseMove(e) {\n    this.updateMousePosition(e);\n  }\n\n  eventKeyDown(e) {\n    function switchCostume(up) {\n      // todo: select previous costume\n      let selected = this.costTabBody.querySelector(\"div[class*='sprite-selector-item_is-selected']\");\n      let node = up ? selected.parentNode.previousSibling : selected.parentNode.nextSibling;\n      if (node) {\n        let wrapper = node.closest(\"div[class*=gui_flex-wrapper]\");\n        node.querySelector(\"div[class^='sprite-selector-item_sprite-name']\").click();\n        node.scrollIntoView({\n          behavior: \"auto\",\n          block: \"center\",\n          inline: \"start\",\n        });\n        wrapper.scrollTop = 0;\n      }\n    }\n\n    if (document.URL.indexOf(\"editor\") <= 0) {\n      return;\n    }\n\n    let ctrlKey = e.ctrlKey || e.metaKey;\n\n    if (e.key === \"f\" && ctrlKey && !e.shiftKey) {\n      // Ctrl + F (Override default Ctrl+F find)\n      this.findInp.focus();\n      this.findInp.select();\n      e.cancelBubble = true;\n      e.preventDefault();\n      return true;\n    }\n\n    if (e.key === \" \" && ctrlKey) {\n      // Ctrl + Space (Inject Code)\n      this.middleClickWorkspace(e);\n      e.cancelBubble = true;\n      e.preventDefault();\n      return true;\n    }\n\n    if (e.keyCode === 37 && ctrlKey) {\n      // Ctrl + Left Arrow Key\n      if (document.activeElement.tagName === \"INPUT\") {\n        return;\n      }\n      // todo: if (!this.addon.settings.get(\"enableCtrlLeftRightNav\")) {\n      //         return;\n      //       }\n      if (this.isScriptEditor()) {\n        this.utils.navigationHistory.goBack();\n      } else if (this.isCostumeEditor()) {\n        switchCostume(true);\n      }\n      e.cancelBubble = true;\n      e.preventDefault();\n      return true;\n    }\n\n    if (e.keyCode === 39 && ctrlKey) {\n      // Ctrl + Right Arrow Key\n      if (document.activeElement.tagName === \"INPUT\") {\n        return;\n      }\n      // todo: if (!this.addon.settings.get(\"enableCtrlLeftRightNav\")) {\n      //         return;\n      //       }\n      if (this.isScriptEditor()) {\n        this.utils.navigationHistory.goForward();\n      } else if (this.isCostumeEditor()) {\n        switchCostume(false);\n      }\n      e.cancelBubble = true;\n      e.preventDefault();\n      return true;\n    }\n\n    if (e.keyCode === 86 && ctrlKey && !e.griff) {\n      // Ctrl + V\n      // Set a timeout so we can take control of the paste after the event\n      let ids = this.getTopBlockIDs();\n      setTimeout(() => {\n        this.beginDragOfNewBlocksNotInIDs(ids);\n      }, 10);\n    }\n\n    // if (e.keyCode === 220 && (!document.activeElement || document.activeElement.tagName === 'INPUT')) {\n    //\n    // }\n  }\n\n  eventCopyClick(block, blockOnly) {\n    let wksp = this.utils.getWorkspace();\n\n    if (block) {\n      block.select();\n      let next = blockOnly ? block.getNextBlock() : null;\n      if (next) {\n        next.unplug(false); // setParent(null);\n      }\n\n      // separate child temporarily\n      document.dispatchEvent(new KeyboardEvent(\"keydown\", { keyCode: 67, ctrlKey: true }));\n      if (next || blockOnly === 2) {\n        setTimeout(() => {\n          if (next) {\n            wksp.undo(); // undo the unplug above...\n          }\n          if (blockOnly === 2) {\n            UndoGroup.startUndoGroup(wksp);\n            block.dispose(true);\n            UndoGroup.endUndoGroup(wksp);\n          }\n        }, 0);\n      }\n    }\n  }\n\n  eventMouseDown(e) {\n    this.updateMousePosition(e);\n\n    if (this.ddOut && this.ddOut.classList.contains(\"vis\") && !e.target.closest(\"#s3devDDOut\")) {\n      // If we click outside the dropdown, then instigate the hide code...\n      this.hideDropDown();\n    }\n\n    if (this.floatInp && !e.target.closest(\"#s3devIDDOut\")) {\n      if (\n        !e.shiftKey ||\n        // Clicking on the code area should always make multi-inject work\n        (!document.getElementsByClassName(\"injectionDiv\")[0].contains(e.target) &&\n          // Focused inputs are not part of the injectionDiv, but to the user they are part of the code area so make multi-inject work there\n          !e.target.classList.contains(\"blocklyHtmlInput\")) ||\n        // This selector targets workspace buttons (Make a Block etc.) and the extension (!) buttons, which most commonly trigger a popup window so always close the dropdown\n        e.target.matches(\".blocklyFlyoutButton, .blocklyFlyoutButton *, .blocklyTouchTargetBackground\")\n      ) {\n        // If we click outside the dropdown, then instigate the hide code...\n        this.hideFloatDropDown();\n      }\n    }\n\n    if (e.button === 1 || e.shiftKey) {\n      // Wheel button...\n      try {\n        this.middleClick(e);\n      } catch (x) {\n        console.error(x);\n      }\n    } else if (e.button === 2) {\n      // Right click...\n      /*\n      let spriteSelector = e.target.closest(\"#react-tabs-3 div[class*='sprite-selector-item_sprite-selector-item']\");\n      if (spriteSelector) {\n        let contextMenu = spriteSelector.getElementsByTagName(\"nav\")[0];\n        if (!contextMenu.querySelector(\"div.s3devSTT\")) {\n          contextMenu.insertAdjacentHTML(\n            \"beforeend\",\n            `\n                            <div class=\"${this.addon.tab.scratchClass(\n                              \"context-menu_menu-item\",\n                              \"context-menu_menu-item-bordered\",\n                              {\n                                others: [\"react-contextmenu-item\", \"s3devSTT\"],\n                              }\n                            )}\" role=\"menuitem\"\n                                tabindex=\"-1\" aria-disabled=\"false\"><span>${this.m(\"top\")}</span></div>\n                            <div class=\"${this.addon.tab.scratchClass(\"context-menu_menu-item\", {\n                              others: [\"react-contextmenu-item\", \"s3devSTT\"],\n                            })}\" role=\"menuitem\"\n                                tabindex=\"-1\" aria-disabled=\"false\"><span>${this.m(\"bottom\")}</span></div>\n                        `\n          );\n        }\n      }\n      */\n    } else {\n      let chk = e.target;\n      if (chk && chk.tagName !== \"BUTTON\" && chk.getAttribute && !chk.getAttribute(\"role\")) {\n        chk = chk.parentNode;\n        if (chk && chk.tagName !== \"BUTTON\" && chk.getAttribute && !chk.getAttribute(\"role\")) {\n          chk = chk.parentNode;\n        }\n      }\n\n      if (chk && chk.className && chk.className.indexOf) {\n        if (!this.canShare && chk.className.indexOf(\"share-button\") >= 0) {\n          // Commented for ScratchAddons\n          /*e.cancelBubble = true;\n                      e.preventDefault();\n\n                      if (confirm(\"Griffpatch: Are you sure you want to share?\")) {\n                          // action the share!\n                          canShare = true;\n                          chk.click();\n                      }*/\n\n          return;\n        }\n      }\n\n      chk = e.target.tagName === \"SPAN\" ? e.target.parentNode : e.target;\n\n      if (chk.classList.contains(\"s3devSTT\")) {\n        if (chk.textContent === this.m(\"top\") || chk.textContent === this.m(\"bottom\")) {\n          let spriteSelector = e.target.closest(\"div[class*='sprite-selector-item_sprite-selector-item']\");\n          this.moveCostumeTo(chk.textContent === this.m(\"top\"), spriteSelector);\n          e.cancelBubble = true;\n          e.preventDefault();\n        }\n      }\n    }\n  }\n\n  eventMouseUp(e) {\n    this.updateMousePosition(e);\n\n    if (e.button === 1 && e.target.closest(\"svg.blocklySvg\")) {\n      // On Linux systems, middle click is often treated as a paste.\n      // We do not want this as we assign our own functionality to middle mouse.\n      e.preventDefault();\n    }\n  }\n\n  middleClickWorkspace(e) {\n    if (!this.isScriptEditor()) {\n      return;\n    }\n\n    // todo: if (!this.addon.settings.get(\"enableBlockInjector\")) {\n    //         return;\n    //       }\n\n    e.cancelBubble = true;\n    e.preventDefault();\n\n    let floatBar = document.getElementById(\"s3devFloatingBar\");\n    if (floatBar) {\n      floatBar.remove();\n    }\n\n    // Popup new input box for block injection\n    document.body.insertAdjacentHTML(\n      \"beforeend\",\n      `\n            <div id=\"s3devFloatingBar\" dir=\"${this.addon.tab.direction}\">\n                <label class='title s3devLabel' id=s3devInsertLabel>\n                    <span style=\"display:none;\">${this.m(\"insert\")} </span>\n                    <span id=s3devInsert class=\"s3devWrap\">\n                        <div id='s3devIDDOut' class=\"s3devDDOut\">\n                            <input id='s3devIInp' class=\"${this.addon.tab.scratchClass(\"input_input-form\", {\n                              others: \"s3devInp\",\n                            })}\" type='search' placeholder='${this.m(\"start-typing\")}' autocomplete='off'>\n                            <ul id='s3devIDD' class=\"s3devDD\"></ul>\n                        </div>\n                    </span>\n                </label>\n            </div>\n        `\n    );\n\n    floatBar = document.getElementById(\"s3devFloatingBar\");\n    floatBar.style.left = this.mouseXY.x + 16 + \"px\";\n    floatBar.style.top = this.mouseXY.y - 8 + \"px\";\n\n    this.floatInp = document.getElementById(\"s3devIInp\");\n    this.floatInp.focus();\n\n    // Build Filter List...\n\n    this.buildFloatingFilterList(e, floatBar);\n\n    const ddOut = document.getElementById(\"s3devIDDOut\");\n    ddOut.addEventListener(\"mousedown\", (...e) => this.dropDownFloatClick(...e));\n\n    this.floatInp.addEventListener(\"keyup\", (...e) => this.floatInputChange(...e));\n    this.floatInp.addEventListener(\"focus\", (...e) => this.floatInputChange(...e));\n    this.floatInp.addEventListener(\"keydown\", (...e) => this.floatInputKeyDown(...e));\n  }\n\n  middleClick(e) {\n    // Intercept clicks to allow jump to...?\n    let blockSvg = e.target.closest(\"[data-id]\");\n    if (!blockSvg) {\n      // Ok, so no selection... are we at least clicking on the workspace?\n      if (e.target.closest(\"svg.blocklySvg\")) {\n        this.blockCursor = null; // Clear the cursor if using the mouse\n        this.middleClickWorkspace(e);\n      }\n      return;\n    }\n\n    if (!this.addon.settings.get(\"enableMiddleClickFinder\")) {\n      return;\n    }\n\n    let w = this.utils.getWorkspace();\n    let dataId = blockSvg.getAttribute(\"data-id\");\n    let block = w.getBlockById(dataId);\n    if (!block) {\n      return;\n    }\n\n    // Move outwards until we reach a block we can take action on\n\n    for (; block; block = block.getSurroundParent()) {\n      if (block.type === \"procedures_call\") {\n        e.cancelBubble = true;\n        e.preventDefault();\n\n        // todo: navigate to definition\n        let findProcCode = block.getProcCode();\n\n        let wksp = this.utils.getWorkspace();\n        let topBlocks = wksp.getTopBlocks();\n        for (const root of topBlocks) {\n          if (root.type === \"procedures_definition\") {\n            let label = root.getChildren()[0];\n            let procCode = label.getProcCode();\n            if (procCode && procCode === findProcCode) {\n              // Found... navigate to it!\n              this.centerTop(root);\n              return;\n            }\n          }\n        }\n      }\n\n      if (block.type === \"procedures_definition\") {\n        let id = block.id ? block.id : block.getId ? block.getId() : null;\n\n        this.findInp.focus();\n        this.showDropDown(null, id);\n        // findInp.select();\n\n        e.cancelBubble = true;\n        e.preventDefault();\n        return;\n      }\n\n      if (\n        block.type === \"data_variable\" ||\n        block.type === \"data_changevariableby\" ||\n        block.type === \"data_setvariableto\"\n      ) {\n        let id = block.getVars()[0];\n\n        this.findInp.focus();\n        this.showDropDown(null, id, block);\n\n        // let button = document.getElementById('s3devReplace');\n\n        this.selVarID = id;\n        // button.classList.remove('s3devHide');\n\n        e.cancelBubble = true;\n        e.preventDefault();\n        return;\n      }\n\n      if (\n        block.type === \"event_whenbroadcastreceived\" ||\n        block.type === \"event_broadcastandwait\" ||\n        block.type === \"event_broadcast\"\n      ) {\n        // todo: actually index the broadcasts...!\n        let id = block.id;\n\n        this.findInp.focus();\n        this.showDropDown(null, id, block);\n\n        this.selVarID = id;\n\n        e.cancelBubble = true;\n        e.preventDefault();\n        return;\n      }\n    }\n\n    e.cancelBubble = true;\n    e.preventDefault();\n  }\n\n  getEdgeTypeClass(block) {\n    switch (block.edgeShape_) {\n      case 1:\n        return \"boolean\";\n      case 2:\n        return \"reporter\";\n      default:\n        return block.startHat_ ? \"hat\" : \"block\";\n    }\n  }\n\n  buildFloatingFilterList(e, floatBar) {\n    // todo: Iterate through the toolbox?\n\n    let options = [];\n\n    let t = this.utils.getWorkspace().getToolbox();\n\n    let blocks = t.flyout_.getWorkspace().getTopBlocks();\n    // 107 blocks, not in order... but we can sort by y value or description right :)\n\n    let fullDom = Blockly.Xml.workspaceToDom(t.flyout_.getWorkspace());\n    const doms = {};\n    for (const x of fullDom.children) {\n      if (x.tagName === \"BLOCK\") {\n        // let type = x.getAttribute('type');\n        let id = x.getAttribute(\"id\");\n        doms[id] = x;\n      }\n    }\n\n    for (const block of blocks) {\n      this.getBlockText(block, options, doms);\n    }\n\n    // Griffpatch - on second thoughts - lets sort blocks by length so that shortest ones appear at the top.\n    options.sort((a, b) =>\n      a.desc.length < b.desc.length ? -1 : a.desc.length > b.desc.length ? 1 : a.desc.localeCompare(b.desc)\n    );\n\n    // Previous sort was just alphabetical\n    // options.sort((a, b) => a.desc.localeCompare(b.desc));\n\n    const dd = document.getElementById(\"s3devIDD\");\n\n    let count = 0;\n    //DROPDOWN_BLOCK_LIST_MAX_ROWS\n\n    for (const option of options) {\n      const li = document.createElement(\"li\");\n      const desc = option.desc;\n\n      // bType = hat block reporter boolean\n\n      let bType = this.getEdgeTypeClass(option.block);\n\n      count++;\n\n      li.innerText = desc;\n      li.data = { text: desc, lower: \" \" + desc.toLowerCase(), option: option };\n      li.className =\n        \"var \" + (option.block.isScratchExtension ? \"extension\" : option.block.getCategory()) + \" \" + bType; // proc.cls;\n      if (count > DROPDOWN_BLOCK_LIST_MAX_ROWS) {\n        // Limit maximum number of rows to prevent lag when no filter is applied\n        li.style.display = \"none\";\n      }\n      dd.appendChild(li);\n    }\n\n    const ddOut = document.getElementById(\"s3devIDDOut\");\n    ddOut.classList.add(\"vis\");\n\n    // console.log(options);\n  }\n\n  /**\n   * Flesh out a blocks description - duplicate up blocks with contained picklists (like list drop downs)\n   * @param block\n   * @param options\n   * @param doms\n   * @returns {string}\n   */\n  getBlockText(block, options, doms) {\n    // block.type;  \"looks_nextbackdrop\"\n\n    let desc;\n    let picklist, pickField;\n\n    let dom = doms[block.id];\n\n    // dom = doms[block.type];\n\n    const process = (block) => {\n      for (const input of block.inputList) {\n        // input.name = \"\", input.type = 5\n        let fields = input.fieldRow;\n        for (const field of fields) {\n          // field --- Blockly.FieldLabel .className = \"blocklyText\"\n          // Blockly.FieldDropdown --- .className = \"blocklyText blocklyDropdownText\"\n\n          let text;\n\n          if (!picklist && field.className_ === \"blocklyText blocklyDropdownText\") {\n            picklist = field.getOptions();\n            pickField = field.name;\n            if (picklist && picklist.length > 0) {\n              text = \"^^\";\n            } else {\n              text = field.getText();\n            }\n          } else {\n            text = field.getText();\n          }\n\n          desc = (desc ? desc + \" \" : \"\") + text;\n        }\n\n        if (input.connection) {\n          let innerBlock = input.connection.targetBlock();\n          if (innerBlock) {\n            process(innerBlock); // Recursive process connected child blocks...\n          }\n        }\n      }\n    };\n\n    process(block);\n\n    if (picklist) {\n      for (const item of picklist) {\n        let code = item[1];\n        if (\n          typeof code !== \"string\" || // Audio Record is a function!\n          code === \"DELETE_VARIABLE_ID\" ||\n          code === \"RENAME_VARIABLE_ID\" ||\n          code === \"NEW_BROADCAST_MESSAGE_ID\" ||\n          code === \"NEW_BROADCAST_MESSAGE_ID\" ||\n          // editor-searchable-dropdowns compatibility\n          code === \"createGlobalVariable\" ||\n          code === \"createLocalVariable\" ||\n          code === \"createGlobalList\" ||\n          code === \"createLocalList\" ||\n          code === \"createBroadcast\"\n        ) {\n          continue; // Skip these\n        }\n        options.push({\n          desc: desc.replace(\"^^\", item[0]),\n          block: block,\n          dom: dom,\n          option: item,\n          pickField: pickField,\n        });\n      }\n    } else {\n      options.push({ desc: desc, block: block, dom: dom });\n    }\n\n    return desc;\n  }\n\n  floatInputKeyDown(e) {\n    if (e.keyCode === 38) {\n      this.navigateFloatFilter(-1);\n      e.preventDefault();\n      return;\n    }\n    if (e.keyCode === 40) {\n      this.navigateFloatFilter(1);\n      e.preventDefault();\n      return;\n    }\n    if (e.keyCode === 13) {\n      // Enter\n      let dd = document.getElementById(\"s3devIDD\");\n      let sel = dd.querySelector(\".sel\");\n      if (sel) {\n        this.dropDownFloatClick(e);\n      }\n      e.cancelBubble = true;\n      e.preventDefault();\n      return;\n    }\n    if (e.keyCode === 27) {\n      // Escape\n      let findInp = document.getElementById(\"s3devIInp\");\n      if (findInp.value.length > 0) {\n        findInp.value = \"\"; // Clear search first, then close on second press\n        this.floatInputChange(e);\n      } else {\n        this.reallyHideFloatDropDown(true);\n      }\n      e.preventDefault();\n      return;\n    }\n  }\n\n  navigateFloatFilter(dir) {\n    let dd = document.getElementById(\"s3devIDD\");\n    let sel = dd.getElementsByClassName(\"sel\");\n    let nxt;\n    if (sel.length > 0 && sel[0].style.display !== \"none\") {\n      nxt = dir === -1 ? sel[0].previousSibling : sel[sel.length - 1].nextSibling;\n    } else {\n      nxt = dd.children[0];\n      dir = 1;\n    }\n    while (nxt && nxt.style.display === \"none\") {\n      nxt = dir === -1 ? nxt.previousSibling : nxt.nextSibling;\n    }\n    if (nxt) {\n      for (const i of sel) {\n        i.classList.remove(\"sel\");\n      }\n      nxt.classList.add(\"sel\");\n      // centerTop(nxt.data.labelID);\n    }\n  }\n\n  /**\n   * This is a feature in progress - can we have a virtual cursor that allows the next injected element position be automated\n   * @param block a blockly block\n   * @param typ type\n   */\n  findNextHole(block, typ) {\n    /*\n      const inputs = block.inputList;\n      if (inputs) {\n        /!** Blockly.Input *!/\n        for (const input of inputs) {\n          const fieldRow = input.fieldRow;\n          if (fieldRow) {\n            /!** Blockly.FieldNumber *!/\n            for (const field of fieldRow) {\n              if (field.argType_ && field.argType_.includes(typ)) {\n              }\n            }\n          }\n        }\n      }\n  */\n  }\n\n  /**\n   * Inject the selected block into the script\n   * @param e\n   */\n  dropDownFloatClick(e) {\n    e.cancelBubble = true;\n    if (!e.target.closest(\"input\")) {\n      e.preventDefault();\n    }\n\n    let wksp = this.utils.getWorkspace();\n\n    let sel = e && e.target;\n    if (sel.tagName === \"B\") {\n      sel = sel.parentNode;\n    }\n\n    if (e instanceof MouseEvent && sel.tagName !== \"LI\") {\n      // Mouse clicks need to be on a block...\n      return;\n    }\n\n    if (!sel || !sel.data) {\n      let dd = document.getElementById(\"s3devIDD\");\n      sel = dd.querySelector(\".sel\");\n    }\n\n    if (!sel) {\n      return;\n    }\n\n    const xml = new XML();\n    let x = xml.xmlDoc.firstChild;\n    let option = sel.data.option;\n    // block:option.block, dom:option.dom, option:option.option\n    if (option.option) {\n      // We need to tweak the dropdown in this xml...\n      let field = option.dom.querySelector(\"field[name=\" + option.pickField + \"]\");\n      if (field.getAttribute(\"id\")) {\n        field.innerText = option.option[0];\n        field.setAttribute(\"id\", option.option[1] + \"-\" + option.option[0]);\n      } else {\n        field.innerText = option.option[1]; // griffpatch - oops! option.option[1] not 0?\n      }\n\n      // Handle \"stop other scripts in sprite\"\n      if (option.option[1] === \"other scripts in sprite\") {\n        option.dom.querySelector(\"mutation\").setAttribute(\"hasnext\", \"true\");\n      }\n    }\n\n    x.appendChild(option.dom);\n\n    let ids = Blockly.Xml.domToWorkspace(x, wksp);\n\n    if (!e.shiftKey) {\n      this.reallyHideFloatDropDown(true);\n    }\n\n    let block = wksp.getBlockById(ids[0]);\n\n    if (this.blockCursor) {\n      // What sort of block did we just inject?\n      let typ = this.getEdgeTypeClass(option.block);\n      if (typ === \"boolean\") {\n        this.findNextHole(this.blockCursor, \"\");\n      } else if (typ === \"reporter\") {\n        this.findNextHole(this.blockCursor, typ);\n      }\n    }\n\n    this.domHelpers.triggerDragAndDrop(block.svgPath_, null, { x: this.mouseXY.x, y: this.mouseXY.y }, e.shiftKey);\n\n    if (e.shiftKey) {\n      document.getElementById(\"s3devIInp\").focus();\n    }\n\n    this.blockCursor = block;\n  }\n\n  floatInputChange(e) {\n    let ddOut = document.getElementById(\"s3devIDDOut\");\n\n    if (!ddOut.classList.contains(\"vis\")) {\n      // showDropDown();\n      // hideDropDown(); // Start timer to hide if not got focus\n    }\n\n    let findInp = document.getElementById(\"s3devIInp\");\n\n    // Filter the list...\n    let val = (findInp.value || \"\").toLowerCase();\n    if (val === prevVal) {\n      return;\n    }\n\n    prevVal = val;\n    this.multi.blocks = null;\n\n    let dd = document.getElementById(\"s3devIDD\");\n    let p = dd.parentNode;\n    dd.remove();\n\n    let count = 0;\n\n    let split = val.split(\" \");\n    let listLI = dd.getElementsByTagName(\"li\");\n    for (const li of listLI) {\n      const procCode = li.data.text;\n      const lower = li.data.lower;\n      // let i = li.data.lower.indexOf(val);\n      // let array = regExp.exec(li.data.lower);\n\n      let im = 0;\n      let match = [];\n      for (let si = 0; si < split.length; si++) {\n        let find = \" \" + split[si];\n        let idx = lower.indexOf(find, im);\n        if (idx === -1) {\n          match = null;\n          break;\n        }\n        match.push(idx);\n        im = idx + find.length;\n      }\n\n      if (count < DROPDOWN_BLOCK_LIST_MAX_ROWS && match) {\n        li.style.display = \"block\";\n        this.dom_removeChildren(li);\n\n        let i = 0;\n\n        for (let iM = 0; iM < match.length; iM++) {\n          let im = match[iM];\n          if (im > i) {\n            li.appendChild(document.createTextNode(procCode.substring(i, im)));\n            i = im;\n          }\n          let bText = document.createElement(\"b\");\n          let len = split[iM].length;\n          bText.appendChild(document.createTextNode(procCode.substr(i, len)));\n          li.appendChild(bText);\n          i += len;\n        }\n\n        if (i < procCode.length) {\n          li.appendChild(document.createTextNode(procCode.substr(i)));\n        }\n\n        if (count === 0) {\n          li.classList.add(\"sel\");\n        } else {\n          li.classList.remove(\"sel\");\n        }\n        count++;\n      } else {\n        li.style.display = \"none\";\n        li.classList.remove(\"sel\");\n      }\n    }\n    p.append(dd);\n  }\n\n  initInner(root) {\n    let guiTabs = root.childNodes;\n\n    if (this.codeTab && guiTabs[0] !== this.codeTab) {\n      // We have been CHANGED!!! - Happens when going to project page, and then back inside again!!!\n      this.domHelpers.unbindAllEvents();\n    }\n\n    this.codeTab = guiTabs[0];\n    this.costTab = guiTabs[1];\n    this.costTabBody = document.querySelector(\"div[aria-labelledby=\" + this.costTab.id + \"]\");\n\n    if (!document.getElementById(\"s3devFind\")) {\n      // noinspection JSUnresolvedVariable\n      root.insertAdjacentHTML(\n        \"beforeend\",\n        `\n                <div id=\"s3devToolBar\">\n                    <div class='title s3devLabel' id=s3devFindLabel>\n                        <label for=\"s3devInp\">${this.m(\"find\")} ${\n          this.addon.self._isDevtoolsExtension\n            ? \"\"\n            : '<a href=\"#\" class=\"s3devAction\" id=\"s3devHelp\" style=\"/*s-a*/ margin-left: 0; font-size: 10px; /*s-a*/\">(?)</a>'\n        } </label>\n                        <span id=s3devFind class=\"s3devWrap\">\n                            <label id='s3devDDOut' class=\"s3devDDOut\">\n                                <input id='s3devInp' class=\"${this.addon.tab.scratchClass(\"input_input-form\", {\n                                  others: \"s3devInp\",\n                                })}\" type='search' placeholder='${this.m(\"find-placeholder\")}' autocomplete='off'>\n                                <ul id='s3devDD' class=\"s3devDD\"></ul>\n                            </label>\n                        </span>\n                        <a id=\"s3devDeep\" class=\"s3devAction s3devHide\" href=\"#\">${this.m(\"deep\")}</a>\n                        <div ${\n                          this.addon.self._isDevtoolsExtension ? \"\" : 'style=\"display: none;\"'\n                        }><a href=\"#\" class=\"s3devAction\" id=\"s3devHelp\"><b>${this.m(\"help\")}</b></a>\n                        <a href=\"https://www.youtube.com/griffpatch\" class=\"s3devAction\" target=\"_blank\" id=\"s3devHelp\" rel=\"noreferrer noopener\">${this.m(\n                          \"tutorials\"\n                        )}</a></div>\n                    </div>\n                </div>\n            `\n      );\n\n      this.find = document.getElementById(\"s3devFind\");\n      this.findInp = document.getElementById(\"s3devInp\");\n      this.ddOut = document.getElementById(\"s3devDDOut\");\n      this.domHelpers.bindOnce(this.ddOut, \"mousedown\", (...e) => this.dropDownClick(...e), undefined);\n      this.dd = document.getElementById(\"s3devDD\");\n\n      // bindOnce(find, 'mouseenter', showDropDown);\n      // bindOnce(find, 'mouseleave', hideDropDown);\n      this.domHelpers.bindOnce(this.findInp, \"keyup\", (...e) => this.inputChange(...e), undefined);\n      this.domHelpers.bindOnce(this.findInp, \"keydown\", (...e) => this.inputKeyDown(...e), undefined);\n      this.domHelpers.bindOnce(this.findInp, \"focus\", (...e) => this.inputChange(...e), undefined);\n\n      this.domHelpers.bindOnce(\n        document.getElementById(\"s3devHelp\"),\n        \"click\",\n        (...e) => this.eventClickHelp(...e),\n        undefined\n      );\n\n      this.domHelpers.bindOnce(document, \"keydown\", (...e) => this.eventKeyDown(...e), true);\n    }\n\n    this.domHelpers.bindOnce(document, \"mousemove\", (...e) => this.eventMouseMove(...e), true);\n    this.domHelpers.bindOnce(document, \"mousedown\", (...e) => this.eventMouseDown(...e), true); // true to capture all mouse downs 'before' the dom events handle them\n    this.domHelpers.bindOnce(document, \"mouseup\", (...e) => this.eventMouseUp(...e), true);\n  }\n}\n\nclass Multi {\n  constructor(utils) {\n    this.idx = 0;\n    this.blocks = null;\n    this.selID = null;\n    /**\n     * @type {Utils}\n     */\n    this.utils = utils;\n  }\n\n  update() {\n    const count = document.getElementById(\"s3devMultiCount\");\n    count.innerText = this.blocks && this.blocks.length > 0 ? enc(this.idx + 1 + \" / \" + this.blocks.length) : \"0\";\n    this.selID = this.idx < this.blocks.length ? this.blocks[this.idx].id : null;\n  }\n\n  navLeft(e) {\n    return this.navSideways(e, -1);\n  }\n\n  navRight(e) {\n    return this.navSideways(e, 1);\n  }\n\n  navSideways(e, dir) {\n    if (this.blocks && this.blocks.length > 0) {\n      this.idx = (this.idx + dir + this.blocks.length) % this.blocks.length; // + length to fix negative modulo js issue.\n      this.update();\n      this.utils.scrollBlockIntoView(this.blocks[this.idx]);\n    }\n    if (e) {\n      e.cancelBubble = true;\n      e.preventDefault();\n    }\n    return false;\n  }\n}\n\nclass Col {\n  /**\n   * @param x {Number} x position (for ordering)\n   * @param count {Number}\n   * @param blocks {[Block]}\n   */\n  constructor(x, count, blocks) {\n    /**\n     * x position (for ordering)\n     * @type {Number}\n     */\n    this.x = x;\n    /**\n     * @type {Number}\n     */\n    this.count = count;\n    /**\n     * @type {[Blockly.Block]}\n     */\n    this.blocks = blocks;\n  }\n}\n\nconst DROPDOWN_BLOCK_LIST_MAX_ROWS = 25;\n\nlet rhdd = 0;\nlet rhdd2 = 0;\nlet prevVal = \"\";\n\nfunction enc(str) {\n  return String(str).replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\");\n}\n","export default class DomHelpers {\n  constructor(addon) {\n    this.addon = addon;\n    this.vm = addon.tab.traps.vm;\n    /**\n     * @type {eventDetails[]}\n     */\n    this.events = [];\n  }\n\n  /**\n   * Simulate a drag and drop programmatically through javascript\n   * @param selectorDrag\n   * @param selectorDrop\n   * @param mouseXY\n   * @param [shiftKey=false]\n   * @returns {boolean}\n   */\n  triggerDragAndDrop(selectorDrag, selectorDrop, mouseXY, shiftKey) {\n    // function for triggering mouse events\n    shiftKey = shiftKey || false;\n    let fireMouseEvent = function (type, elem, centerX, centerY) {\n      let evt = document.createEvent(\"MouseEvents\");\n      evt.initMouseEvent(type, true, true, window, 1, 1, 1, centerX, centerY, shiftKey, false, false, false, 0, elem);\n      elem.dispatchEvent(evt);\n    };\n\n    // fetch target elements\n    let elemDrag = selectorDrag; // document.querySelector(selectorDrag);\n    let elemDrop = selectorDrop; // document.querySelector(selectorDrop);\n    if (!elemDrag /* || !elemDrop*/) {\n      return false;\n    }\n\n    // calculate positions\n    let pos = elemDrag.getBoundingClientRect();\n    let center1X = Math.floor((pos.left + pos.right) / 2);\n    let center1Y = Math.floor((pos.top + pos.bottom) / 2);\n\n    // mouse over dragged element and mousedown\n    fireMouseEvent(\"mouseover\", elemDrag, center1X, center1Y);\n    fireMouseEvent(\"mousedown\", elemDrag, center1X, center1Y);\n\n    // start dragging process over to drop target\n    fireMouseEvent(\"dragstart\", elemDrag, center1X, center1Y);\n    fireMouseEvent(\"drag\", elemDrag, center1X, center1Y);\n    fireMouseEvent(\"mousemove\", elemDrag, center1X, center1Y);\n\n    if (!elemDrop) {\n      if (mouseXY) {\n        // console.log(mouseXY);\n        let center2X = mouseXY.x;\n        let center2Y = mouseXY.y;\n        fireMouseEvent(\"drag\", elemDrag, center2X, center2Y);\n        fireMouseEvent(\"mousemove\", elemDrag, center2X, center2Y);\n      }\n      return false;\n    }\n\n    pos = elemDrop.getBoundingClientRect();\n    let center2X = Math.floor((pos.left + pos.right) / 2);\n    let center2Y = Math.floor((pos.top + pos.bottom) / 2);\n\n    fireMouseEvent(\"drag\", elemDrag, center2X, center2Y);\n    fireMouseEvent(\"mousemove\", elemDrop, center2X, center2Y);\n\n    // trigger dragging process on top of drop target\n    fireMouseEvent(\"mouseenter\", elemDrop, center2X, center2Y);\n    fireMouseEvent(\"dragenter\", elemDrop, center2X, center2Y);\n    fireMouseEvent(\"mouseover\", elemDrop, center2X, center2Y);\n    fireMouseEvent(\"dragover\", elemDrop, center2X, center2Y);\n\n    // release dragged element on top of drop target\n    fireMouseEvent(\"drop\", elemDrop, center2X, center2Y);\n    fireMouseEvent(\"dragend\", elemDrag, center2X, center2Y);\n    fireMouseEvent(\"mouseup\", elemDrag, center2X, center2Y);\n\n    return true;\n  }\n\n  bindOnce(dom, event, func, capture) {\n    capture = !!capture;\n    dom.removeEventListener(event, func, capture);\n    dom.addEventListener(event, func, capture);\n    this.events.push(new eventDetails(dom, event, func, capture));\n  }\n\n  unbindAllEvents() {\n    for (const event of this.events) {\n      event.dom.removeEventListener(event.event, event.func, event.capture);\n    }\n    this.events = [];\n  }\n}\n\n/**\n * A record of an event\n */\nclass eventDetails {\n  constructor(dom, event, func, capture) {\n    this.dom = dom;\n    this.event = event;\n    this.func = func;\n    this.capture = capture;\n  }\n}\n","/**\n * A fake XML class to use in place of the real XML for faking things?\n */\nexport default class XML {\n  constructor() {\n    this.xmlDoc = document.implementation.createDocument(null, \"xml\");\n  }\n\n  newXml(x, tagName, attrs) {\n    let xAdd = this.xmlDoc.createElement(tagName);\n    x.appendChild(xAdd);\n    return this.setAttr(xAdd, attrs);\n  }\n\n  setAttr(x, attrs) {\n    if (attrs) {\n      for (const key of Object.keys(attrs)) {\n        if (key === \"text\") {\n          x.appendChild(this.xmlDoc.createTextNode(attrs[key]));\n        } else {\n          x.setAttribute(key, attrs[key]);\n        }\n      }\n    }\n    return x;\n  }\n}\n","/* generated by pull.js */\nimport _js from \"./userscript.js\";\nimport _css from \"!css-loader!./userscript.css\";\nexport const resources = {\n  \"userscript.js\": _js,\n  \"userscript.css\": _css,\n};\n","/**\n * Helper class to flash a Blockly scratch block in the users workspace\n */\nexport default class BlockFlasher {\n  /**\n   * FLash a block 3 times\n   * @param block the block to flash\n   */\n  static flash(block) {\n    if (myFlash.timerID > 0) {\n      clearTimeout(myFlash.timerID);\n      if (myFlash.block.svgPath_) {\n        myFlash.block.svgPath_.style.fill = \"\";\n      }\n    }\n\n    let count = 4;\n    let flashOn = true;\n    myFlash.block = block;\n\n    /**\n     * Internal method to switch the colour of a block between light yellow and it's original colour\n     * @private\n     */\n    function _flash() {\n      if (myFlash.block.svgPath_) {\n        myFlash.block.svgPath_.style.fill = flashOn ? \"#ffff80\" : \"\";\n      }\n      flashOn = !flashOn;\n      count--;\n      if (count > 0) {\n        myFlash.timerID = setTimeout(_flash, 200);\n      } else {\n        myFlash.timerID = 0;\n        myFlash.block = null;\n      }\n    }\n\n    _flash();\n  }\n}\n\nconst myFlash = { block: null, timerID: null };\n","/**\n * This class is dedicated to maintaining the Undo stack of Blockly\n * It allows us to initiate an undo group such that all subsequent operations are recorded as a single\n * undoable transaction.\n */\nexport default class UndoGroup {\n  /**\n   * Start an Undo group - begin recording\n   * @param workspace the workspace\n   */\n  static startUndoGroup(workspace) {\n    const undoStack = workspace.undoStack_;\n    if (undoStack.length) {\n      undoStack[undoStack.length - 1]._devtoolsLastUndo = true;\n    }\n  }\n\n  /**\n   * End an Undo group - stops recording\n   * @param workspace the workspace\n   */\n  static endUndoGroup(workspace) {\n    const undoStack = workspace.undoStack_;\n    // Events (responsible for undoStack updates) are delayed with a setTimeout(f, 0)\n    // https://github.com/LLK/scratch-blocks/blob/f159a1779e5391b502d374fb2fdd0cb5ca43d6a2/core/events.js#L182\n    setTimeout(() => {\n      const group = generateUID();\n      for (let i = undoStack.length - 1; i >= 0 && !undoStack[i]._devtoolsLastUndo; i--) {\n        undoStack[i].group = group;\n      }\n    }, 0);\n  }\n}\n\n/**\n * https://github.com/LLK/scratch-blocks/blob/f159a1779e5391b502d374fb2fdd0cb5ca43d6a2/core/events.js#L182\n * @returns {string}\n * @private\n */\nfunction generateUID() {\n  const CHARACTERS = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!#$%()*+,-./:;=?@[]^_`{|}~\";\n  let result = \"\";\n  for (let i = 0; i < 20; i++) {\n    result += CHARACTERS[Math.floor(Math.random() * CHARACTERS.length)];\n  }\n  return result;\n}\n","import BlockInstance from \"../BlockInstance.js\";\nimport BlockFlasher from \"./BlockFlasher.js\";\n\n// A file to split Editor Devtools by features.\n\nexport default class Utils {\n  constructor(addon) {\n    this.addon = addon;\n    this.addon.tab.traps.getBlockly().then((blockly) => {\n      this.blockly = blockly;\n    });\n    /**\n     * Scratch Virtual Machine\n     * @type {null|*}\n     */\n    this.vm = this.addon.tab.traps.vm;\n    // this._myFlash = { block: null, timerID: null, colour: null };\n    this.offsetX = 32;\n    this.offsetY = 32;\n    this.navigationHistory = new NavigationHistory(this);\n    /**\n     * The workspace\n     */\n    this._workspace = null;\n  }\n\n  /**\n   * Get the Scratch Editing Target\n   * @returns {?Target} the scratch editing target\n   */\n  getEditingTarget() {\n    return this.vm.runtime.getEditingTarget();\n  }\n\n  /**\n   * Set the current workspace (switches sprites)\n   * @param targetID {string}\n   */\n  setEditingTarget(targetID) {\n    if (this.getEditingTarget().id !== targetID) {\n      this.vm.setEditingTarget(targetID);\n    }\n  }\n\n  /**\n   * Returns the main workspace\n   * @returns !Blockly.Workspace\n   */\n  getWorkspace() {\n    const currentWorkspace = Blockly.getMainWorkspace();\n    if (currentWorkspace.getToolbox()) {\n      // Sadly get get workspace does not always return the 'real' workspace... Not sure how to get that at the moment,\n      //  but we can work out whether it's the right one by whether it has a toolbox.\n      this._workspace = currentWorkspace;\n    }\n    return this._workspace;\n  }\n\n  /**\n   * Based on wksp.centerOnBlock(li.data.labelID);\n   * @param blockOrId {Blockly.Block|{id}|BlockInstance} A Blockly Block, a block id, or a BlockInstance\n   */\n  scrollBlockIntoView(blockOrId) {\n    let workspace = this.getWorkspace();\n    /** @type {Blockly.Block} */\n    let block; // or is it really a Blockly.BlockSvg?\n\n    if (blockOrId instanceof BlockInstance) {\n      // Switch to sprite\n      this.setEditingTarget(blockOrId.targetId);\n      // Highlight the block!\n      block = workspace.getBlockById(blockOrId.id);\n    } else {\n      block = blockOrId && blockOrId.id ? blockOrId : workspace.getBlockById(blockOrId);\n    }\n\n    if (!block) {\n      return;\n    }\n\n    /**\n     * !Blockly.Block\n     */\n    let root = block.getRootBlock();\n    let base = this.getTopOfStackFor(block);\n    let ePos = base.getRelativeToSurfaceXY(), // Align with the top of the block\n      rPos = root.getRelativeToSurfaceXY(), // Align with the left of the block 'stack'\n      scale = workspace.scale,\n      x = rPos.x * scale,\n      y = ePos.y * scale,\n      xx = block.width + x, // Turns out they have their x & y stored locally, and they are the actual size rather than scaled or including children...\n      yy = block.height + y,\n      s = workspace.getMetrics();\n    if (\n      x < s.viewLeft + this.offsetX - 4 ||\n      xx > s.viewLeft + s.viewWidth ||\n      y < s.viewTop + this.offsetY - 4 ||\n      yy > s.viewTop + s.viewHeight\n    ) {\n      // sx = s.contentLeft + s.viewWidth / 2 - x,\n      let sx = x - s.contentLeft - this.offsetX,\n        // sy = s.contentTop - y + Math.max(Math.min(32, 32 * scale), (s.viewHeight - yh) / 2);\n        sy = y - s.contentTop - this.offsetY;\n\n      this.navigationHistory.storeView(this.navigationHistory.peek(), 64);\n\n      // workspace.hideChaff(),\n      workspace.scrollbar.set(sx, sy);\n      this.navigationHistory.storeView({ left: sx, top: sy }, 64);\n    }\n    this.blockly?.hideChaff();\n    BlockFlasher.flash(block);\n  }\n\n  /**\n   * Find the top stack block of a stack\n   * @param block a block in a stack\n   * @returns {*} a block that is the top of the stack of blocks\n   */\n  getTopOfStackFor(block) {\n    let base = block;\n    while (base.getOutputShape() && base.getSurroundParent()) {\n      base = base.getSurroundParent();\n    }\n    return base;\n  }\n}\n\nclass NavigationHistory {\n  constructor(utils) {\n    this.utils = utils;\n    this.views = [];\n    this.forward = [];\n  }\n\n  /**\n   * Keep a record of the scroll and zoom position\n   */\n  storeView(next, dist) {\n    this.forward = [];\n    let workspace = this.utils.getWorkspace(),\n      s = workspace.getMetrics();\n\n    let pos = { left: s.viewLeft, top: s.viewTop };\n    if (!next || distance(pos, next) > dist) {\n      this.views.push(pos);\n    }\n  }\n\n  peek() {\n    return this.views.length > 0 ? this.views[this.views.length - 1] : null;\n  }\n\n  goBack() {\n    const workspace = this.utils.getWorkspace(),\n      s = workspace.getMetrics();\n\n    let pos = { left: s.viewLeft, top: s.viewTop };\n    let view = this.peek();\n    if (!view) {\n      return;\n    }\n    if (distance(pos, view) < 64) {\n      // Go back to current if we are already far away from it\n      if (this.views.length > 1) {\n        this.views.pop();\n        this.forward.push(view);\n      }\n    }\n\n    view = this.peek();\n    if (!view) {\n      return;\n    }\n\n    let sx = view.left - s.contentLeft,\n      sy = view.top - s.contentTop;\n\n    // transform.setTranslate(-600,0);\n\n    workspace.scrollbar.set(sx, sy);\n\n    /*\n              let blocklySvg = document.getElementsByClassName('blocklySvg')[0];\n              let blocklyBlockCanvas = blocklySvg.getElementsByClassName('blocklyBlockCanvas')[0];\n              let transform = blocklyBlockCanvas.transform.baseVal.getItem(0);\n              let scale = blocklyBlockCanvas.transform.baseVal.getItem(1);\n\n              let transformMatrix = transform.matrix;\n              let scaleMatrix = scale.matrix;\n\n              console.log('Transform - getMetrics', s);\n              console.log('sx, sy: ', sx, sy);\n              console.log('left, top: ', view.left, view.top);\n              console.log('contentLeft, right:', s.contentLeft, s.contentTop);\n              console.log('transform, scale matrix: ', transformMatrix, scaleMatrix);\n  */\n  }\n\n  goForward() {\n    let view = this.forward.pop();\n    if (!view) {\n      return;\n    }\n    this.views.push(view);\n\n    let workspace = this.utils.getWorkspace(),\n      s = workspace.getMetrics();\n\n    let sx = view.left - s.contentLeft,\n      sy = view.top - s.contentTop;\n\n    workspace.scrollbar.set(sx, sy);\n  }\n}\n\nfunction distance(pos, next) {\n  return Math.sqrt(Math.pow(pos.left - next.left, 2) + Math.pow(pos.top - next.top, 2));\n}\n","/* inserted by pull.js */\nimport _twAsset0 from \"!url-loader!./icon--close.svg\";\nconst _twGetAsset = (path) => {\n  if (path === \"/icon--close.svg\") return _twAsset0;\n  throw new Error(`Unknown asset: ${path}`);\n};\n\nimport DevTools from \"./DevTools.js\";\n\nexport default async function ({ addon, global, console, msg, safeMsg: m }) {\n  const guiDirection = addon.tab.direction;\n  const helpHTML = `\n<div id=\"s3devHelpPop\" class=\"${addon.tab.scratchClass(\"modal_modal-overlay\")}\" dir=\"${guiDirection}\">\n<div class=\"${addon.tab.scratchClass(\"modal_modal-content\")}\">\n<div class=\"${addon.tab.scratchClass(\"modal_header\")}\">\n  <div class=\"${addon.tab.scratchClass(\"modal_header-item\", \"modal_header-item-title\")}\">${m(\"help-title\")}</div>\n  <div class=\"${addon.tab.scratchClass(\"modal_header-item\", \"modal_header-item-close\")}\">\n    <div class=\"${addon.tab.scratchClass(\"close-button_close-button\", \"close-button_large\", {\n      others: \"close-button\",\n    })}\">\n\t  <img class=\"${addon.tab.scratchClass(\"close-button_close-icon\")}\" src=\"${_twGetAsset(\"/icon--close.svg\")}\">\n\t</div>\n  </div>\n</div>\n<div id=\"s3devHelpContent\">\n<h2><strong>${m(\"code-tab-features\")}</strong></h2>\n<p dir=\"auto\"><strong>${m(\"interactive-find-bar\")}</strong> &ndash; ${m(\"interactive-find-bar-desc\")}</p>\n<p dir=\"auto\"><strong>${m(\"improved-tidy-up\")}</strong> &ndash; ${m(\"improved-tidy-up-desc\")}</p>\n<p dir=\"auto\"><strong>${m(\"help-make-space\")} ${m(\"help-new\")}</strong> &ndash; ${m(\"help-make-space-desc\")}</p>\n<p dir=\"auto\"><strong>${m(\"copy-to-clipboard\")}</strong> &ndash; ${m(\"copy-to-clipboard-desc\")}</p>\n<p dir=\"auto\"><strong>${m(\"paste-from-clipboard\")}</strong> &ndash; ${m(\"paste-from-clipboard-desc\")}</p>\n<p dir=\"auto\"><strong>${m(\"swap-variable\")}</strong> &ndash; ${m(\"swap-variable-desc\")}</p>\n<p dir=\"auto\"><strong>${m(\"middleclick\")}</strong> &ndash; ${m(\"middleclick-desc\")}</p>\n<p dir=\"auto\"><strong>${m(\"ctrl-lr\")}</strong> &ndash; ${m(\"ctrl-lr-desc\")}</p>\n<p dir=\"auto\"><strong>${m(\"ctrl-space\")}</strong> &ndash; ${m(\"ctrl-space-desc\")}</p>\n<hr />\n<h2><strong>${m(\"costume-tab-features\")}</strong></h2>\n<p dir=\"auto\"><strong>${m(\"find-bar\")}</strong> &ndash; ${m(\"find-bar-costume-desc\")}</p>\n<p dir=\"auto\"><strong>${m(\"ctrl-lr\")}</strong> &ndash; ${m(\"ctrl-lr-costume-desc\")}</p>\n<hr />\n<p>${m(\n    \"youtube\"\n  )} -&nbsp;<a target=\"_blank\" href=\"https://www.youtube.com/griffpatch\" rel=\"noopener noreferrer\">https://www.youtube.com/user/griffpatch</a></p>\n</div>\n</div>\n</div>\n`;\n\n  const devTools = new DevTools(addon, msg, m, helpHTML);\n  devTools.init();\n}\n","/* generated by pull.js */\nimport _js from \"./userscript.js\";\nimport _css from \"!css-loader!./userscript.css\";\nexport const resources = {\n  \"userscript.js\": _js,\n  \"userscript.css\": _css,\n};\n","export default async function ({ addon, global, console, msg }) {\n  const Blockly = await addon.tab.traps.getBlockly();\n  const vm = addon.tab.traps.vm;\n\n  const SCRATCH_ITEMS_TO_HIDE = [\n    \"RENAME_VARIABLE_ID\",\n    \"DELETE_VARIABLE_ID\",\n    \"NEW_BROADCAST_MESSAGE_ID\",\n    // From rename-broadcasts addon\n    \"RENAME_BROADCAST_MESSAGE_ID\",\n  ];\n\n  const ADDON_ITEMS = [\n    \"createGlobalVariable\",\n    \"createLocalVariable\",\n    \"createGlobalList\",\n    \"createLocalList\",\n    \"createBroadcast\",\n  ];\n\n  let blocklyDropDownContent = null;\n  let blocklyDropdownMenu = null;\n  let searchBar = null;\n  // Contains DOM and addon state\n  let items = [];\n  let searchedItems = [];\n  // Tracks internal Scratch state\n  let currentDropdownOptions = [];\n  let resultOfLastGetOptions = [];\n\n  const oldDropDownDivShow = Blockly.DropDownDiv.show;\n  Blockly.DropDownDiv.show = function (...args) {\n    blocklyDropdownMenu = document.querySelector(\".blocklyDropdownMenu\");\n    if (!blocklyDropdownMenu) {\n      return oldDropDownDivShow.call(this, ...args);\n    }\n\n    blocklyDropdownMenu.focus = () => {}; // no-op focus() so it can't steal it from the search bar\n\n    searchBar = document.createElement(\"input\");\n    addon.tab.displayNoneWhileDisabled(searchBar, { display: \"flex\" });\n    searchBar.type = \"text\";\n    searchBar.addEventListener(\"input\", updateSearch);\n    searchBar.addEventListener(\"keydown\", handleKeyDownEvent);\n    searchBar.classList.add(\"u-dropdown-searchbar\");\n    blocklyDropdownMenu.insertBefore(searchBar, blocklyDropdownMenu.firstChild);\n\n    items = Array.from(blocklyDropdownMenu.children)\n      .filter((child) => child.tagName !== \"INPUT\")\n      .map((element) => ({\n        element,\n        text: element.textContent,\n      }));\n    currentDropdownOptions = resultOfLastGetOptions;\n    updateSearch();\n\n    // Call the original show method after adding everything so that it can perform the correct size calculations\n    const ret = oldDropDownDivShow.call(this, ...args);\n\n    // Lock the size of the dropdown\n    blocklyDropDownContent = Blockly.DropDownDiv.getContentDiv();\n    blocklyDropDownContent.style.width = getComputedStyle(blocklyDropDownContent).width;\n    blocklyDropDownContent.style.height = getComputedStyle(blocklyDropDownContent).height;\n\n    // This is really strange, but if you don't reinsert the search bar into the DOM then focus() doesn't work\n    blocklyDropdownMenu.insertBefore(searchBar, blocklyDropdownMenu.firstChild);\n    searchBar.focus();\n\n    return ret;\n  };\n\n  const oldDropDownDivClearContent = Blockly.DropDownDiv.clearContent;\n  Blockly.DropDownDiv.clearContent = function () {\n    oldDropDownDivClearContent.call(this);\n    items = [];\n    searchedItems = [];\n    Blockly.DropDownDiv.content_.style.height = \"\";\n  };\n\n  const oldFieldDropdownGetOptions = Blockly.FieldDropdown.prototype.getOptions;\n  Blockly.FieldDropdown.prototype.getOptions = function () {\n    const options = oldFieldDropdownGetOptions.call(this);\n    const block = this.sourceBlock_;\n    const isStage = vm.editingTarget && vm.editingTarget.isStage;\n    if (block) {\n      if (block.category_ === \"data\") {\n        options.push(getMenuItemMessage(\"createGlobalVariable\"));\n        if (!isStage) {\n          options.push(getMenuItemMessage(\"createLocalVariable\"));\n        }\n      } else if (block.category_ === \"data-lists\") {\n        options.push(getMenuItemMessage(\"createGlobalList\"));\n        if (!isStage) {\n          options.push(getMenuItemMessage(\"createLocalList\"));\n        }\n      } else if (block.type === \"event_broadcast_menu\" || block.type === \"event_whenbroadcastreceived\") {\n        options.push(getMenuItemMessage(\"createBroadcast\"));\n      }\n    }\n    // Options aren't normally stored anywhere, so we'll store them ourselves.\n    resultOfLastGetOptions = options;\n    return options;\n  };\n\n  const oldFieldVariableOnItemSelected = Blockly.FieldVariable.prototype.onItemSelected;\n  Blockly.FieldVariable.prototype.onItemSelected = function (menu, menuItem) {\n    const sourceBlock = this.sourceBlock_;\n    if (sourceBlock && sourceBlock.workspace && searchBar.value.length !== 0) {\n      const workspace = sourceBlock.workspace;\n      const id = menuItem.getValue();\n      switch (id) {\n        case \"createGlobalVariable\": {\n          Blockly.Events.setGroup(true);\n          const variable = workspace.createVariable(searchBar.value);\n          // Creating a variable can cause blocks in the flyout to be disposed and recreated\n          // That could cause setValue to throw\n          if (this.sourceBlock_) this.setValue(variable.getId());\n          Blockly.Events.setGroup(false);\n          return;\n        }\n        case \"createLocalVariable\": {\n          Blockly.Events.setGroup(true);\n          const variable = workspace.createVariable(searchBar.value, \"\", null, true);\n          if (this.sourceBlock_) this.setValue(variable.getId());\n          Blockly.Events.setGroup(false);\n          return;\n        }\n        case \"createGlobalList\": {\n          Blockly.Events.setGroup(true);\n          const variable = workspace.createVariable(searchBar.value, \"list\");\n          if (this.sourceBlock_) this.setValue(variable.getId());\n          Blockly.Events.setGroup(false);\n          return;\n        }\n        case \"createLocalList\": {\n          Blockly.Events.setGroup(true);\n          const variable = workspace.createVariable(searchBar.value, \"list\", null, true);\n          if (this.sourceBlock_) this.setValue(variable.getId());\n          Blockly.Events.setGroup(false);\n          return;\n        }\n        case \"createBroadcast\": {\n          Blockly.Events.setGroup(true);\n          const variable = workspace.createVariable(searchBar.value, \"broadcast_msg\");\n          this.setValue(variable.getId());\n          Blockly.Events.setGroup(false);\n          return;\n        }\n      }\n    }\n    return oldFieldVariableOnItemSelected.call(this, menu, menuItem);\n  };\n\n  function selectItem(item, click) {\n    // You can't just use click() or focus() because Blockly uses mousedown and mouseup handlers, not click handlers.\n    item.dispatchEvent(new MouseEvent(\"mousedown\", { relatedTarget: item, bubbles: true }));\n    if (click) item.dispatchEvent(new MouseEvent(\"mouseup\", { relatedTarget: item, bubbles: true }));\n\n    // Scroll the item into view if it is offscreen.\n    const itemTop = item.offsetTop;\n    const itemEnd = itemTop + item.offsetHeight;\n\n    const scrollTop = blocklyDropDownContent.scrollTop;\n    const scrollHeight = blocklyDropDownContent.offsetHeight;\n    const scrollEnd = scrollTop + scrollHeight;\n\n    if (scrollTop > itemTop) {\n      blocklyDropDownContent.scrollTop = itemTop;\n    } else if (itemEnd > scrollEnd) {\n      blocklyDropDownContent.scrollTop = itemEnd - scrollHeight;\n    }\n  }\n\n  function performSearch() {\n    const query = searchBar.value.toLowerCase().trim();\n    const rank = (item, index) => {\n      // Negative number will hide\n      // Higher numbers will appear first\n      const option = currentDropdownOptions[index];\n      if (SCRATCH_ITEMS_TO_HIDE.includes(option[1])) {\n        return query ? -1 : 0;\n      } else if (ADDON_ITEMS.includes(option[1])) {\n        item.element.lastChild.lastChild.textContent = getMenuItemMessage(option[1])[0];\n        return query ? 0 : -1;\n      }\n      const itemText = item.text.toLowerCase();\n      if (query === itemText) {\n        return 2;\n      }\n      if (itemText.startsWith(query)) {\n        return 1;\n      }\n      if (itemText.includes(query)) {\n        return 0;\n      }\n      return -1;\n    };\n    return items\n      .map((item, index) => ({\n        item,\n        score: rank(item, index),\n      }))\n      .sort(({ score: scoreA }, { score: scoreB }) => Math.max(0, scoreB) - Math.max(0, scoreA));\n  }\n\n  function updateSearch() {\n    const previousSearchedItems = searchedItems;\n    searchedItems = performSearch();\n    let needToUpdateDOM = previousSearchedItems.length !== searchedItems.length;\n    if (!needToUpdateDOM) {\n      for (let i = 0; i < searchedItems.length; i++) {\n        if (searchedItems[i].item !== previousSearchedItems[i].item) {\n          needToUpdateDOM = true;\n          break;\n        }\n      }\n    }\n    if (needToUpdateDOM && previousSearchedItems.length > 0) {\n      for (const { item } of previousSearchedItems) {\n        item.element.remove();\n      }\n      for (const { item } of searchedItems) {\n        blocklyDropdownMenu.appendChild(item.element);\n      }\n    }\n    for (const { item, score } of searchedItems) {\n      item.element.hidden = score < 0;\n    }\n  }\n\n  function handleKeyDownEvent(event) {\n    if (event.key === \"Enter\") {\n      // Reimplement enter to select item to account for hidden items and default to the top item.\n      event.stopPropagation();\n      event.preventDefault();\n\n      const selectedItem = document.querySelector(\".goog-menuitem-highlight\");\n      if (selectedItem && !selectedItem.hidden) {\n        selectItem(selectedItem, true);\n        return;\n      }\n\n      const selectedBlock = Blockly.selected;\n      if (searchBar.value === \"\" && selectedBlock) {\n        if (\n          selectedBlock.type === \"event_broadcast\" ||\n          selectedBlock.type === \"event_broadcastandwait\" ||\n          selectedBlock.type === \"event_whenbroadcastreceived\"\n        ) {\n          // The top item of these dropdowns is always \"New message\"\n          // When pressing enter on an empty search bar, we close the dropdown instead of making a new broadcast.\n          Blockly.DropDownDiv.hide();\n          return;\n        }\n      }\n      for (const { item } of searchedItems) {\n        if (!item.element.hidden) {\n          selectItem(item.element, true);\n          break;\n        }\n      }\n      // If there is no top value, do nothing and leave the dropdown open\n    } else if (event.key === \"Escape\") {\n      Blockly.DropDownDiv.hide();\n    } else if (event.key === \"ArrowDown\" || event.key === \"ArrowUp\") {\n      // Reimplement keyboard navigation to account for hidden items.\n      event.preventDefault();\n      event.stopPropagation();\n\n      const items = searchedItems.filter((i) => i.score >= 0).map((i) => i.item);\n      if (items.length === 0) {\n        return;\n      }\n\n      let selectedIndex = -1;\n      for (let i = 0; i < items.length; i++) {\n        if (items[i].element.classList.contains(\"goog-menuitem-highlight\")) {\n          selectedIndex = i;\n          break;\n        }\n      }\n\n      const lastIndex = items.length - 1;\n      let newIndex = 0;\n      if (event.key === \"ArrowDown\") {\n        if (selectedIndex === -1 || selectedIndex === lastIndex) {\n          newIndex = 0;\n        } else {\n          newIndex = selectedIndex + 1;\n        }\n      } else {\n        if (selectedIndex === -1 || selectedIndex === 0) {\n          newIndex = lastIndex;\n        } else {\n          newIndex = selectedIndex - 1;\n        }\n      }\n\n      selectItem(items[newIndex].element, false);\n    }\n  }\n\n  function getMenuItemMessage(message) {\n    // Format used internally by Scratch:\n    // [human readable name, internal name]\n    return [msg(message, { name: searchBar?.value || \"\" }), message];\n  }\n}\n","/* generated by pull.js */\nimport _js from \"./userscript.js\";\nimport _css from \"!css-loader!./style.css\";\nexport const resources = {\n  \"userscript.js\": _js,\n  \"style.css\": _css,\n};\n","/* inserted by pull.js */\nimport _twAsset0 from \"!url-loader!./folder.svg\";\nconst _twGetAsset = (path) => {\n  if (path === \"/folder.svg\") return _twAsset0;\n  throw new Error(`Unknown asset: ${path}`);\n};\n\nexport default async function ({ addon, global, console, msg }) {\n  // The basic premise of how this addon works is relative simple.\n  // scratch-gui renders the sprite selectors and asset selectors in a hierarchy like this:\n  // <SelectorHOC>\n  //   <SpriteSelectorItem />\n  //   <SpriteSelectorItem />\n  //   <SpriteSelectorItem />\n  //   <SpriteSelectorItem />\n  //   ...\n  // </SelectorHOC>\n  // It's obviously more complicated than that, but there are two important parts:\n  // SelectorHOC - We override this to change which items are displayed\n  // SpriteSelectorItem - We override this to change how items are displayed.\n  //    Folders are just items rendered differently\n  // These two components communicate through the `name` property of the items.\n  // We touch some things on the VM to make dragging items work properly.\n\n  const REACT_INTERNAL_PREFIX = \"__reactInternalInstance$\";\n\n  const TYPE_SPRITES = 1;\n  const TYPE_ASSETS = 2;\n\n  // We run too early, will be set later\n  let vm;\n\n  let reactInternalKey;\n\n  let currentSpriteFolder;\n  let currentAssetFolder;\n\n  let currentSpriteItems;\n  let currentAssetItems;\n\n  const DIVIDER = \"//\";\n\n  /**\n   * getFolderFromName(\"B\") === null\n   * getFolderFromName(\"A//b\") === \"A\"\n   */\n  const getFolderFromName = (name) => {\n    const idx = name.indexOf(DIVIDER);\n    if (idx === -1 || idx === 0) {\n      return null;\n    }\n    return name.substr(0, idx);\n  };\n\n  /**\n   * getNameWithoutFolder(\"B\") === \"B\"\n   * getNameWithoutFolder(\"A//b\") === \"b\"\n   */\n  const getNameWithoutFolder = (name) => {\n    const idx = name.indexOf(DIVIDER);\n    if (idx === -1 || idx === 0) {\n      return name;\n    }\n    return name.substr(idx + DIVIDER.length);\n  };\n\n  /**\n   * setFolderOfName(\"B\", \"y\") === \"y//B\"\n   * setFolderOfName(\"c//B\", \"y\") === \"y//B\"\n   * setFolderOfName(\"B\", null) === \"B\"\n   * setFolderOfName(\"c//B\", null) === \"B\"\n   */\n  const setFolderOfName = (name, folder) => {\n    const basename = getNameWithoutFolder(name);\n    if (folder) {\n      return `${folder}${DIVIDER}${basename}`;\n    }\n    return basename;\n  };\n\n  const isValidFolderName = (name) => {\n    return !name.includes(DIVIDER) && !name.endsWith(\"/\");\n  };\n\n  const RESERVED_NAMES = [\"_mouse_\", \"_stage_\", \"_edge_\", \"_myself_\", \"_random_\"];\n  const ensureNotReserved = (name) => {\n    if (name === \"\") return \"2\";\n    if (RESERVED_NAMES.includes(name)) return `${name}2`;\n    return name;\n  };\n\n  const getSortableHOCFromElement = (el) => {\n    const nearestSpriteSelector = el.closest(\"[class*='sprite-selector_sprite-selector']\");\n    if (nearestSpriteSelector) {\n      return nearestSpriteSelector[reactInternalKey].child.sibling.child.stateNode;\n    }\n    const nearestAssetPanelWrapper = el.closest('[class*=\"asset-panel_wrapper\"]');\n    if (nearestAssetPanelWrapper) {\n      return nearestAssetPanelWrapper[reactInternalKey].child.child.stateNode;\n    }\n    throw new Error(\"cannot find SortableHOC\");\n  };\n\n  const getBackpackFromElement = (el) => {\n    const gui = el.closest('[class*=\"gui_editor-wrapper\"]');\n    if (!gui) throw new Error(\"cannot find Backpack\");\n    return gui[reactInternalKey].child.sibling.child.child.stateNode;\n  };\n\n  const clamp = (n, min, max) => {\n    return Math.min(Math.max(n, min), max);\n  };\n\n  /**\n   * @typedef {Object} ItemData\n   * @property {string} realName\n   * @property {number} realIndex\n   * @property {string} inFolder\n   * @property {string} folder\n   * @property {boolean} folderOpen\n   */\n\n  /**\n   * @returns {ItemData|null}\n   */\n  const getItemData = (item) => {\n    if (item && item.name && typeof item.name === \"object\") {\n      return item.name;\n    }\n    return null;\n  };\n\n  const openFolderAsset = {\n    assetId: \"&__sa_folders_folder\",\n    encodeDataURI() {\n      // Doesn't actually need to be a data: URI\n      return _twGetAsset(\"/folder.svg\");\n    },\n  };\n\n  // https://github.com/LLK/scratch-gui/blob/develop/src/components/asset-panel/icon--sound.svg\n  const imageIconSource = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg width=\"100px\" height=\"100px\" viewBox=\"0 0 20 20\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n    <g id=\"Sound\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n        <path d=\"M12.4785058,12.6666667 C12.3144947,12.6666667 12.1458852,12.6272044 11.9926038,12.5440517 C11.537358,12.2960031 11.3856094,11.7562156 11.6553847,11.3376335 C12.1688774,10.5371131 12.1688774,9.54491867 11.6553847,8.74580756 C11.3856094,8.32581618 11.537358,7.78602861 11.9926038,7.53798001 C12.452448,7.29275014 13.0379829,7.43086811 13.3046926,7.84804076 C14.1737981,9.20103311 14.1737981,10.8809986 13.3046926,12.233991 C13.1268862,12.5130457 12.806528,12.6666667 12.4785058,12.6666667 Z M15.3806784,13.8333333 C15.2408902,13.8333333 15.0958763,13.796281 14.9665396,13.7182064 C14.5785295,13.485306 14.4491928,12.9784829 14.6791247,12.5854634 C15.5949331,11.0160321 15.5949331,9.065491 14.6791247,7.49738299 C14.4491928,7.10436352 14.5785295,6.59621712 14.9665396,6.36331669 C15.3558562,6.13438616 15.8549129,6.26274605 16.0848448,6.65444223 C17.3050517,8.74260632 17.3050517,11.3389168 16.0848448,13.4270809 C15.9319924,13.6890939 15.6602547,13.8333333 15.3806784,13.8333333 Z M10.3043478,5.62501557 L10.3043478,13.873675 C10.3043478,14.850934 9.10969849,15.3625101 8.36478311,14.7038052 L6.7566013,13.2797607 C6.18712394,12.7762834 5.44499329,12.4968737 4.67362297,12.4968737 L4.3923652,12.4968737 C3.62377961,12.4968737 3,11.8935108 3,11.1470686 L3,8.36646989 C3,7.62137743 3.62377961,7.01666471 4.3923652,7.01666471 L4.65830695,7.01666471 C5.42967727,7.01666471 6.17180792,6.73725504 6.74128529,6.23377771 L8.36478311,4.79623519 C9.10969849,4.13753026 10.3043478,4.64910643 10.3043478,5.62501557 Z\" id=\"Combined-Shape\" fill=\"#575E75\"></path>\n    </g>\n</svg>`;\n  const soundIconHref = `data:image/svg+xml;base64,${btoa(imageIconSource)}`;\n\n  let folderColorStylesheet = null;\n  const folderColors = Object.create(null);\n  const getFolderColorClass = (folderName) => {\n    const mulberry32 = (a) => {\n      // https://stackoverflow.com/a/47593316\n      return function () {\n        var t = (a += 0x6d2b79f5);\n        t = Math.imul(t ^ (t >>> 15), t | 1);\n        t ^= t + Math.imul(t ^ (t >>> 7), t | 61);\n        return ((t ^ (t >>> 14)) >>> 0) / 4294967296;\n      };\n    };\n\n    const hashCode = (str) => {\n      // Based on Java's String.hashCode\n      // https://hg.openjdk.java.net/jdk8/jdk8/jdk/file/687fd7c7986d/src/share/classes/java/lang/String.java#l1452\n      let hash = 0;\n      for (let i = 0; i < str.length; i++) {\n        hash = 31 * hash + str.charCodeAt(i);\n        hash = hash | 0;\n      }\n      return hash;\n    };\n\n    const random = (str) => {\n      const seed = hashCode(str);\n      const rng = mulberry32(seed);\n      // Run RNG a few times to get more random numbers, otherwise similar seeds tend to give somewhat similar results\n      rng();\n      rng();\n      rng();\n      rng();\n      return rng();\n    };\n\n    if (!folderColors[folderName]) {\n      if (!folderColorStylesheet) {\n        folderColorStylesheet = document.createElement(\"style\");\n        document.head.appendChild(folderColorStylesheet);\n      }\n      const hue = random(folderName) * 360;\n      const color = `hsla(${hue}deg, 100%, 85%, 0.5)`;\n      const id = Object.keys(folderColors).length;\n      const className = `sa-folders-color-${id}`;\n      folderColors[folderName] = className;\n      folderColorStylesheet.textContent += `.${className}{background-color:${color} !important;}`;\n      folderColorStylesheet.textContent += `.${className}[class*=\"sprite-selector_raised\"]:not([class*=\"sa-folders-folder\"]){background-color:hsla(${hue}deg, 100%, 77%, 1) !important;}`;\n    }\n    return folderColors[folderName];\n  };\n\n  const fixOrderOfItemsInFolders = (items) => {\n    const folders = Object.create(null);\n    const result = [];\n    for (const item of items) {\n      const name = item.getName ? item.getName() : item.name;\n      const folder = getFolderFromName(name);\n      if (typeof folder === \"string\") {\n        if (!folders[folder]) {\n          folders[folder] = [];\n          result.push(folders[folder]);\n        }\n        folders[folder].push(item);\n      } else {\n        result.push(item);\n      }\n    }\n    const flatResult = result.flat();\n    for (let i = 0; i < items.length; i++) {\n      if (result[i] !== items[i]) {\n        return { items: flatResult, changed: true };\n      }\n    }\n    return { items: flatResult, changed: false };\n  };\n\n  const fixTargetOrder = () => {\n    const { items, changed } = fixOrderOfItemsInFolders(vm.runtime.targets);\n    if (changed) {\n      vm.runtime.targets = items;\n      vm.emitTargetsUpdate();\n    }\n  };\n\n  const fixCostumeOrder = (target = vm.editingTarget) => {\n    const { items, changed } = fixOrderOfItemsInFolders(target.sprite.costumes);\n    if (changed) {\n      target.sprite.costumes = items;\n      vm.emitTargetsUpdate();\n    }\n  };\n\n  const fixSoundOrder = (target = vm.editingTarget) => {\n    const { items, changed } = fixOrderOfItemsInFolders(target.sprite.sounds);\n    if (changed) {\n      target.sprite.sounds = items;\n      vm.emitTargetsUpdate();\n    }\n  };\n\n  const verifySortableHOC = (sortableHOCInstance) => {\n    const SortableHOC = sortableHOCInstance.constructor;\n    if (\n      Array.isArray(sortableHOCInstance.props.items) &&\n      (typeof sortableHOCInstance.props.selectedId === \"string\" ||\n        typeof sortableHOCInstance.props.selectedItemIndex === \"number\") &&\n      typeof sortableHOCInstance.containerBox !== \"undefined\" &&\n      typeof SortableHOC.prototype.componentDidMount === \"undefined\" &&\n      typeof SortableHOC.prototype.componentDidUpdate === \"undefined\" &&\n      typeof SortableHOC.prototype.handleAddSortable === \"function\" &&\n      typeof SortableHOC.prototype.handleRemoveSortable === \"function\" &&\n      typeof SortableHOC.prototype.setRef === \"function\"\n    )\n      return;\n    throw new Error(\"Can not comprehend SortableHOC\");\n  };\n\n  const verifySpriteSelectorItem = (spriteSelectorItemInstance) => {\n    const SpriteSelectorItem = spriteSelectorItemInstance.constructor;\n    if (\n      typeof spriteSelectorItemInstance.props.asset === \"object\" &&\n      typeof spriteSelectorItemInstance.props.name === \"string\" &&\n      typeof spriteSelectorItemInstance.props.dragType === \"string\" &&\n      typeof SpriteSelectorItem.prototype.handleClick === \"function\" &&\n      typeof SpriteSelectorItem.prototype.setRef === \"function\" &&\n      typeof SpriteSelectorItem.prototype.handleDrag === \"function\" &&\n      typeof SpriteSelectorItem.prototype.handleDragEnd === \"function\" &&\n      typeof SpriteSelectorItem.prototype.handleDelete === \"function\" &&\n      typeof SpriteSelectorItem.prototype.handleDuplicate === \"function\" &&\n      typeof SpriteSelectorItem.prototype.handleExport === \"function\"\n    )\n      return;\n    throw new Error(\"Can not comprehend SpriteSelectorItem\");\n  };\n\n  const verifyVM = (vm) => {\n    const target = vm.runtime.targets[0];\n    if (\n      typeof vm.installTargets === \"function\" &&\n      typeof vm.reorderTarget === \"function\" &&\n      typeof target.reorderCostume === \"function\" &&\n      typeof target.reorderSound === \"function\" &&\n      typeof target.addCostume === \"function\" &&\n      typeof target.addSound === \"function\"\n    )\n      return;\n    throw new Error(\"Can not comprehend VM\");\n  };\n\n  const verifyBackpack = (backpackInstance) => {\n    const Backpack = backpackInstance.constructor;\n    if (\n      typeof Backpack.prototype.handleDrop === \"function\" &&\n      typeof Backpack.prototype.componentDidUpdate === \"undefined\"\n    ) {\n      return;\n    }\n    throw new Error(\"Can not comprehend Backpack\");\n  };\n\n  class Cache {\n    constructor() {\n      this.cache = new Map();\n      this.usedThisTick = new Set();\n    }\n\n    has(id) {\n      return this.cache.has(id);\n    }\n\n    get(id) {\n      this.usedThisTick.add(id);\n      return this.cache.get(id);\n    }\n\n    set(id, value) {\n      this.usedThisTick.add(id);\n      this.cache.set(id, value);\n    }\n\n    startTick() {\n      this.usedThisTick.clear();\n    }\n\n    endTick() {\n      for (const id of Array.from(this.cache.keys())) {\n        if (!this.usedThisTick.has(id)) {\n          this.cache.delete(id);\n        }\n      }\n    }\n\n    clear() {\n      this.usedThisTick.clear();\n      this.cache.clear();\n    }\n  }\n\n  const patchSortableHOC = (SortableHOC, type) => {\n    // SortableHOC should be: https://github.com/LLK/scratch-gui/blob/29d9851778febe4e69fa5111bf7559160611e366/src/lib/sortable-hoc.jsx#L8\n\n    const itemCache = new Cache();\n    const folderItemCache = new Cache();\n    const folderAssetCache = new Cache();\n\n    const PREVIEW_SIZE = 80;\n    const PREVIEW_POSITIONS = [\n      // x, y\n      [0, 0],\n      [PREVIEW_SIZE / 2, 0],\n      [0, PREVIEW_SIZE / 2],\n      [PREVIEW_SIZE / 2, PREVIEW_SIZE / 2],\n    ];\n\n    const createFolderPreview = (items) => {\n      // Directly generate a string instead of using DOM API for performance as we deal with very large inlined images\n      // Because the result is only used as an img src, XSS shouldn't be a concern\n      let result = `data:image/svg+xml;,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${PREVIEW_SIZE}\" height=\"${PREVIEW_SIZE}\">`;\n      for (let i = 0; i < Math.min(PREVIEW_POSITIONS.length, items.length); i++) {\n        const item = items[i];\n        const width = PREVIEW_SIZE / 2;\n        const height = PREVIEW_SIZE / 2;\n        const [x, y] = PREVIEW_POSITIONS[i];\n        let src;\n        if (item.asset) {\n          // TW: We can be 100% certain that escaping here is unnecessary\n          src = item.asset.encodeDataURI();\n        } else if (item.costume && item.costume.asset) {\n          src = item.costume.asset.encodeDataURI();\n        } else if (item.url) {\n          src = soundIconHref;\n        }\n        if (src) {\n          result += `<image width=\"${width}\" height=\"${height}\" x=\"${x}\" y=\"${y}\" href=\"${src}\"/>`;\n        }\n      }\n      result += \"</svg>\";\n      return result;\n    };\n\n    const getUniqueIdOfFolderItems = (items) => {\n      let id = \"sa_folder&&\";\n      for (let i = 0; i < Math.min(PREVIEW_POSITIONS.length, items.length); i++) {\n        const item = items[i];\n        if (item.asset) {\n          id += item.asset.assetId;\n        } else if (item.costume && item.costume.asset) {\n          id += item.costume.asset.assetId;\n        } else if (item.url) {\n          id += item.url;\n        }\n        id += \"&&\";\n      }\n      return id;\n    };\n\n    const processItems = (openFolders, props) => {\n      const processItem = (item) => {\n        const itemId = item.name;\n\n        let newItem;\n        let itemData;\n        if (itemCache.has(itemId)) {\n          newItem = itemCache.get(itemId);\n          itemData = newItem.name;\n        } else {\n          itemData = {\n            toString() {\n              return `_${item.name}`;\n            },\n          };\n          newItem = {};\n          itemCache.set(itemId, newItem);\n        }\n\n        const itemFolderName = getFolderFromName(item.name);\n\n        Object.assign(newItem, item);\n        itemData.realName = item.name;\n        itemData.realIndex = i;\n        itemData.inFolder = itemFolderName;\n        newItem.name = itemData;\n\n        return {\n          newItem,\n          itemData,\n        };\n      };\n\n      itemCache.startTick();\n      folderItemCache.startTick();\n      folderAssetCache.startTick();\n\n      const folderOccurrences = new Map();\n      const items = [];\n      const result = {\n        items,\n      };\n\n      let i = 0;\n      while (i < props.items.length) {\n        const item = props.items[i];\n        const folderName = getFolderFromName(item.name);\n\n        if (folderName === null) {\n          items.push(processItem(item).newItem);\n          if (type === TYPE_ASSETS) {\n            const isSelected = props.selectedItemIndex === i;\n            if (isSelected) {\n              result.selectedItemIndex = items.length - 1;\n            }\n          }\n        } else {\n          const isOpen = openFolders.indexOf(folderName) !== -1;\n          const folderItems = [];\n          while (i < props.items.length) {\n            const childItem = props.items[i];\n            const processedItem = processItem(childItem);\n            if (getFolderFromName(childItem.name) !== folderName) {\n              break;\n            }\n            folderItems.push(processedItem.newItem);\n            if (type === TYPE_ASSETS) {\n              const isSelected = props.selectedItemIndex === i;\n              if (isSelected) {\n                if (isOpen) {\n                  result.selectedItemIndex = items.length + folderItems.length;\n                } else {\n                  result.selectedItemIndex = -1;\n                }\n              }\n            }\n            i++;\n          }\n          i--;\n\n          const occurrence = folderOccurrences.get(folderName) || 0;\n          folderOccurrences.set(folderName, occurrence + 1);\n          const baseUniqueId = getUniqueIdOfFolderItems(folderItems);\n          const itemUniqueId = `${isOpen}&${occurrence}&${folderName}&${baseUniqueId}&`;\n          const reactKey = `&__${occurrence}_${folderName}`;\n          const assetUniqueId = baseUniqueId;\n\n          let folderItem;\n          let folderData;\n          if (folderItemCache.has(itemUniqueId)) {\n            folderItem = folderItemCache.get(itemUniqueId);\n            folderData = folderItem.name;\n          } else {\n            folderItem = {\n              // Can be used as a react key\n              id: {\n                toString() {\n                  return reactKey;\n                },\n              },\n            };\n            folderData = {\n              // Can be used as a react key\n              toString() {\n                return reactKey;\n              },\n            };\n            folderItemCache.set(itemUniqueId, folderItem);\n          }\n\n          folderData.folder = folderName;\n          folderData.folderOpen = isOpen;\n          folderItem.items = folderItems;\n          folderItem.name = folderData;\n\n          let folderAsset;\n          if (isOpen) {\n            folderAsset = openFolderAsset;\n          } else {\n            if (folderAssetCache.has(assetUniqueId)) {\n              folderAsset = folderAssetCache.get(assetUniqueId);\n            } else {\n              folderAsset = {\n                assetId: assetUniqueId,\n                encodeDataURI() {\n                  return createFolderPreview(folderItems);\n                },\n              };\n              folderAssetCache.set(assetUniqueId, folderAsset);\n            }\n          }\n\n          if (type === TYPE_SPRITES) {\n            if (!folderItem.costume) folderItem.costume = {};\n            folderItem.costume.asset = folderAsset;\n            // For sprite items, `id` is used as the drag payload and toString is used as a React key\n            if (!folderItem.id) folderItem.id = {};\n            folderItem.id.sa_folder_items = folderItems;\n            folderItem.id.toString = () => reactKey;\n          } else {\n            folderItem.asset = folderAsset;\n            if (!folderItem.dragPayload) folderItem.dragPayload = {};\n            folderItem.dragPayload.sa_folder_items = folderItems;\n          }\n\n          items.push(folderItem);\n          if (isOpen) {\n            for (const item of folderItems) {\n              items.push(item);\n            }\n          }\n        }\n\n        i++;\n      }\n\n      itemCache.endTick();\n      folderItemCache.endTick();\n      folderAssetCache.endTick();\n\n      return result;\n    };\n\n    const getSelectedItem = (sortable) => {\n      if (type === TYPE_SPRITES) {\n        const selectedItem = sortable.props.items.find((i) => i.id === sortable.props.selectedId);\n        return selectedItem;\n      } else if (type === TYPE_ASSETS) {\n        const selectedItem = sortable.props.items[sortable.props.selectedItemIndex];\n        return selectedItem;\n      }\n      return null;\n    };\n\n    SortableHOC.prototype.saInitialSetup = function () {\n      itemCache.clear();\n      folderItemCache.clear();\n      folderAssetCache.clear();\n      const folders = [];\n      const selectedItem = getSelectedItem(this);\n      if (selectedItem && !selectedItem.isStage) {\n        const folder = getFolderFromName(selectedItem.name);\n        folders.push(folder);\n        if (type === TYPE_SPRITES) {\n          currentSpriteFolder = folder;\n        } else if (type === TYPE_ASSETS) {\n          currentAssetFolder = folder;\n        }\n      }\n      this.setState({\n        folders,\n      });\n    };\n\n    SortableHOC.prototype.componentDidMount = function () {\n      // Do part of componentDidUpdate on mount as well\n      const selectedItem = getSelectedItem(this);\n      if (selectedItem) {\n        const folder = getFolderFromName(selectedItem.name);\n        if (type === TYPE_SPRITES) {\n          currentSpriteFolder = folder;\n        } else if (type === TYPE_ASSETS) {\n          currentAssetFolder = folder;\n        }\n      }\n      this.saInitialSetup();\n    };\n\n    SortableHOC.prototype.componentDidUpdate = function (prevProps, prevState) {\n      const selectedItem = getSelectedItem(this);\n      if (selectedItem) {\n        const folder = getFolderFromName(selectedItem.name);\n        const currentFolder = this.state.folders.includes(folder) ? folder : null;\n        if (type === TYPE_SPRITES) {\n          currentSpriteFolder = currentFolder;\n        } else if (type === TYPE_ASSETS) {\n          currentAssetFolder = currentFolder;\n        }\n        let selectedItemChanged;\n        if (this.props.selectedId) {\n          selectedItemChanged = this.props.selectedId !== prevProps.selectedId;\n        } else {\n          selectedItemChanged =\n            this.props.items[this.props.selectedItemIndex] &&\n            prevProps.items[prevProps.selectedItemIndex] &&\n            this.props.items[this.props.selectedItemIndex].name !== prevProps.items[prevProps.selectedItemIndex].name;\n        }\n        if (selectedItemChanged) {\n          if (!selectedItem.isStage) {\n            if (typeof folder === \"string\" && !this.state.folders.includes(folder)) {\n              this.setState((prevState) => ({\n                folders: [...prevState.folders, folder],\n              }));\n            }\n          }\n        }\n      }\n    };\n\n    const originalSortableHOCRender = SortableHOC.prototype.render;\n    SortableHOC.prototype.render = function () {\n      const originalProps = this.props;\n      this.props = {\n        ...this.props,\n        ...processItems((this.state && this.state.folders) || [], this.props),\n      };\n\n      if (type === TYPE_SPRITES) {\n        currentSpriteItems = this.props.items;\n      } else if (type === TYPE_ASSETS) {\n        currentAssetItems = this.props.items;\n      }\n      const result = originalSortableHOCRender.call(this);\n      this.props = originalProps;\n      return result;\n    };\n  };\n\n  const getAllFolders = (component) => {\n    const result = new Set();\n    let items;\n    if (component.props.dragType === \"SPRITE\") {\n      items = currentSpriteItems;\n    } else {\n      items = currentAssetItems;\n    }\n    for (const item of items) {\n      const data = getItemData(item);\n      if (typeof data.folder === \"string\") {\n        result.add(data.folder);\n      }\n    }\n    return Array.from(result);\n  };\n\n  const isFolderOpen = (component, folder) => {\n    const sortableHOCInstance = getSortableHOCFromElement(component.ref);\n    const folders = (sortableHOCInstance.state && sortableHOCInstance.state.folders) || [];\n    return folders.includes(folder);\n  };\n\n  const setFolderOpen = (component, folder, open) => {\n    const sortableHOCInstance = getSortableHOCFromElement(component.ref);\n    sortableHOCInstance.setState((prevState) => {\n      let folders = (prevState && prevState.folders) || [];\n      folders = folders.filter((i) => i !== folder);\n      if (open) {\n        return {\n          folders: [...folders, folder],\n        };\n      }\n      return {\n        folders,\n      };\n    });\n  };\n\n  addon.tab.createEditorContextMenu((ctxType, ctx) => {\n    if (ctxType !== \"sprite\" && ctxType !== \"costume\" && ctxType !== \"sound\") return;\n    const component = ctx.target[addon.tab.traps.getInternalKey(ctx.target)].return.return.return.stateNode;\n    const data = getItemData(component.props);\n    if (!data) return;\n    if (typeof data.folder === \"string\") {\n      ctx.target.setAttribute(\"sa-folders-context-type\", \"folder\");\n\n      const renameItems = (newName) => {\n        const isOpen = isFolderOpen(component, data.folder);\n        setFolderOpen(component, data.folder, false);\n        if (isOpen && typeof newName === \"string\") {\n          setFolderOpen(component, newName, true);\n        }\n        if (component.props.dragType === \"SPRITE\") {\n          for (const target of vm.runtime.targets) {\n            if (target.isOriginal) {\n              if (getFolderFromName(target.getName()) === data.folder) {\n                vm.renameSprite(target.id, ensureNotReserved(setFolderOfName(target.getName(), newName)));\n              }\n            }\n          }\n          vm.emitWorkspaceUpdate();\n          fixTargetOrder();\n        } else if (component.props.dragType === \"COSTUME\") {\n          for (let i = 0; i < vm.editingTarget.sprite.costumes.length; i++) {\n            const costume = vm.editingTarget.sprite.costumes[i];\n            if (getFolderFromName(costume.name) === data.folder) {\n              vm.renameCostume(i, setFolderOfName(costume.name, newName));\n            }\n          }\n          fixCostumeOrder();\n        } else if (component.props.dragType === \"SOUND\") {\n          for (let i = 0; i < vm.editingTarget.sprite.sounds.length; i++) {\n            const sound = vm.editingTarget.sprite.sounds[i];\n            if (getFolderFromName(sound.name) === data.folder) {\n              vm.renameSound(i, setFolderOfName(sound.name, newName));\n            }\n          }\n          fixSoundOrder();\n        }\n      };\n      const renameFolder = async () => {\n        let newName = await addon.tab.prompt(\n          msg(\"rename-folder-prompt-title\"),\n          msg(\"rename-folder-prompt\"),\n          data.folder,\n          { useEditorClasses: true }\n        );\n        // Prompt cancelled, do not rename\n        if (newName === null) {\n          return;\n        }\n        if (!isValidFolderName(newName)) {\n          alert(msg(\"name-not-allowed\"));\n          return;\n        }\n        // Empty name will remove the folder\n        if (!newName) {\n          newName = null;\n        }\n        renameItems(newName);\n      };\n\n      const removeFolder = () => {\n        renameItems(null);\n      };\n      return [\n        {\n          className: \"sa-folders-rename-folder\",\n          label: msg(\"rename-folder\"),\n          callback: renameFolder,\n          position: \"assetContextMenuAfterDelete\",\n          order: 10,\n        },\n        {\n          className: \"sa-folders-remove-folder\",\n          label: msg(\"remove-folder\"),\n          callback: removeFolder,\n          position: \"assetContextMenuAfterDelete\",\n          order: 11,\n        },\n      ];\n    } else {\n      ctx.target.setAttribute(\"sa-folders-context-type\", \"asset\");\n      const setFolder = (folder) => {\n        if (component.props.dragType === \"SPRITE\") {\n          const target = vm.runtime.getTargetById(component.props.id);\n          vm.renameSprite(component.props.id, ensureNotReserved(setFolderOfName(target.getName(), folder)));\n          fixTargetOrder();\n          vm.emitWorkspaceUpdate();\n        } else if (component.props.dragType === \"COSTUME\") {\n          const data = getItemData(component.props);\n          const index = data.realIndex;\n          const asset = vm.editingTarget.sprite.costumes[index];\n          vm.renameCostume(vm.editingTarget.sprite.costumes.indexOf(asset), setFolderOfName(asset.name, folder));\n          fixCostumeOrder();\n        } else if (component.props.dragType === \"SOUND\") {\n          const data = getItemData(component.props);\n          const index = data.realIndex;\n          const asset = vm.editingTarget.sprite.sounds[index];\n          vm.renameSound(vm.editingTarget.sprite.sounds.indexOf(asset), setFolderOfName(asset.name, folder));\n          fixSoundOrder();\n        }\n      };\n\n      const createFolder = async () => {\n        const name = await addon.tab.prompt(\n          msg(\"name-prompt-title\"),\n          msg(\"name-prompt\"),\n          getNameWithoutFolder(data.realName),\n          { useEditorClasses: true }\n        );\n        if (name === null) {\n          return;\n        }\n        if (!isValidFolderName(name)) {\n          alert(msg(\"name-not-allowed\"));\n          return;\n        }\n        setFolder(name);\n      };\n      const base = [\n        {\n          border: true,\n          className: \"sa-folders-create-folder\",\n          label: msg(\"create-folder\"),\n          callback: createFolder,\n          position: \"assetContextMenuAfterDelete\",\n          order: 13,\n        },\n      ];\n      const currentFolder = data.inFolder;\n      if (typeof currentFolder === \"string\") {\n        base.push({\n          className: \"sa-folders-remove-from-folder\",\n          label: msg(\"remove-from-folder\"),\n          callback: () => setFolder(null),\n          position: \"assetContextMenuAfterDelete\",\n          order: 14,\n        });\n      }\n      return base.concat(\n        getAllFolders(component)\n          .filter((folder) => folder !== currentFolder)\n          .map((folder, i) => {\n            return {\n              className: \"sa-folders-add-to-folder\",\n              label: msg(\"add-to-folder\", {\n                folder,\n              }),\n              callback: () => setFolder(folder),\n              position: \"assetContextMenuAfterDelete\",\n              order: 20 + i,\n            };\n          })\n      );\n    }\n  });\n\n  const patchSpriteSelectorItem = (SpriteSelectorItem) => {\n    for (const method of [\"handleDelete\", \"handleDuplicate\", \"handleExport\"]) {\n      const original = SpriteSelectorItem.prototype[method];\n      SpriteSelectorItem.prototype[method] = function (...args) {\n        if (typeof this.props.id === \"number\") {\n          const itemData = getItemData(this.props);\n          if (itemData) {\n            const originalProps = this.props;\n            this.props = {\n              ...originalProps,\n              id: itemData.realIndex,\n            };\n            const ret = original.call(this, ...args);\n            this.props = originalProps;\n            return ret;\n          }\n        }\n        return original.call(this, ...args);\n      };\n    }\n\n    const originalHandleDragEnd = SpriteSelectorItem.prototype.handleDragEnd;\n    SpriteSelectorItem.prototype.handleDragEnd = function (...args) {\n      const itemData = getItemData(this.props);\n      if (itemData) {\n        if (typeof itemData.realIndex === \"number\" && this.props.dragging) {\n          // If the item is being dragged onto another group (eg. costume list -> sprite list)\n          // then we fake a drag event to make the `index` be the real index\n          const originalIndex = this.props.index;\n          const realIndex = itemData.realIndex;\n          if (originalIndex !== realIndex) {\n            const currentOffset = addon.tab.redux.state.scratchGui.assetDrag.currentOffset;\n            const sortableHOCInstance = getSortableHOCFromElement(this.ref);\n            if (currentOffset && sortableHOCInstance && sortableHOCInstance.getMouseOverIndex() === null) {\n              this.props.index = realIndex;\n              this.handleDrag(currentOffset);\n              this.props.index = originalIndex;\n            }\n          }\n        }\n      }\n      return originalHandleDragEnd.call(this, ...args);\n    };\n\n    const originalHandleClick = SpriteSelectorItem.prototype.handleClick;\n    SpriteSelectorItem.prototype.handleClick = function (...args) {\n      const e = args[0];\n      if (e && !this.noClick) {\n        const itemData = getItemData(this.props);\n        if (itemData) {\n          if (typeof itemData.folder === \"string\") {\n            e.preventDefault();\n            setFolderOpen(this, itemData.folder, !isFolderOpen(this, itemData.folder));\n            return;\n          }\n          if (typeof this.props.number === \"number\" && typeof itemData.realIndex === \"number\") {\n            e.preventDefault();\n            if (this.props.onClick) {\n              this.props.onClick(itemData.realIndex);\n            }\n            return;\n          }\n        }\n      }\n      return originalHandleClick.call(this, ...args);\n    };\n\n    const originalRender = SpriteSelectorItem.prototype.render;\n    SpriteSelectorItem.prototype.render = function () {\n      const itemData = getItemData(this.props);\n      if (itemData) {\n        const originalProps = this.props;\n        this.props = {\n          ...this.props,\n        };\n\n        if (typeof itemData.realName === \"string\") {\n          this.props.name = getNameWithoutFolder(itemData.realName);\n        }\n        if (typeof this.props.number === \"number\" && typeof itemData.realIndex === \"number\") {\n          // Convert 0-indexed to 1-indexed\n          this.props.number = itemData.realIndex + 1;\n        }\n        if (typeof itemData.folder === \"string\") {\n          this.props.name = itemData.folder;\n          if (itemData.folderOpen) {\n            this.props.details = msg(\"open-folder\");\n          } else {\n            this.props.details = msg(\"closed-folder\");\n          }\n          this.props.selected = false;\n          this.props.number = null;\n          this.props.className += ` ${getFolderColorClass(itemData.folder)} sa-folders-folder`;\n        }\n        if (typeof itemData.inFolder === \"string\") {\n          this.props.className += ` ${getFolderColorClass(itemData.inFolder)}`;\n        }\n\n        const result = originalRender.call(this);\n\n        this.props = originalProps;\n        return result;\n      }\n      return originalRender.call(this);\n    };\n  };\n\n  const patchVM = () => {\n    const RenderedTarget = vm.runtime.targets[0].constructor;\n\n    const originalInstallTargets = vm.installTargets;\n    vm.installTargets = function (...args) {\n      if (currentSpriteFolder !== null) {\n        const targets = args[0];\n        const wholeProject = args[2];\n        if (Array.isArray(targets) && !wholeProject) {\n          for (const target of targets) {\n            if (target.sprite) {\n              target.sprite.name = setFolderOfName(target.sprite.name, currentSpriteFolder);\n            }\n          }\n        }\n      }\n      return originalInstallTargets.call(this, ...args).then((r) => {\n        fixTargetOrder();\n        return r;\n      });\n    };\n\n    const originalAddCostume = RenderedTarget.prototype.addCostume;\n    RenderedTarget.prototype.addCostume = function (...args) {\n      if (currentAssetFolder !== null) {\n        const costume = args[0];\n        if (costume && typeof getFolderFromName(costume.name) !== \"string\") {\n          costume.name = setFolderOfName(costume.name, currentAssetFolder);\n        }\n      }\n      const r = originalAddCostume.call(this, ...args);\n      fixCostumeOrder(this);\n      return r;\n    };\n\n    const originalAddSound = RenderedTarget.prototype.addSound;\n    RenderedTarget.prototype.addSound = function (...args) {\n      if (currentAssetFolder !== null) {\n        const sound = args[0];\n        if (sound && typeof getFolderFromName(sound.name) !== \"string\") {\n          sound.name = setFolderOfName(sound.name, currentAssetFolder);\n        }\n      }\n      const r = originalAddSound.call(this, ...args);\n      fixSoundOrder(this);\n      return r;\n    };\n\n    const abstractReorder = (\n      { guiItems, getAll, set, rename, getVMItemFromGUIItem, zeroIndexed, onFolderChanged },\n      itemIndex,\n      newIndex\n    ) => {\n      // First index depends on zeroIndexed\n      itemIndex = clamp(itemIndex, zeroIndexed ? 0 : 1, zeroIndexed ? guiItems.length - 1 : guiItems.length);\n      newIndex = clamp(newIndex, zeroIndexed ? 0 : 1, zeroIndexed ? guiItems.length - 1 : guiItems.length);\n      if (itemIndex === newIndex) {\n        return false;\n      }\n\n      let assets = getAll();\n      const originalAssets = getAll();\n\n      const targetItem = guiItems[itemIndex - (zeroIndexed ? 0 : 1)];\n      const itemAtNewIndex = guiItems[newIndex - (zeroIndexed ? 0 : 1)];\n      const targetItemData = getItemData(targetItem);\n      const itemAtNewIndexData = getItemData(itemAtNewIndex);\n\n      if (!targetItemData || !itemAtNewIndexData) {\n        console.warn(\"should never happen\");\n        return false;\n      }\n\n      const reorderingItems = typeof targetItemData.folder === \"string\" ? targetItem.items : [targetItem];\n      const reorderingAssets = reorderingItems.map((i) => getVMItemFromGUIItem(i, assets)).filter((i) => i);\n      if (typeof itemAtNewIndexData.realIndex === \"number\") {\n        const newTarget = getVMItemFromGUIItem(itemAtNewIndex, assets);\n        if (!newTarget || reorderingAssets.includes(newTarget)) {\n          // Dragging folder into itself or target doesn't exist. Ignore.\n          return false;\n        }\n      }\n\n      let newFolder = null;\n\n      assets = assets.filter((i) => !reorderingAssets.includes(i));\n\n      let realNewIndex;\n      if (newIndex === (zeroIndexed ? 0 : 1)) {\n        realNewIndex = zeroIndexed ? 0 : 1;\n      } else if (newIndex === guiItems.length - (zeroIndexed ? 1 : 0)) {\n        realNewIndex = assets.length;\n      } else if (typeof itemAtNewIndexData.realIndex === \"number\") {\n        newFolder = typeof itemAtNewIndexData.inFolder === \"string\" ? itemAtNewIndexData.inFolder : null;\n        let newAsset = getVMItemFromGUIItem(itemAtNewIndex, assets);\n        if (!newAsset) {\n          console.warn(\"should never happen\");\n          return false;\n        }\n        realNewIndex = assets.indexOf(newAsset);\n        if (newIndex > itemIndex) {\n          realNewIndex++;\n        }\n      } else if (typeof itemAtNewIndexData.folder === \"string\") {\n        let item;\n        let offset = 0;\n        if (newIndex < itemIndex) {\n          // A B [C D E] F G\n          //    ^----------*\n          // A B C [D] E F G\n          //      ^--------*\n          item = itemAtNewIndex.items[0];\n        } else if (itemAtNewIndexData.folderOpen) {\n          // A B [C D E] F G\n          //   *---^\n          item = itemAtNewIndex.items[0];\n          newFolder = itemAtNewIndexData.folder;\n        } else {\n          // A B [C] D E F G\n          //   *----^\n          item = itemAtNewIndex.items[itemAtNewIndex.items.length - 1];\n          offset = 1;\n        }\n        let newAsset = getVMItemFromGUIItem(item, assets);\n        if (newAsset) {\n          realNewIndex = assets.indexOf(newAsset) + offset;\n        } else {\n          // Edge case: Dragging the first item of a list on top of the folder item\n          // A B [C D E] F G\n          //    ^---*\n          newAsset = getVMItemFromGUIItem(item, originalAssets);\n          if (!newAsset) {\n            console.warn(\"should never happen\");\n            return false;\n          }\n          realNewIndex = originalAssets.indexOf(newAsset) + offset;\n        }\n      } else {\n        console.warn(\"should never happen\");\n        return false;\n      }\n\n      if (typeof targetItemData.folder === \"string\" && newFolder !== null) {\n        // Cannot drag a folder into another folder\n        return;\n      }\n\n      if (realNewIndex < (zeroIndexed ? 0 : 1) || realNewIndex > assets.length) {\n        console.warn(\"should never happen\");\n        return false;\n      }\n\n      assets.splice(realNewIndex, 0, ...reorderingAssets);\n      set(assets);\n\n      // If the folder has changed, update item names to match.\n      if (typeof targetItemData.folder !== \"string\" && targetItemData.inFolder !== newFolder) {\n        for (const asset of reorderingAssets) {\n          const name = asset.getName ? asset.getName() : asset.name;\n          rename(asset, setFolderOfName(name, newFolder));\n        }\n        if (onFolderChanged) {\n          onFolderChanged();\n        }\n      }\n\n      return true;\n    };\n\n    vm.constructor.prototype.reorderTarget = function (targetIndex, newIndex) {\n      return abstractReorder(\n        {\n          getAll: () => {\n            return this.runtime.targets;\n          },\n          set: (targets) => {\n            this.runtime.targets = targets;\n            this.emitTargetsUpdate();\n          },\n          rename: (item, name) => {\n            this.renameSprite(item.id, ensureNotReserved(name));\n          },\n          getVMItemFromGUIItem: (item, targets) => {\n            return targets.find((i) => i.id === item.id);\n          },\n          onFolderChanged: () => {\n            this.emitWorkspaceUpdate();\n          },\n          guiItems: currentSpriteItems,\n          zeroIndexed: false,\n        },\n        targetIndex,\n        newIndex\n      );\n    };\n\n    RenderedTarget.prototype.reorderCostume = function (costumeIndex, newIndex) {\n      return abstractReorder(\n        {\n          getAll: () => {\n            return this.sprite.costumes;\n          },\n          set: (assets) => {\n            this.sprite.costumes = assets;\n          },\n          rename: (item, name) => {\n            this.renameCostume(this.sprite.costumes.indexOf(item), name);\n          },\n          getVMItemFromGUIItem: (item, costumes) => {\n            const itemData = getItemData(item);\n            return costumes.find((c) => c.name === itemData.realName);\n          },\n          guiItems: currentAssetItems,\n          zeroIndexed: true,\n        },\n        costumeIndex,\n        newIndex\n      );\n    };\n\n    RenderedTarget.prototype.reorderSound = function (soundIndex, newIndex) {\n      return abstractReorder(\n        {\n          getAll: () => {\n            return this.sprite.sounds;\n          },\n          set: (assets) => {\n            this.sprite.sounds = assets;\n          },\n          rename: (item, name) => {\n            this.renameSound(this.sprite.sounds.indexOf(item), name);\n          },\n          getVMItemFromGUIItem: (item, sounds) => {\n            const itemData = getItemData(item);\n            return sounds.find((c) => c.name === itemData.realName);\n          },\n          guiItems: currentAssetItems,\n          zeroIndexed: true,\n        },\n        soundIndex,\n        newIndex\n      );\n    };\n  };\n\n  const patchBackpack = (backpackInstance) => {\n    const Backpack = backpackInstance.constructor;\n    Backpack.prototype.sa_loadNextItem = function () {\n      if (!this.sa_queuedItems) return;\n      const item = this.sa_queuedItems.pop();\n      if (item) {\n        let payload;\n        let type;\n        if (item.dragPayload) {\n          if (item.url) {\n            type = \"SOUND\";\n          } else {\n            type = \"COSTUME\";\n          }\n          payload = item.dragPayload;\n        } else if (item.id) {\n          type = \"SPRITE\";\n          payload = item.id;\n        }\n        if (type && payload) {\n          originalHandleDrop.call(this, {\n            dragType: type,\n            payload: payload,\n          });\n        }\n      }\n    };\n\n    Backpack.prototype.componentDidUpdate = function (prevProps, prevState) {\n      if (!this.state.loading && prevState.loading && !this.state.error) {\n        this.sa_loadNextItem();\n      }\n    };\n\n    const originalHandleDrop = Backpack.prototype.handleDrop;\n    Backpack.prototype.handleDrop = function (...args) {\n      // When a folder is dropped into the backpack, upload all the items in the folder.\n      const dragInfo = args[0];\n      const folderItems = dragInfo && dragInfo.payload && dragInfo.payload.sa_folder_items;\n      if (Array.isArray(folderItems)) {\n        addon.tab.confirm(\"\", msg(\"confirm-backpack-folder\"), { useEditorClasses: true }).then((result) => {\n          if (!result) return;\n          this.sa_queuedItems = folderItems;\n          this.sa_loadNextItem();\n        });\n        return;\n      }\n      return originalHandleDrop.call(this, ...args);\n    };\n    backpackInstance.handleDrop = Backpack.prototype.handleDrop.bind(backpackInstance);\n  };\n\n  // Backpack\n  {\n    const clickListener = (e) => {\n      if (!e.target.closest('[class*=\"backpack_backpack-header_\"]')) {\n        return;\n      }\n      setTimeout(() => {\n        const backpackContainer = document.querySelector(\"[class^='backpack_backpack-list_']\");\n        if (!backpackContainer) {\n          return;\n        }\n        document.removeEventListener(\"click\", clickListener);\n        const backpackInstance = getBackpackFromElement(backpackContainer);\n        verifyBackpack(backpackInstance);\n        patchBackpack(backpackInstance);\n      });\n    };\n    document.addEventListener(\"click\", clickListener, true);\n  }\n\n  // Sprite list\n  {\n    const spriteSelectorItemElement = await addon.tab.waitForElement(\"[class^='sprite-selector_sprite-wrapper']\", {\n      reduxCondition: (state) => !state.scratchGui.mode.isPlayerOnly,\n    });\n    vm = addon.tab.traps.vm;\n    reactInternalKey = Object.keys(spriteSelectorItemElement).find((i) => i.startsWith(REACT_INTERNAL_PREFIX));\n    const sortableHOCInstance = getSortableHOCFromElement(spriteSelectorItemElement);\n    const spriteSelectorItemInstance = spriteSelectorItemElement[reactInternalKey].child.child.child.stateNode;\n    verifySortableHOC(sortableHOCInstance);\n    verifySpriteSelectorItem(spriteSelectorItemInstance);\n    verifyVM(vm);\n    patchSortableHOC(sortableHOCInstance.constructor, TYPE_SPRITES);\n    patchSpriteSelectorItem(spriteSelectorItemInstance.constructor);\n    sortableHOCInstance.saInitialSetup();\n    patchVM();\n  }\n\n  // Costume and sound list\n  {\n    const selectorListItem = await addon.tab.waitForElement(\"[class*='selector_list-item']\", {\n      reduxCondition: (state) => state.scratchGui.editorTab.activeTabIndex !== 0 && !state.scratchGui.mode.isPlayerOnly,\n    });\n    const sortableHOCInstance = getSortableHOCFromElement(selectorListItem);\n    verifySortableHOC(sortableHOCInstance);\n    patchSortableHOC(sortableHOCInstance.constructor, TYPE_ASSETS);\n    sortableHOCInstance.saInitialSetup();\n  }\n}\n","/* generated by pull.js */\nimport _js from \"./userscript.js\";\nexport const resources = {\n  \"userscript.js\": _js,\n};\n","export default async ({ addon, console, msg }) => {\n  const types = [\"sound\", \"costume\"];\n\n  addon.tab.createEditorContextMenu(\n    (ctx) => {\n      const target = addon.tab.traps.vm.editingTarget;\n      if (ctx.type === \"sound\") {\n        target.reorderSound(ctx.index, 0);\n      } else {\n        target.reorderCostume(ctx.index, 0);\n      }\n      queueMicrotask(() => {\n        addon.tab.traps.vm.emitTargetsUpdate();\n        addon.tab.traps.vm.runtime.emitProjectChanged();\n        ctx.target.click();\n      });\n    },\n    {\n      types,\n      position: \"assetContextMenuAfterExport\",\n      order: 1,\n      label: msg(\"top\"),\n      condition: (ctx) => ctx.index !== 0,\n    }\n  );\n  addon.tab.createEditorContextMenu(\n    (ctx) => {\n      const target = addon.tab.traps.vm.editingTarget;\n      if (ctx.type === \"sound\") {\n        target.reorderSound(ctx.index, Infinity);\n      } else {\n        target.reorderCostume(ctx.index, Infinity);\n      }\n      queueMicrotask(() => {\n        addon.tab.traps.vm.emitTargetsUpdate();\n        addon.tab.traps.vm.runtime.emitProjectChanged();\n        ctx.target.click();\n      });\n    },\n    {\n      types,\n      position: \"assetContextMenuAfterExport\",\n      order: 2,\n      label: msg(\"bottom\"),\n      condition: (ctx) => ctx.index !== ctx.target.parentNode.parentNode.childElementCount - 1,\n    }\n  );\n};\n","/* generated by pull.js */\nimport _js from \"./userscript.js\";\nimport _css from \"!css-loader!./style.css\";\nexport const resources = {\n  \"userscript.js\": _js,\n  \"style.css\": _css,\n};\n","/* inserted by pull.js */\nimport _twAsset0 from \"!url-loader!./decrement.svg\";\nimport _twAsset1 from \"!url-loader!./increment.svg\";\nimport _twAsset2 from \"!url-loader!./settings.svg\";\nimport _twAsset3 from \"!url-loader!./toggle.svg\";\nconst _twGetAsset = (path) => {\n  if (path === \"/decrement.svg\") return _twAsset0;\n  if (path === \"/increment.svg\") return _twAsset1;\n  if (path === \"/settings.svg\") return _twAsset2;\n  if (path === \"/toggle.svg\") return _twAsset3;\n  throw new Error(`Unknown asset: ${path}`);\n};\n\nexport default async function ({ addon, global, console, msg }) {\n  const paper = await addon.tab.traps.getPaper();\n\n  const paintEditorCanvasContainer = await addon.tab.waitForElement(\"[class^='paint-editor_canvas-container']\");\n  try {\n    if (!(\"colorIndex\" in addon.tab.redux.state.scratchPaint.fillMode)) {\n      console.error(\"Detected new paint editor; this will be supported in future versions.\");\n      return;\n    }\n  } catch (_) {\n    // The check can technically fail when Redux isn't supported (rare cases)\n    // Just ignore in this case\n  }\n  const paperCanvas =\n    paintEditorCanvasContainer[addon.tab.traps.getInternalKey(paintEditorCanvasContainer)].child.child.child.stateNode;\n\n  const storedOnionLayers = [];\n\n  const parseHexColor = (color) => {\n    const hexString = color.substr(1);\n    const hexNumber = parseInt(hexString, 16);\n    return [\n      (hexNumber >> 16) & 0xff, // R\n      (hexNumber >> 8) & 0xff, // G\n      hexNumber & 0xff, // B\n    ];\n  };\n\n  const settings = {\n    enabled: addon.settings.get(\"default\") && !addon.self.disabled,\n    previous: +addon.settings.get(\"previous\"),\n    next: +addon.settings.get(\"next\"),\n    opacity: +addon.settings.get(\"opacity\"),\n    opacityStep: +addon.settings.get(\"opacityStep\"),\n    layering: addon.settings.get(\"layering\"),\n    mode: addon.settings.get(\"mode\"),\n    beforeTint: parseHexColor(addon.settings.get(\"beforeTint\")),\n    afterTint: parseHexColor(addon.settings.get(\"afterTint\")),\n  };\n\n  const getPaperCenter = () => {\n    const backgroundGuideLayer = paper.project.layers.find((i) => i.data.isBackgroundGuideLayer);\n    return backgroundGuideLayer.children[0].position;\n  };\n\n  const injectPaper = () => {\n    // When background guide layer is added, show onion layers.\n    // https://github.com/LLK/scratch-paint/blob/cdf0afc217633e6cfb8ba90ea4ae38b79882cf6c/src/helper/layer.js#L145\n    const originalAddLayer = paper.Project.prototype.addLayer;\n    paper.Project.prototype.addLayer = function (layer) {\n      const result = originalAddLayer.call(this, layer);\n      if (layer.data.isBackgroundGuideLayer) {\n        let onion;\n        while ((onion = storedOnionLayers.shift())) {\n          originalAddLayer.call(this, onion);\n        }\n        relayerOnionLayers();\n      }\n      return result;\n    };\n\n    // Scratch uses importJSON to undo or redo\n    // https://github.com/LLK/scratch-paint/blob/cdf0afc217633e6cfb8ba90ea4ae38b79882cf6c/src/helper/undo.js#L37\n    // The code prior to this will remove our onion layers, so we have to manually add them back.\n    const originalImportJSON = paper.Project.prototype.importJSON;\n    paper.Project.prototype.importJSON = function (json) {\n      const result = originalImportJSON.call(this, json);\n      if (settings.enabled) {\n        updateOnionLayers();\n      }\n      return result;\n    };\n\n    // https://github.com/LLK/scratch-paint/blob/cdf0afc217633e6cfb8ba90ea4ae38b79882cf6c/src/helper/layer.js#L114\n    // When background guide layer is removed, hide onion layers.\n    const originalRemoveLayer = paper.Layer.prototype.remove;\n    paper.Layer.prototype.remove = function () {\n      if (this.data.isBackgroundGuideLayer) {\n        for (const layer of paper.project.layers) {\n          if (layer.data.sa_isOnionLayer) {\n            storedOnionLayers.push(layer);\n          }\n        }\n        for (const layer of storedOnionLayers) {\n          layer.remove();\n        }\n      }\n      return originalRemoveLayer.call(this);\n    };\n  };\n\n  const injectPaperCanvas = () => {\n    let expectingImport = false;\n\n    const PaperCanvas = paperCanvas.constructor;\n\n    // importImage is called to start loading an image.\n    // https://github.com/LLK/scratch-paint/blob/cdf0afc217633e6cfb8ba90ea4ae38b79882cf6c/src/containers/paper-canvas.jsx#L124\n    const originalImportImage = PaperCanvas.prototype.importImage;\n    PaperCanvas.prototype.importImage = function (...args) {\n      expectingImport = true;\n      removeOnionLayers();\n      return originalImportImage.call(this, ...args);\n    };\n\n    // recalibrateSize is called when the canvas finishes loading an image.\n    // all paths of importImage will result in a call to this method.\n    // https://github.com/LLK/scratch-paint/blob/cdf0afc217633e6cfb8ba90ea4ae38b79882cf6c/src/containers/paper-canvas.jsx#L310-L327\n    // We use this to know when to add layers.\n    const originalRecalibrateSize = PaperCanvas.prototype.recalibrateSize;\n    PaperCanvas.prototype.recalibrateSize = function (callback) {\n      return originalRecalibrateSize.call(this, () => {\n        if (callback) callback();\n        if (expectingImport) {\n          expectingImport = false;\n          if (settings.enabled) {\n            updateOnionLayers();\n          }\n        }\n      });\n    };\n\n    // Prototype overrides will work for all future instances, but Scratch manually binds some methods to `this`\n    // so we have to manually copy them for the current instance (but not future instances)\n    paperCanvas.recalibrateSize = PaperCanvas.prototype.recalibrateSize.bind(paperCanvas);\n    paperCanvas.importImage = PaperCanvas.prototype.importImage.bind(paperCanvas);\n  };\n\n  const createOnionLayer = () => {\n    const layer = new paper.Layer();\n    layer.locked = true;\n    layer.guide = true;\n    layer.data.sa_isOnionLayer = true;\n    return layer;\n  };\n\n  // Each onion layer update is given an ID\n  // Because updating layers is async, we need this to cancel all but the most recent update\n  let globalUpdateId = 0;\n  const cancelOngoingUpdatesAndGetNewId = () => ++globalUpdateId;\n\n  const removeOnionLayers = () => {\n    cancelOngoingUpdatesAndGetNewId();\n\n    const project = paper.project;\n    if (!project) {\n      return;\n    }\n\n    storedOnionLayers.length = 0;\n    const layers = project.layers;\n    // Iterate downward because we remove items mid-iteration\n    for (let i = layers.length - 1; i >= 0; i--) {\n      const layer = layers[i];\n      if (layer.data.sa_isOnionLayer) {\n        layer.remove();\n      }\n    }\n  };\n\n  const relayerOnionLayers = () => {\n    const project = paper.project;\n    if (!project) {\n      return;\n    }\n    const onionLayer = project.layers.find((i) => i.data.sa_isOnionLayer);\n    if (!onionLayer) {\n      return;\n    }\n    if (settings.layering === \"front\") {\n      project.addLayer(onionLayer);\n    } else {\n      const rasterLayer = project.layers.find((i) => i.data.isRasterLayer);\n      if (rasterLayer.index === 0) {\n        project.insertLayer(0, onionLayer);\n      } else {\n        project.insertLayer(1, onionLayer);\n      }\n    }\n  };\n\n  const recursePaperItem = (item, callback) => {\n    if (item.children) {\n      for (const child of item.children) {\n        recursePaperItem(child, callback);\n      }\n    }\n    callback(item);\n  };\n\n  const getTint = (red, green, blue, isBefore) => {\n    const referenceColor = isBefore ? settings.beforeTint : settings.afterTint;\n    const colorAverage = (red + green + blue) / 3 / 255;\n    const WEIGHT = 1.5;\n    const weighted = colorAverage / WEIGHT + (1 - 1 / WEIGHT);\n    return [referenceColor[0] * weighted, referenceColor[1] * weighted, referenceColor[2] * weighted];\n  };\n\n  const toHexColor = ([red, green, blue]) => {\n    const r = Math.round(red).toString(16).padStart(2, \"0\");\n    const g = Math.round(green).toString(16).padStart(2, \"0\");\n    const b = Math.round(blue).toString(16).padStart(2, \"0\");\n    return `#${r}${g}${b}`;\n  };\n\n  const getPaperColorTint = (color, isBefore) =>\n    toHexColor(getTint(color.red * 255, color.green * 255, color.blue * 255, isBefore));\n\n  const tintRaster = (raster, isBefore) => {\n    const { width, height } = raster.canvas;\n    const context = raster.context;\n    // TODO: check to see if this is a performance issue\n    const imageData = context.getImageData(0, 0, width, height);\n    const data = imageData.data;\n    for (let i = 0; i < data.length; i += 4 /* RGBA */) {\n      const red = data[i + 0];\n      const green = data[i + 1];\n      const blue = data[i + 2];\n      const alpha = data[i + 3];\n      if (alpha === 0) {\n        continue;\n      }\n      const newTint = getTint(red, green, blue, isBefore);\n      data[i + 0] = newTint[0];\n      data[i + 1] = newTint[1];\n      data[i + 2] = newTint[2];\n    }\n    context.putImageData(imageData, 0, 0);\n  };\n\n  const waitForAllRastersToLoad = (root) => {\n    const promises = [];\n    recursePaperItem(root, (item) => {\n      if (item instanceof paper.Raster) {\n        promises.push(\n          new Promise((resolve, reject) => {\n            item.on(\"load\", () => resolve());\n            item.on(\"error\", () => reject(new Error(\"Raster inside SVG failed to load\")));\n          })\n        );\n      }\n    });\n    return Promise.all(promises);\n  };\n\n  const rasterizeVector = (root) => {\n    const bounds = root.strokeBounds;\n    const { width, height } = bounds;\n\n    // Some browsers experience extremely poor performance when this value exceeds 3840.\n    const MAX_SIZE = 3000;\n    const maxScale = Math.min(MAX_SIZE / width, MAX_SIZE / height);\n\n    const raster = new paper.Raster(new paper.Size(width, height));\n    raster.remove();\n    raster.smoothing = true;\n\n    raster.guide = true;\n    raster.locked = true;\n\n    let renderedAtScale = 0;\n    const originalDraw = raster.draw;\n    raster.draw = function (...args) {\n      const displayedSize = this.getView().getZoom() * window.devicePixelRatio;\n      const newScale = Math.max(1, Math.min(maxScale, 2 ** Math.ceil(Math.log2(displayedSize))));\n      if (newScale > renderedAtScale) {\n        renderedAtScale = newScale;\n        const canvas = this.canvas;\n        const ctx = this.context;\n\n        // Based on https://github.com/LLK/paper.js/blob/16d5ff0267e3a0ef647c25e58182a27300afad20/src/item/Item.js#L1761\n        const scaledWidth = width * newScale;\n        const scaledHeight = height * newScale;\n        canvas.width = scaledWidth;\n        canvas.height = scaledHeight;\n\n        this._size = new paper.Size(scaledWidth, scaledHeight);\n        const topLeft = bounds.getTopLeft();\n        const bottomRight = bounds.getBottomRight();\n        const size = new paper.Size(bottomRight.subtract(topLeft));\n        const matrix = new paper.Matrix().scale(newScale).translate(topLeft.negate());\n        ctx.save();\n        matrix.applyToContext(ctx);\n        root.draw(\n          ctx,\n          new paper.Base({\n            matrices: [matrix],\n          })\n        );\n        ctx.restore();\n        this.matrix.reset();\n        this.transform(new paper.Matrix().translate(topLeft.add(size.divide(2))).scale(1 / newScale));\n      }\n\n      return originalDraw.call(this, ...args);\n    };\n\n    return raster;\n  };\n\n  const makeVectorOnion = (opacity, costume, asset, isBefore) =>\n    new Promise((resolve, reject) => {\n      const { rotationCenterX, rotationCenterY } = costume;\n      // https://github.com/LLK/scratch-paint/blob/cdf0afc217633e6cfb8ba90ea4ae38b79882cf6c/src/containers/paper-canvas.jsx#L196-L218\n      asset = asset.split(/<\\s*svg:/).join(\"<\");\n      asset = asset.split(/<\\/\\s*svg:/).join(\"</\");\n      const svgAttrs = asset.match(/<svg [^>]*>/);\n      if (svgAttrs && svgAttrs[0].indexOf(\"xmlns=\") === -1) {\n        asset = asset.replace(\"<svg \", '<svg xmlns=\"http://www.w3.org/2000/svg\" ');\n      }\n      const parser = new DOMParser();\n      const svgDom = parser.parseFromString(asset, \"text/xml\");\n      const viewBox = svgDom.documentElement.attributes.viewBox\n        ? svgDom.documentElement.attributes.viewBox.value.match(/\\S+/g)\n        : null;\n      if (viewBox) {\n        for (let i = 0; i < viewBox.length; i++) {\n          viewBox[i] = parseFloat(viewBox[i]);\n        }\n      }\n\n      const handleLoad = (root) => {\n        root.opacity = opacity;\n\n        // https://github.com/LLK/scratch-paint/blob/cdf0afc217633e6cfb8ba90ea4ae38b79882cf6c/src/containers/paper-canvas.jsx#L274-L275\n        recursePaperItem(root, (i) => {\n          if (i.className === \"PathItem\") {\n            i.clockwise = true;\n          }\n          if (i.className !== \"PointText\" && !i.children) {\n            if (i.strokeWidth) {\n              i.strokeWidth = i.strokeWidth * 2;\n            }\n          }\n          i.locked = true;\n          i.guide = true;\n        });\n        root.scale(2, new paper.Point(0, 0));\n\n        if (settings.mode === \"tint\") {\n          const gradients = new Set();\n          recursePaperItem(root, (i) => {\n            if (i.strokeColor) {\n              i.strokeColor = getPaperColorTint(i.strokeColor, isBefore);\n            }\n            if (i.fillColor) {\n              const gradient = i.fillColor.gradient;\n              if (gradient) {\n                if (gradients.has(gradient)) return;\n                gradients.add(gradient);\n                for (const stop of gradient.stops) {\n                  stop.color = getPaperColorTint(stop.color, isBefore);\n                }\n              } else {\n                i.fillColor = getPaperColorTint(i.fillColor, isBefore);\n              }\n            }\n            if (i.canvas) {\n              tintRaster(i, isBefore);\n            }\n          });\n        }\n\n        const paperCenter = getPaperCenter();\n        // https://github.com/LLK/scratch-paint/blob/cdf0afc217633e6cfb8ba90ea4ae38b79882cf6c/src/containers/paper-canvas.jsx#L277-L287\n        if (typeof rotationCenterX !== \"undefined\" && typeof rotationCenterY !== \"undefined\") {\n          let rotationPoint = new paper.Point(rotationCenterX, rotationCenterY);\n          if (viewBox && viewBox.length >= 2 && !isNaN(viewBox[0]) && !isNaN(viewBox[1])) {\n            rotationPoint = rotationPoint.subtract(viewBox[0], viewBox[1]);\n          }\n          root.translate(paperCenter.subtract(rotationPoint.multiply(2)));\n        } else {\n          root.translate(paperCenter.subtract(root.bounds.width, root.bounds.height));\n        }\n\n        return rasterizeVector(root);\n      };\n\n      paper.project.importSVG(asset, {\n        expandShapes: true,\n        insert: false,\n        onLoad: (root) => {\n          if (!root) {\n            reject(new Error(\"could not load onion skin\"));\n            return;\n          }\n          resolve(waitForAllRastersToLoad(root).then(() => handleLoad(root)));\n        },\n      });\n    });\n\n  const makeRasterOnion = (opacity, costume, asset, isBefore) =>\n    new Promise((resolve, reject) => {\n      let { rotationCenterX, rotationCenterY } = costume;\n\n      const image = new Image();\n      image.onload = () => {\n        const paperCenter = getPaperCenter();\n        const width = Math.min(paperCenter.x * 2, image.width);\n        const height = Math.min(paperCenter.y * 2, image.height);\n\n        // https://github.com/LLK/scratch-paint/blob/cdf0afc217633e6cfb8ba90ea4ae38b79882cf6c/src/containers/paper-canvas.jsx#L151-L156\n        if (typeof rotationCenterX === \"undefined\") {\n          rotationCenterX = width / 2;\n        }\n        if (typeof rotationCenterY === \"undefined\") {\n          rotationCenterY = height / 2;\n        }\n\n        const raster = new paper.Raster(image);\n        raster.opacity = opacity;\n        raster.guide = true;\n        raster.locked = true;\n        const x = width / 2 + (paperCenter.x - rotationCenterX);\n        const y = height / 2 + (paperCenter.y - rotationCenterY);\n        raster.position = new paper.Point(x, y);\n        raster.remove();\n\n        if (settings.mode === \"tint\") {\n          tintRaster(raster, isBefore);\n        }\n\n        resolve(raster);\n      };\n      image.onerror = () => {\n        reject(new Error(\"could not load image\"));\n      };\n      image.src = asset;\n    });\n\n  const getSelectedCostumeIndex = () => {\n    const item = document.querySelector(\"[class*='selector_list-item'][class*='sprite-selector-item_is-selected']\");\n    if (!item) return -1;\n    const numberEl = item.querySelector(\"[class*='sprite-selector-item_number']\");\n    if (!numberEl) return -1;\n    return +numberEl.textContent - 1;\n  };\n\n  const updateOnionLayers = async () => {\n    const project = paper.project;\n    if (!project) {\n      return;\n    }\n\n    const selectedCostumeIndex = getSelectedCostumeIndex();\n    if (selectedCostumeIndex === -1) {\n      return;\n    }\n\n    removeOnionLayers();\n\n    const localUpdateId = cancelOngoingUpdatesAndGetNewId();\n\n    const vm = addon.tab.traps.vm;\n    if (!vm) {\n      return;\n    }\n    const originalActiveLayer = project.activeLayer;\n    const costumes = vm.editingTarget.sprite.costumes;\n\n    const startIndex = Math.max(0, selectedCostumeIndex - settings.previous);\n    const endIndex = Math.min(costumes.length - 1, selectedCostumeIndex + settings.next);\n\n    try {\n      const layersToCreate = [];\n      for (let i = startIndex; i <= endIndex; i++) {\n        if (i === selectedCostumeIndex) {\n          continue;\n        }\n        const isBefore = i < selectedCostumeIndex;\n        const distance = Math.abs(i - selectedCostumeIndex) - 1;\n        const opacity = (settings.opacity - settings.opacityStep * distance) / 100;\n        if (opacity <= 0) {\n          continue;\n        }\n        layersToCreate.push({\n          index: i,\n          isBefore,\n          opacity,\n        });\n      }\n\n      const onions = await Promise.all(\n        layersToCreate.map(({ index, isBefore, opacity }) => {\n          const onionCostume = costumes[index];\n          const onionAsset = vm.getCostume(index);\n\n          if (onionCostume.dataFormat === \"svg\") {\n            return makeVectorOnion(opacity, onionCostume, onionAsset, isBefore);\n          } else if (onionCostume.dataFormat === \"png\" || onionCostume.dataFormat === \"jpg\") {\n            return makeRasterOnion(opacity, onionCostume, onionAsset, isBefore);\n          } else {\n            throw new Error(`Unknown data format: ${onionCostume.dataFormat}`);\n          }\n        })\n      );\n\n      // Make sure we haven't been cancelled\n      if (globalUpdateId === localUpdateId) {\n        const layer = createOnionLayer();\n        for (const item of onions) {\n          layer.addChild(item);\n        }\n        relayerOnionLayers();\n      }\n    } catch (e) {\n      console.error(e);\n    }\n\n    // We must make sure to always reset the active layer to avoid corruption.\n    originalActiveLayer.activate();\n  };\n\n  const setEnabled = (_enabled) => {\n    if (settings.enabled === _enabled) {\n      return;\n    }\n    settings.enabled = _enabled;\n    if (settings.enabled) {\n      if (settings.next === 0 && settings.previous === 0) {\n        settings.previous = 1;\n        layerInputs.previous.value = settings.previous;\n      }\n      if (settings.opacity === 0) {\n        settings.opacity = 25;\n        layerInputs.opacity.value = settings.opacity;\n      }\n      updateOnionLayers();\n    } else {\n      removeOnionLayers();\n    }\n    toggleButton.dataset.enabled = settings.enabled;\n  };\n\n  //\n  // Controls below editor\n  //\n\n  const settingsChanged = (onlyRelayerNeeded) => {\n    if ((settings.previous === 0 && settings.next === 0) || settings.opacity === 0) {\n      setEnabled(false);\n      return;\n    }\n    if (settings.enabled) {\n      if (onlyRelayerNeeded) {\n        relayerOnionLayers();\n      } else {\n        updateOnionLayers();\n      }\n    } else if (settings.previous > 0 || settings.next > 0) {\n      setEnabled(true);\n    }\n  };\n\n  const createGroup = () => {\n    const el = document.createElement(\"div\");\n    el.className = \"sa-onion-group\";\n    return el;\n  };\n\n  const createButton = ({ useButtonTag } = {}) => {\n    const el = document.createElement(useButtonTag ? \"button\" : \"span\");\n    el.className = \"sa-onion-button\";\n    el.setAttribute(\"role\", \"button\");\n    return el;\n  };\n\n  const createButtonImage = (name) => {\n    const el = document.createElement(\"img\");\n    el.className = \"sa-onion-image\";\n    el.draggable = false;\n    el.dataset.image = name;\n    el.loading = \"lazy\";\n    el.src = _twGetAsset(\"/\" + name + \".svg\");\n    return el;\n  };\n\n  const paintEditorControlsContainer = document.createElement(\"div\");\n  paintEditorControlsContainer.className = \"sa-onion-controls-container\";\n  paintEditorControlsContainer.dir = \"\";\n\n  const toggleControlsGroup = createGroup();\n  addon.tab.displayNoneWhileDisabled(toggleControlsGroup, { display: \"flex\" });\n\n  const toggleButton = createButton();\n  toggleButton.dataset.enabled = settings.enabled;\n  toggleButton.addEventListener(\"click\", () => setEnabled(!settings.enabled));\n  toggleButton.title = msg(\"toggle\");\n  toggleButton.appendChild(createButtonImage(\"toggle\"));\n  toggleControlsGroup.appendChild(toggleButton);\n\n  const settingButton = createButton();\n  settingButton.addEventListener(\"click\", () => setSettingsOpen(!areSettingsOpen()));\n  settingButton.title = msg(\"settings\");\n  settingButton.appendChild(createButtonImage(\"settings\"));\n  toggleControlsGroup.appendChild(settingButton);\n\n  paintEditorControlsContainer.appendChild(toggleControlsGroup);\n\n  //\n  // Settings page\n  //\n\n  const settingsPage = document.createElement(\"div\");\n  settingsPage.className = \"sa-onion-settings\";\n\n  const setSettingsOpen = (open) => {\n    settingButton.dataset.enabled = open;\n    settingsPage.dataset.visible = open;\n  };\n  const areSettingsOpen = () => settingsPage.dataset.visible === \"true\";\n\n  const layerInputs = {};\n  for (const type of [\"previous\", \"next\", \"opacity\", \"opacityStep\"]) {\n    const container = document.createElement(\"label\");\n    container.className = \"sa-onion-settings-line\";\n\n    const label = document.createElement(\"div\");\n    label.className = \"sa-onion-settings-label\";\n    label.textContent = msg(type);\n    container.appendChild(label);\n\n    const group = createGroup();\n    const currentButton = createButton();\n\n    const filler = document.createElement(\"div\");\n    filler.style.width = \"20px\";\n    currentButton.appendChild(filler);\n\n    const currentInput = document.createElement(\"input\");\n    layerInputs[type] = currentInput;\n    currentInput.className = \"sa-onion-settings-input\";\n    currentInput.type = \"number\";\n    currentInput.step = \"1\";\n    currentInput.min = \"0\";\n    currentInput.max = \"100\";\n    currentInput.value = settings[type];\n    currentInput.addEventListener(\"input\", (e) => {\n      if (currentInput.value.length === 0) {\n        settings[type] = 0;\n        settingsChanged();\n        return;\n      }\n      let value = +currentInput.value;\n      if (value > +currentInput.max) {\n        value = +currentInput.max;\n      } else if (value < 0) {\n        value = 0;\n      }\n      currentInput.value = value;\n      settings[type] = value;\n      settingsChanged();\n    });\n    currentInput.addEventListener(\"blur\", () => {\n      if (!currentInput.value) {\n        currentInput.value = \"0\";\n      }\n    });\n    currentButton.appendChild(currentInput);\n\n    const decrementButton = createButton();\n    decrementButton.appendChild(createButtonImage(\"decrement\"));\n    decrementButton.addEventListener(\"click\", () => {\n      if (settings[type] > 0) {\n        settings[type]--;\n        currentInput.value = settings[type];\n        settingsChanged();\n      }\n    });\n\n    const incrementButton = createButton();\n    incrementButton.appendChild(createButtonImage(\"increment\"));\n    incrementButton.addEventListener(\"click\", () => {\n      if (settings[type] < +currentInput.max) {\n        settings[type]++;\n        currentInput.value = settings[type];\n        settingsChanged();\n      }\n    });\n\n    group.appendChild(decrementButton);\n    group.appendChild(currentButton);\n    group.appendChild(incrementButton);\n    container.appendChild(group);\n    settingsPage.appendChild(container);\n  }\n\n  const modeContainer = document.createElement(\"div\");\n  modeContainer.className = \"sa-onion-settings-line\";\n  const modeLabel = document.createElement(\"div\");\n  modeLabel.className = \"sa-onion-settings-label\";\n  modeLabel.textContent = msg(\"mode\");\n  const modeGroup = createGroup();\n  modeContainer.appendChild(modeLabel);\n  const modeMergeButton = createButton({ useButtonTag: true });\n  modeMergeButton.appendChild(document.createTextNode(msg(\"merge\")));\n  modeGroup.appendChild(modeMergeButton);\n  modeMergeButton.addEventListener(\"click\", (e) => {\n    settings.mode = \"merge\";\n    modeTintButton.dataset.enabled = false;\n    modeMergeButton.dataset.enabled = true;\n    settingsChanged();\n  });\n  modeMergeButton.dataset.enabled = settings.mode === \"merge\";\n  const modeTintButton = createButton({ useButtonTag: true });\n  modeTintButton.appendChild(document.createTextNode(msg(\"tint\")));\n  modeGroup.appendChild(modeTintButton);\n  modeTintButton.addEventListener(\"click\", (e) => {\n    settings.mode = \"tint\";\n    modeTintButton.dataset.enabled = true;\n    modeMergeButton.dataset.enabled = false;\n    settingsChanged();\n  });\n  modeTintButton.dataset.enabled = settings.mode === \"tint\";\n  modeContainer.appendChild(modeGroup);\n  settingsPage.appendChild(modeContainer);\n\n  const layeringContainer = document.createElement(\"div\");\n  layeringContainer.className = \"sa-onion-settings-line\";\n  const layeringLabel = document.createElement(\"div\");\n  layeringLabel.className = \"sa-onion-settings-label\";\n  layeringLabel.textContent = msg(\"layering\");\n  const layeringGroup = createGroup();\n  layeringContainer.appendChild(layeringLabel);\n  const layeringFrontButton = createButton({ useButtonTag: true });\n  layeringFrontButton.appendChild(document.createTextNode(msg(\"front\")));\n  layeringGroup.appendChild(layeringFrontButton);\n  layeringFrontButton.addEventListener(\"click\", (e) => {\n    settings.layering = \"front\";\n    layeringBehindButton.dataset.enabled = false;\n    layeringFrontButton.dataset.enabled = true;\n    settingsChanged(true);\n  });\n  layeringFrontButton.dataset.enabled = settings.layering === \"front\";\n  const layeringBehindButton = createButton({ useButtonTag: true });\n  layeringBehindButton.appendChild(document.createTextNode(msg(\"behind\")));\n  layeringGroup.appendChild(layeringBehindButton);\n  layeringBehindButton.addEventListener(\"click\", (e) => {\n    settings.layering = \"behind\";\n    layeringBehindButton.dataset.enabled = true;\n    layeringFrontButton.dataset.enabled = false;\n    settingsChanged(true);\n  });\n  layeringBehindButton.dataset.enabled = settings.layering === \"behind\";\n  layeringContainer.appendChild(layeringGroup);\n  settingsPage.appendChild(layeringContainer);\n\n  const SVG_NS = \"http://www.w3.org/2000/svg\";\n  const settingsTip = document.createElementNS(SVG_NS, \"svg\");\n  settingsTip.setAttribute(\"class\", \"sa-onion-settings-tip\");\n  settingsTip.setAttribute(\"width\", \"14\");\n  settingsTip.setAttribute(\"height\", \"7\");\n  const settingsTipShape = document.createElementNS(SVG_NS, \"polygon\");\n  settingsTipShape.setAttribute(\"class\", \"sa-onion-settings-polygon\");\n  settingsTipShape.setAttribute(\"points\", \"0,0 7,7, 14,0\");\n  settingsTip.appendChild(settingsTipShape);\n  settingsPage.appendChild(settingsTip);\n\n  let oldEnabled = null;\n  addon.self.addEventListener(\"disabled\", () => {\n    setSettingsOpen(false);\n    oldEnabled = settings.enabled;\n    setEnabled(false);\n  });\n  addon.self.addEventListener(\"reenabled\", () => {\n    setEnabled(oldEnabled);\n  });\n\n  const controlsLoop = async () => {\n    let hasRunOnce = false;\n    while (true) {\n      const canvasControls = await addon.tab.waitForElement(\"[class^='paint-editor_canvas-controls']\", {\n        markAsSeen: true,\n        reduxEvents: [\n          \"scratch-gui/navigation/ACTIVATE_TAB\",\n          \"scratch-gui/mode/SET_PLAYER\",\n          \"fontsLoaded/SET_FONTS_LOADED\",\n          \"scratch-gui/locales/SELECT_LOCALE\",\n          \"scratch-gui/targets/UPDATE_TARGET_LIST\",\n        ],\n        reduxCondition: (state) =>\n          state.scratchGui.editorTab.activeTabIndex === 1 && !state.scratchGui.mode.isPlayerOnly,\n      });\n      const zoomControlsContainer = canvasControls.querySelector(\"[class^='paint-editor_zoom-controls']\");\n      const canvasContainer = document.querySelector(\"[class^='paint-editor_canvas-container']\");\n\n      // TODO: when leaving the paint editor, references to the old zoom controls are kept around by our DOM\n      // Need to investigate whether this leaks memory or other issues.\n      const oldZoomControlsContainer = paintEditorControlsContainer.querySelector(\n        \"[class^='paint-editor_zoom-controls']\"\n      );\n      if (oldZoomControlsContainer) {\n        oldZoomControlsContainer.parentNode.removeChild(oldZoomControlsContainer);\n      }\n\n      paintEditorControlsContainer.appendChild(zoomControlsContainer);\n      canvasControls.appendChild(paintEditorControlsContainer);\n      canvasContainer.appendChild(settingsPage);\n\n      if (!hasRunOnce) {\n        hasRunOnce = true;\n        const groupClass = zoomControlsContainer.firstChild.className;\n        const buttonClass = zoomControlsContainer.firstChild.firstChild.className;\n        const imageClass = zoomControlsContainer.firstChild.firstChild.firstChild.className;\n        for (const el of document.querySelectorAll(\".sa-onion-group\")) {\n          el.className += \" \" + groupClass;\n        }\n        for (const el of document.querySelectorAll(\".sa-onion-button\")) {\n          el.className += \" \" + buttonClass;\n        }\n        for (const el of document.querySelectorAll(\".sa-onion-image\")) {\n          el.className += \" \" + imageClass;\n        }\n      }\n\n      if (settings.enabled) {\n        updateOnionLayers();\n      }\n    }\n  };\n\n  injectPaper();\n  injectPaperCanvas();\n  controlsLoop();\n}\n","/* generated by pull.js */\nimport _js from \"./userscript.js\";\nimport _css from \"!css-loader!./style.css\";\nexport const resources = {\n  \"userscript.js\": _js,\n  \"style.css\": _css,\n};\n","export default async function ({ addon, msg, global, console }) {\n  const brand = Symbol();\n\n  const setIsPicking = (picking) => document.body.classList.toggle(\"sa-stage-color-picker-picking\", picking);\n\n  addon.tab.redux.initialize();\n  addon.tab.redux.addEventListener(\"statechanged\", (e) => {\n    const action = e.detail.action;\n\n    // Do not process events emitted by ourselves.\n    if (action[brand]) {\n      return;\n    }\n\n    if (!addon.self.disabled && action.type === \"scratch-paint/eye-dropper/ACTIVATE_COLOR_PICKER\") {\n      setIsPicking(true);\n\n      // When scratch-paint's color picker is activated, also activate scratch-gui's color picker.\n      addon.tab.redux.dispatch({\n        type: \"scratch-gui/color-picker/ACTIVATE_COLOR_PICKER\",\n        callback: (color) => {\n          // callback is called from reducer; do not dispatch events in reducer\n          queueMicrotask(() => {\n            // By the time we get here, scratch-paint will have already deactivated its eye dropper.\n            // If we were to just call the callback, the color would indeed update, but the sliders\n            // in the color selector would not update.\n            // https://github.com/LLK/scratch-paint/blob/970b72c3e75d0ad44ab54e403a44786ca5f45512/src/containers/color-picker.jsx#L64\n            // To work around this, we will re-enable the color picker before running the callback.\n            addon.tab.redux.dispatch({\n              ...action,\n              [brand]: true\n            });\n            action.callback(color);\n            if (action.previousMode) {\n              action.previousMode.activate();\n            }\n            addon.tab.redux.dispatch({\n              type: \"scratch-paint/eye-dropper/DEACTIVATE_COLOR_PICKER\",\n              [brand]: true\n            });\n            setIsPicking(false);\n          });\n        }\n      });\n    }\n\n    if (action.type === \"scratch-paint/eye-dropper/DEACTIVATE_COLOR_PICKER\") {\n      setIsPicking(false);\n\n      // When someone selects a color in the scratch-paint picker, cancel the scratch-gui picker\n      if (addon.tab.redux.state.scratchGui.colorPicker.active) {\n        addon.tab.redux.dispatch({\n          type: \"scratch-gui/color-picker/DEACTIVATE_COLOR_PICKER\",\n          [brand]: true\n        });\n      }\n    }\n  });\n}\n","/* generated by pull.js */\nimport _js from \"./userscript.js\";\nexport const resources = {\n  \"userscript.js\": _js,\n};\n","export default async function ({ addon, msg, console }) {\n  const vm = addon.tab.traps.vm;\n  const Blockly = await addon.tab.traps.getBlockly();\n\n  // editor-searchable-dropdowns relies on this value\n  const RENAME_BROADCAST_MESSAGE_ID = \"RENAME_BROADCAST_MESSAGE_ID\";\n\n  const BROADCAST_MESSAGE_TYPE = Blockly.BROADCAST_MESSAGE_VARIABLE_TYPE;\n\n  const _dropdownCreate = Blockly.FieldVariable.dropdownCreate;\n  Blockly.FieldVariable.dropdownCreate = function () {\n    const options = _dropdownCreate.call(this);\n    if (\n      !addon.self.disabled &&\n      this.defaultType_ === BROADCAST_MESSAGE_TYPE &&\n      // Disable when workspace has no actual broadcast to rename\n      this.sourceBlock_.workspace.getVariableTypes().includes(\"broadcast_msg\")\n    ) {\n      options.push([msg(\"RENAME_BROADCAST\"), RENAME_BROADCAST_MESSAGE_ID]);\n    }\n    return options;\n  };\n\n  const _onItemSelected = Blockly.FieldVariable.prototype.onItemSelected;\n  Blockly.FieldVariable.prototype.onItemSelected = function (menu, menuItem) {\n    const workspace = this.sourceBlock_.workspace;\n    if (this.sourceBlock_ && workspace) {\n      if (menuItem.getValue() === RENAME_BROADCAST_MESSAGE_ID) {\n        promptRenameBroadcast(workspace, this.variable_);\n        return;\n      }\n    }\n    return _onItemSelected.call(this, menu, menuItem);\n  };\n\n  const resetVMCaches = () => {\n    const blockContainers = new Set(vm.runtime.targets.map((i) => i.blocks));\n    for (const blocks of blockContainers) {\n      blocks.resetCache();\n    }\n  };\n\n  const addUndoRedoHook = (callback) => {\n    const eventQueue = Blockly.Events.FIRE_QUEUE_;\n    // After a rename is emitted, some unrelated garbage events also get emitted\n    // So we should trap the first event\n    const undoItem = eventQueue[0];\n    const originalRun = undoItem.run;\n    undoItem.run = function (isRedo) {\n      originalRun.call(this, isRedo);\n      callback(isRedo);\n    };\n  };\n\n  const renameBroadcastInVM = (id, newName) => {\n    // Editor's rename won't completely rename the variable.\n    const vmVariable = vm.runtime.getTargetForStage().variables[id];\n    vmVariable.name = newName;\n    vmVariable.value = newName;\n\n    // Update all references to the broadcast. Broadcasts won't work if these\n    // don't match.\n    const blockContainers = new Set(vm.runtime.targets.map((i) => i.blocks));\n    for (const blockContainer of blockContainers) {\n      for (const block of Object.values(blockContainer._blocks)) {\n        const broadcastOption = block.fields && block.fields.BROADCAST_OPTION;\n        if (broadcastOption && broadcastOption.id === id) {\n          broadcastOption.value = newName;\n        }\n      }\n    }\n\n    resetVMCaches();\n  };\n\n  const renameBroadcast = (workspace, id, oldName, newName) => {\n    // Rename in editor. Undo/redo will work automatically.\n    workspace.renameVariableById(id, newName);\n\n    // Rename in VM. Need to manually implement undo/redo.\n    renameBroadcastInVM(id, newName);\n\n    addUndoRedoHook((isRedo) => {\n      if (isRedo) {\n        renameBroadcastInVM(id, newName);\n      } else {\n        renameBroadcastInVM(id, oldName);\n      }\n    });\n  };\n\n  const mergeBroadcast = (workspace, oldId, oldName, newName) => {\n    const newVmVariable = vm.runtime.getTargetForStage().lookupBroadcastByInputValue(newName);\n    const newId = newVmVariable.id;\n\n    // Merge in editor. Undo/redo will work automatically for this.\n    // Use group so that everything here is undone/redone at the same time.\n    Blockly.Events.setGroup(true);\n    for (const block of workspace.getAllBlocks()) {\n      for (const input of block.inputList) {\n        for (const field of input.fieldRow) {\n          if (field.name === \"BROADCAST_OPTION\" && field.getValue() === oldId) {\n            field.setValue(newId);\n          }\n        }\n      }\n    }\n    // Remove the broadcast from the editor so it doesn't appear in dropdowns.\n    // Undo/redo will work automatically for this.\n    workspace.deleteVariableById(oldId);\n    Blockly.Events.setGroup(false);\n\n    // Merge in VM to update sprites that aren't open. Need to manually implement undo/redo.\n    // To figure out how to undo this operation, we first figure out which blocks we're\n    // going to touch and keep hold of that list.\n    const vmBlocksToUpdate = [];\n    const blockContainers = new Set(vm.runtime.targets.map((i) => i.blocks));\n    for (const blockContainer of blockContainers) {\n      for (const block of Object.values(blockContainer._blocks)) {\n        const broadcastOption = block.fields && block.fields.BROADCAST_OPTION;\n        if (broadcastOption && broadcastOption.id === oldId) {\n          vmBlocksToUpdate.push(block);\n        }\n      }\n    }\n    const applyVmEdits = (isRedo) => {\n      const idToReplaceWith = isRedo ? newId : oldId;\n      const nameToReplaceWith = isRedo ? newName : oldName;\n      for (const block of vmBlocksToUpdate) {\n        const broadcastOption = block.fields.BROADCAST_OPTION;\n        broadcastOption.id = idToReplaceWith;\n        broadcastOption.value = nameToReplaceWith;\n      }\n      resetVMCaches();\n    };\n    applyVmEdits(true);\n\n    // Earlier editor updates are guaranteed to generate at least 1 event that we can hook as the\n    // broadcast block must exist in the editor for the user to rename it.\n    addUndoRedoHook((isRedo) => {\n      applyVmEdits(isRedo);\n    });\n  };\n\n  const promptRenameBroadcast = (workspace, variable) => {\n    const modalTitle = msg(\"RENAME_BROADCAST_MODAL_TITLE\");\n    const oldName = variable.name;\n    const id = variable.getId();\n    const promptText = msg(\"RENAME_BROADCAST_TITLE\", { name: oldName });\n    const promptDefaultText = oldName;\n\n    Blockly.prompt(\n      promptText,\n      promptDefaultText,\n      function (newName) {\n        newName = Blockly.Variables.trimName_(newName);\n        const nameIsEmpty = !newName;\n        if (nameIsEmpty) {\n          return;\n        }\n\n        const variableAlreadyExists = !!workspace.getVariable(newName, BROADCAST_MESSAGE_TYPE);\n        if (variableAlreadyExists) {\n          mergeBroadcast(workspace, id, oldName, newName);\n        } else {\n          renameBroadcast(workspace, id, oldName, newName);\n        }\n      },\n      modalTitle,\n      BROADCAST_MESSAGE_TYPE\n    );\n  };\n\n  const updateExistingMenuGenerators = () => {\n    const workspace = Blockly.getMainWorkspace();\n    const flyout = workspace && workspace.getFlyout();\n    if (workspace && flyout) {\n      const allBlocks = [...workspace.getAllBlocks(), ...flyout.getWorkspace().getAllBlocks()];\n      for (const block of allBlocks) {\n        for (const input of block.inputList) {\n          for (const field of input.fieldRow) {\n            if (field instanceof Blockly.FieldVariable) {\n              field.menuGenerator_ = Blockly.FieldVariable.dropdownCreate;\n            }\n          }\n        }\n      }\n    }\n  };\n\n  updateExistingMenuGenerators();\n}\n","export const getHexRegex = () => /^#?[0-9a-fA-F]{3,8}$/;\n\nexport const normalizeHex = (input) => {\n  let hex = String(input);\n  if (!getHexRegex().test(hex)) return \"#000000\";\n  if (!hex.startsWith(\"#\")) hex = `#${hex}`;\n  if (hex.length === 4) {\n    const [_, r, g, b] = hex;\n    hex = `#${r}${r}${g}${g}${b}${b}`;\n  }\n  return hex.toLowerCase();\n};\n","export default class RateLimiter {\n  constructor(wait) {\n    this.timeout = null;\n    this.callback = null;\n    this.wait = wait;\n  }\n\n  abort(call = true) {\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n      if (call) this.callback();\n      this.timeout = this.callback = null;\n    }\n  }\n\n  limit(callback) {\n    this.abort(false);\n    this.callback = callback;\n    this.timeout = setTimeout(() => {\n      this.timeout = this.callback = null;\n      callback();\n    }, this.wait);\n  }\n}\n","// TinyColor v1.4.2\n// https://github.com/bgrins/TinyColor\n// Brian Grinstead, MIT License\n// Modified to use ES6 export\n\nconst tinycolor = (function(Math) {\n\nvar trimLeft = /^\\s+/,\n    trimRight = /\\s+$/,\n    tinyCounter = 0,\n    mathRound = Math.round,\n    mathMin = Math.min,\n    mathMax = Math.max,\n    mathRandom = Math.random;\n\nfunction tinycolor (color, opts) {\n\n    color = (color) ? color : '';\n    opts = opts || { };\n\n    // If input is already a tinycolor, return itself\n    if (color instanceof tinycolor) {\n       return color;\n    }\n    // If we are called as a function, call using new instead\n    if (!(this instanceof tinycolor)) {\n        return new tinycolor(color, opts);\n    }\n\n    var rgb = inputToRGB(color);\n    this._originalInput = color,\n    this._r = rgb.r,\n    this._g = rgb.g,\n    this._b = rgb.b,\n    this._a = rgb.a,\n    this._roundA = mathRound(100*this._a) / 100,\n    this._format = opts.format || rgb.format;\n    this._gradientType = opts.gradientType;\n\n    // Don't let the range of [0,255] come back in [0,1].\n    // Potentially lose a little bit of precision here, but will fix issues where\n    // .5 gets interpreted as half of the total, instead of half of 1\n    // If it was supposed to be 128, this was already taken care of by `inputToRgb`\n    if (this._r < 1) { this._r = mathRound(this._r); }\n    if (this._g < 1) { this._g = mathRound(this._g); }\n    if (this._b < 1) { this._b = mathRound(this._b); }\n\n    this._ok = rgb.ok;\n    this._tc_id = tinyCounter++;\n}\n\ntinycolor.prototype = {\n    isDark: function() {\n        return this.getBrightness() < 128;\n    },\n    isLight: function() {\n        return !this.isDark();\n    },\n    isValid: function() {\n        return this._ok;\n    },\n    getOriginalInput: function() {\n      return this._originalInput;\n    },\n    getFormat: function() {\n        return this._format;\n    },\n    getAlpha: function() {\n        return this._a;\n    },\n    getBrightness: function() {\n        //http://www.w3.org/TR/AERT#color-contrast\n        var rgb = this.toRgb();\n        return (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;\n    },\n    getLuminance: function() {\n        //http://www.w3.org/TR/2008/REC-WCAG20-20081211/#relativeluminancedef\n        var rgb = this.toRgb();\n        var RsRGB, GsRGB, BsRGB, R, G, B;\n        RsRGB = rgb.r/255;\n        GsRGB = rgb.g/255;\n        BsRGB = rgb.b/255;\n\n        if (RsRGB <= 0.03928) {R = RsRGB / 12.92;} else {R = Math.pow(((RsRGB + 0.055) / 1.055), 2.4);}\n        if (GsRGB <= 0.03928) {G = GsRGB / 12.92;} else {G = Math.pow(((GsRGB + 0.055) / 1.055), 2.4);}\n        if (BsRGB <= 0.03928) {B = BsRGB / 12.92;} else {B = Math.pow(((BsRGB + 0.055) / 1.055), 2.4);}\n        return (0.2126 * R) + (0.7152 * G) + (0.0722 * B);\n    },\n    setAlpha: function(value) {\n        this._a = boundAlpha(value);\n        this._roundA = mathRound(100*this._a) / 100;\n        return this;\n    },\n    toHsv: function() {\n        var hsv = rgbToHsv(this._r, this._g, this._b);\n        return { h: hsv.h * 360, s: hsv.s, v: hsv.v, a: this._a };\n    },\n    toHsvString: function() {\n        var hsv = rgbToHsv(this._r, this._g, this._b);\n        var h = mathRound(hsv.h * 360), s = mathRound(hsv.s * 100), v = mathRound(hsv.v * 100);\n        return (this._a == 1) ?\n          \"hsv(\"  + h + \", \" + s + \"%, \" + v + \"%)\" :\n          \"hsva(\" + h + \", \" + s + \"%, \" + v + \"%, \"+ this._roundA + \")\";\n    },\n    toHsl: function() {\n        var hsl = rgbToHsl(this._r, this._g, this._b);\n        return { h: hsl.h * 360, s: hsl.s, l: hsl.l, a: this._a };\n    },\n    toHslString: function() {\n        var hsl = rgbToHsl(this._r, this._g, this._b);\n        var h = mathRound(hsl.h * 360), s = mathRound(hsl.s * 100), l = mathRound(hsl.l * 100);\n        return (this._a == 1) ?\n          \"hsl(\"  + h + \", \" + s + \"%, \" + l + \"%)\" :\n          \"hsla(\" + h + \", \" + s + \"%, \" + l + \"%, \"+ this._roundA + \")\";\n    },\n    toHex: function(allow3Char) {\n        return rgbToHex(this._r, this._g, this._b, allow3Char);\n    },\n    toHexString: function(allow3Char) {\n        return '#' + this.toHex(allow3Char);\n    },\n    toHex8: function(allow4Char) {\n        return rgbaToHex(this._r, this._g, this._b, this._a, allow4Char);\n    },\n    toHex8String: function(allow4Char) {\n        return '#' + this.toHex8(allow4Char);\n    },\n    toRgb: function() {\n        return { r: mathRound(this._r), g: mathRound(this._g), b: mathRound(this._b), a: this._a };\n    },\n    toRgbString: function() {\n        return (this._a == 1) ?\n          \"rgb(\"  + mathRound(this._r) + \", \" + mathRound(this._g) + \", \" + mathRound(this._b) + \")\" :\n          \"rgba(\" + mathRound(this._r) + \", \" + mathRound(this._g) + \", \" + mathRound(this._b) + \", \" + this._roundA + \")\";\n    },\n    toPercentageRgb: function() {\n        return { r: mathRound(bound01(this._r, 255) * 100) + \"%\", g: mathRound(bound01(this._g, 255) * 100) + \"%\", b: mathRound(bound01(this._b, 255) * 100) + \"%\", a: this._a };\n    },\n    toPercentageRgbString: function() {\n        return (this._a == 1) ?\n          \"rgb(\"  + mathRound(bound01(this._r, 255) * 100) + \"%, \" + mathRound(bound01(this._g, 255) * 100) + \"%, \" + mathRound(bound01(this._b, 255) * 100) + \"%)\" :\n          \"rgba(\" + mathRound(bound01(this._r, 255) * 100) + \"%, \" + mathRound(bound01(this._g, 255) * 100) + \"%, \" + mathRound(bound01(this._b, 255) * 100) + \"%, \" + this._roundA + \")\";\n    },\n    toName: function() {\n        if (this._a === 0) {\n            return \"transparent\";\n        }\n\n        if (this._a < 1) {\n            return false;\n        }\n\n        return hexNames[rgbToHex(this._r, this._g, this._b, true)] || false;\n    },\n    toFilter: function(secondColor) {\n        var hex8String = '#' + rgbaToArgbHex(this._r, this._g, this._b, this._a);\n        var secondHex8String = hex8String;\n        var gradientType = this._gradientType ? \"GradientType = 1, \" : \"\";\n\n        if (secondColor) {\n            var s = tinycolor(secondColor);\n            secondHex8String = '#' + rgbaToArgbHex(s._r, s._g, s._b, s._a);\n        }\n\n        return \"progid:DXImageTransform.Microsoft.gradient(\"+gradientType+\"startColorstr=\"+hex8String+\",endColorstr=\"+secondHex8String+\")\";\n    },\n    toString: function(format) {\n        var formatSet = !!format;\n        format = format || this._format;\n\n        var formattedString = false;\n        var hasAlpha = this._a < 1 && this._a >= 0;\n        var needsAlphaFormat = !formatSet && hasAlpha && (format === \"hex\" || format === \"hex6\" || format === \"hex3\" || format === \"hex4\" || format === \"hex8\" || format === \"name\");\n\n        if (needsAlphaFormat) {\n            // Special case for \"transparent\", all other non-alpha formats\n            // will return rgba when there is transparency.\n            if (format === \"name\" && this._a === 0) {\n                return this.toName();\n            }\n            return this.toRgbString();\n        }\n        if (format === \"rgb\") {\n            formattedString = this.toRgbString();\n        }\n        if (format === \"prgb\") {\n            formattedString = this.toPercentageRgbString();\n        }\n        if (format === \"hex\" || format === \"hex6\") {\n            formattedString = this.toHexString();\n        }\n        if (format === \"hex3\") {\n            formattedString = this.toHexString(true);\n        }\n        if (format === \"hex4\") {\n            formattedString = this.toHex8String(true);\n        }\n        if (format === \"hex8\") {\n            formattedString = this.toHex8String();\n        }\n        if (format === \"name\") {\n            formattedString = this.toName();\n        }\n        if (format === \"hsl\") {\n            formattedString = this.toHslString();\n        }\n        if (format === \"hsv\") {\n            formattedString = this.toHsvString();\n        }\n\n        return formattedString || this.toHexString();\n    },\n    clone: function() {\n        return tinycolor(this.toString());\n    },\n\n    _applyModification: function(fn, args) {\n        var color = fn.apply(null, [this].concat([].slice.call(args)));\n        this._r = color._r;\n        this._g = color._g;\n        this._b = color._b;\n        this.setAlpha(color._a);\n        return this;\n    },\n    lighten: function() {\n        return this._applyModification(lighten, arguments);\n    },\n    brighten: function() {\n        return this._applyModification(brighten, arguments);\n    },\n    darken: function() {\n        return this._applyModification(darken, arguments);\n    },\n    desaturate: function() {\n        return this._applyModification(desaturate, arguments);\n    },\n    saturate: function() {\n        return this._applyModification(saturate, arguments);\n    },\n    greyscale: function() {\n        return this._applyModification(greyscale, arguments);\n    },\n    spin: function() {\n        return this._applyModification(spin, arguments);\n    },\n\n    _applyCombination: function(fn, args) {\n        return fn.apply(null, [this].concat([].slice.call(args)));\n    },\n    analogous: function() {\n        return this._applyCombination(analogous, arguments);\n    },\n    complement: function() {\n        return this._applyCombination(complement, arguments);\n    },\n    monochromatic: function() {\n        return this._applyCombination(monochromatic, arguments);\n    },\n    splitcomplement: function() {\n        return this._applyCombination(splitcomplement, arguments);\n    },\n    triad: function() {\n        return this._applyCombination(triad, arguments);\n    },\n    tetrad: function() {\n        return this._applyCombination(tetrad, arguments);\n    }\n};\n\n// If input is an object, force 1 into \"1.0\" to handle ratios properly\n// String input requires \"1.0\" as input, so 1 will be treated as 1\ntinycolor.fromRatio = function(color, opts) {\n    if (typeof color == \"object\") {\n        var newColor = {};\n        for (var i in color) {\n            if (color.hasOwnProperty(i)) {\n                if (i === \"a\") {\n                    newColor[i] = color[i];\n                }\n                else {\n                    newColor[i] = convertToPercentage(color[i]);\n                }\n            }\n        }\n        color = newColor;\n    }\n\n    return tinycolor(color, opts);\n};\n\n// Given a string or object, convert that input to RGB\n// Possible string inputs:\n//\n//     \"red\"\n//     \"#f00\" or \"f00\"\n//     \"#ff0000\" or \"ff0000\"\n//     \"#ff000000\" or \"ff000000\"\n//     \"rgb 255 0 0\" or \"rgb (255, 0, 0)\"\n//     \"rgb 1.0 0 0\" or \"rgb (1, 0, 0)\"\n//     \"rgba (255, 0, 0, 1)\" or \"rgba 255, 0, 0, 1\"\n//     \"rgba (1.0, 0, 0, 1)\" or \"rgba 1.0, 0, 0, 1\"\n//     \"hsl(0, 100%, 50%)\" or \"hsl 0 100% 50%\"\n//     \"hsla(0, 100%, 50%, 1)\" or \"hsla 0 100% 50%, 1\"\n//     \"hsv(0, 100%, 100%)\" or \"hsv 0 100% 100%\"\n//\nfunction inputToRGB(color) {\n\n    var rgb = { r: 0, g: 0, b: 0 };\n    var a = 1;\n    var s = null;\n    var v = null;\n    var l = null;\n    var ok = false;\n    var format = false;\n\n    if (typeof color == \"string\") {\n        color = stringInputToObject(color);\n    }\n\n    if (typeof color == \"object\") {\n        if (isValidCSSUnit(color.r) && isValidCSSUnit(color.g) && isValidCSSUnit(color.b)) {\n            rgb = rgbToRgb(color.r, color.g, color.b);\n            ok = true;\n            format = String(color.r).substr(-1) === \"%\" ? \"prgb\" : \"rgb\";\n        }\n        else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.v)) {\n            s = convertToPercentage(color.s);\n            v = convertToPercentage(color.v);\n            rgb = hsvToRgb(color.h, s, v);\n            ok = true;\n            format = \"hsv\";\n        }\n        else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.l)) {\n            s = convertToPercentage(color.s);\n            l = convertToPercentage(color.l);\n            rgb = hslToRgb(color.h, s, l);\n            ok = true;\n            format = \"hsl\";\n        }\n\n        if (color.hasOwnProperty(\"a\")) {\n            a = color.a;\n        }\n    }\n\n    a = boundAlpha(a);\n\n    return {\n        ok: ok,\n        format: color.format || format,\n        r: mathMin(255, mathMax(rgb.r, 0)),\n        g: mathMin(255, mathMax(rgb.g, 0)),\n        b: mathMin(255, mathMax(rgb.b, 0)),\n        a: a\n    };\n}\n\n\n// Conversion Functions\n// --------------------\n\n// `rgbToHsl`, `rgbToHsv`, `hslToRgb`, `hsvToRgb` modified from:\n// <http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript>\n\n// `rgbToRgb`\n// Handle bounds / percentage checking to conform to CSS color spec\n// <http://www.w3.org/TR/css3-color/>\n// *Assumes:* r, g, b in [0, 255] or [0, 1]\n// *Returns:* { r, g, b } in [0, 255]\nfunction rgbToRgb(r, g, b){\n    return {\n        r: bound01(r, 255) * 255,\n        g: bound01(g, 255) * 255,\n        b: bound01(b, 255) * 255\n    };\n}\n\n// `rgbToHsl`\n// Converts an RGB color value to HSL.\n// *Assumes:* r, g, and b are contained in [0, 255] or [0, 1]\n// *Returns:* { h, s, l } in [0,1]\nfunction rgbToHsl(r, g, b) {\n\n    r = bound01(r, 255);\n    g = bound01(g, 255);\n    b = bound01(b, 255);\n\n    var max = mathMax(r, g, b), min = mathMin(r, g, b);\n    var h, s, l = (max + min) / 2;\n\n    if(max == min) {\n        h = s = 0; // achromatic\n    }\n    else {\n        var d = max - min;\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n        switch(max) {\n            case r: h = (g - b) / d + (g < b ? 6 : 0); break;\n            case g: h = (b - r) / d + 2; break;\n            case b: h = (r - g) / d + 4; break;\n        }\n\n        h /= 6;\n    }\n\n    return { h: h, s: s, l: l };\n}\n\n// `hslToRgb`\n// Converts an HSL color value to RGB.\n// *Assumes:* h is contained in [0, 1] or [0, 360] and s and l are contained [0, 1] or [0, 100]\n// *Returns:* { r, g, b } in the set [0, 255]\nfunction hslToRgb(h, s, l) {\n    var r, g, b;\n\n    h = bound01(h, 360);\n    s = bound01(s, 100);\n    l = bound01(l, 100);\n\n    function hue2rgb(p, q, t) {\n        if(t < 0) t += 1;\n        if(t > 1) t -= 1;\n        if(t < 1/6) return p + (q - p) * 6 * t;\n        if(t < 1/2) return q;\n        if(t < 2/3) return p + (q - p) * (2/3 - t) * 6;\n        return p;\n    }\n\n    if(s === 0) {\n        r = g = b = l; // achromatic\n    }\n    else {\n        var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n        var p = 2 * l - q;\n        r = hue2rgb(p, q, h + 1/3);\n        g = hue2rgb(p, q, h);\n        b = hue2rgb(p, q, h - 1/3);\n    }\n\n    return { r: r * 255, g: g * 255, b: b * 255 };\n}\n\n// `rgbToHsv`\n// Converts an RGB color value to HSV\n// *Assumes:* r, g, and b are contained in the set [0, 255] or [0, 1]\n// *Returns:* { h, s, v } in [0,1]\nfunction rgbToHsv(r, g, b) {\n\n    r = bound01(r, 255);\n    g = bound01(g, 255);\n    b = bound01(b, 255);\n\n    var max = mathMax(r, g, b), min = mathMin(r, g, b);\n    var h, s, v = max;\n\n    var d = max - min;\n    s = max === 0 ? 0 : d / max;\n\n    if(max == min) {\n        h = 0; // achromatic\n    }\n    else {\n        switch(max) {\n            case r: h = (g - b) / d + (g < b ? 6 : 0); break;\n            case g: h = (b - r) / d + 2; break;\n            case b: h = (r - g) / d + 4; break;\n        }\n        h /= 6;\n    }\n    return { h: h, s: s, v: v };\n}\n\n// `hsvToRgb`\n// Converts an HSV color value to RGB.\n// *Assumes:* h is contained in [0, 1] or [0, 360] and s and v are contained in [0, 1] or [0, 100]\n// *Returns:* { r, g, b } in the set [0, 255]\n function hsvToRgb(h, s, v) {\n\n    h = bound01(h, 360) * 6;\n    s = bound01(s, 100);\n    v = bound01(v, 100);\n\n    var i = Math.floor(h),\n        f = h - i,\n        p = v * (1 - s),\n        q = v * (1 - f * s),\n        t = v * (1 - (1 - f) * s),\n        mod = i % 6,\n        r = [v, q, p, p, t, v][mod],\n        g = [t, v, v, q, p, p][mod],\n        b = [p, p, t, v, v, q][mod];\n\n    return { r: r * 255, g: g * 255, b: b * 255 };\n}\n\n// `rgbToHex`\n// Converts an RGB color to hex\n// Assumes r, g, and b are contained in the set [0, 255]\n// Returns a 3 or 6 character hex\nfunction rgbToHex(r, g, b, allow3Char) {\n\n    var hex = [\n        pad2(mathRound(r).toString(16)),\n        pad2(mathRound(g).toString(16)),\n        pad2(mathRound(b).toString(16))\n    ];\n\n    // Return a 3 character hex if possible\n    if (allow3Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1)) {\n        return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0);\n    }\n\n    return hex.join(\"\");\n}\n\n// `rgbaToHex`\n// Converts an RGBA color plus alpha transparency to hex\n// Assumes r, g, b are contained in the set [0, 255] and\n// a in [0, 1]. Returns a 4 or 8 character rgba hex\nfunction rgbaToHex(r, g, b, a, allow4Char) {\n\n    var hex = [\n        pad2(mathRound(r).toString(16)),\n        pad2(mathRound(g).toString(16)),\n        pad2(mathRound(b).toString(16)),\n        pad2(convertDecimalToHex(a))\n    ];\n\n    // Return a 4 character hex if possible\n    if (allow4Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1) && hex[3].charAt(0) == hex[3].charAt(1)) {\n        return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0) + hex[3].charAt(0);\n    }\n\n    return hex.join(\"\");\n}\n\n// `rgbaToArgbHex`\n// Converts an RGBA color to an ARGB Hex8 string\n// Rarely used, but required for \"toFilter()\"\nfunction rgbaToArgbHex(r, g, b, a) {\n\n    var hex = [\n        pad2(convertDecimalToHex(a)),\n        pad2(mathRound(r).toString(16)),\n        pad2(mathRound(g).toString(16)),\n        pad2(mathRound(b).toString(16))\n    ];\n\n    return hex.join(\"\");\n}\n\n// `equals`\n// Can be called with any tinycolor input\ntinycolor.equals = function (color1, color2) {\n    if (!color1 || !color2) { return false; }\n    return tinycolor(color1).toRgbString() == tinycolor(color2).toRgbString();\n};\n\ntinycolor.random = function() {\n    return tinycolor.fromRatio({\n        r: mathRandom(),\n        g: mathRandom(),\n        b: mathRandom()\n    });\n};\n\n\n// Modification Functions\n// ----------------------\n// Thanks to less.js for some of the basics here\n// <https://github.com/cloudhead/less.js/blob/master/lib/less/functions.js>\n\nfunction desaturate(color, amount) {\n    amount = (amount === 0) ? 0 : (amount || 10);\n    var hsl = tinycolor(color).toHsl();\n    hsl.s -= amount / 100;\n    hsl.s = clamp01(hsl.s);\n    return tinycolor(hsl);\n}\n\nfunction saturate(color, amount) {\n    amount = (amount === 0) ? 0 : (amount || 10);\n    var hsl = tinycolor(color).toHsl();\n    hsl.s += amount / 100;\n    hsl.s = clamp01(hsl.s);\n    return tinycolor(hsl);\n}\n\nfunction greyscale(color) {\n    return tinycolor(color).desaturate(100);\n}\n\nfunction lighten (color, amount) {\n    amount = (amount === 0) ? 0 : (amount || 10);\n    var hsl = tinycolor(color).toHsl();\n    hsl.l += amount / 100;\n    hsl.l = clamp01(hsl.l);\n    return tinycolor(hsl);\n}\n\nfunction brighten(color, amount) {\n    amount = (amount === 0) ? 0 : (amount || 10);\n    var rgb = tinycolor(color).toRgb();\n    rgb.r = mathMax(0, mathMin(255, rgb.r - mathRound(255 * - (amount / 100))));\n    rgb.g = mathMax(0, mathMin(255, rgb.g - mathRound(255 * - (amount / 100))));\n    rgb.b = mathMax(0, mathMin(255, rgb.b - mathRound(255 * - (amount / 100))));\n    return tinycolor(rgb);\n}\n\nfunction darken (color, amount) {\n    amount = (amount === 0) ? 0 : (amount || 10);\n    var hsl = tinycolor(color).toHsl();\n    hsl.l -= amount / 100;\n    hsl.l = clamp01(hsl.l);\n    return tinycolor(hsl);\n}\n\n// Spin takes a positive or negative amount within [-360, 360] indicating the change of hue.\n// Values outside of this range will be wrapped into this range.\nfunction spin(color, amount) {\n    var hsl = tinycolor(color).toHsl();\n    var hue = (hsl.h + amount) % 360;\n    hsl.h = hue < 0 ? 360 + hue : hue;\n    return tinycolor(hsl);\n}\n\n// Combination Functions\n// ---------------------\n// Thanks to jQuery xColor for some of the ideas behind these\n// <https://github.com/infusion/jQuery-xcolor/blob/master/jquery.xcolor.js>\n\nfunction complement(color) {\n    var hsl = tinycolor(color).toHsl();\n    hsl.h = (hsl.h + 180) % 360;\n    return tinycolor(hsl);\n}\n\nfunction triad(color) {\n    var hsl = tinycolor(color).toHsl();\n    var h = hsl.h;\n    return [\n        tinycolor(color),\n        tinycolor({ h: (h + 120) % 360, s: hsl.s, l: hsl.l }),\n        tinycolor({ h: (h + 240) % 360, s: hsl.s, l: hsl.l })\n    ];\n}\n\nfunction tetrad(color) {\n    var hsl = tinycolor(color).toHsl();\n    var h = hsl.h;\n    return [\n        tinycolor(color),\n        tinycolor({ h: (h + 90) % 360, s: hsl.s, l: hsl.l }),\n        tinycolor({ h: (h + 180) % 360, s: hsl.s, l: hsl.l }),\n        tinycolor({ h: (h + 270) % 360, s: hsl.s, l: hsl.l })\n    ];\n}\n\nfunction splitcomplement(color) {\n    var hsl = tinycolor(color).toHsl();\n    var h = hsl.h;\n    return [\n        tinycolor(color),\n        tinycolor({ h: (h + 72) % 360, s: hsl.s, l: hsl.l}),\n        tinycolor({ h: (h + 216) % 360, s: hsl.s, l: hsl.l})\n    ];\n}\n\nfunction analogous(color, results, slices) {\n    results = results || 6;\n    slices = slices || 30;\n\n    var hsl = tinycolor(color).toHsl();\n    var part = 360 / slices;\n    var ret = [tinycolor(color)];\n\n    for (hsl.h = ((hsl.h - (part * results >> 1)) + 720) % 360; --results; ) {\n        hsl.h = (hsl.h + part) % 360;\n        ret.push(tinycolor(hsl));\n    }\n    return ret;\n}\n\nfunction monochromatic(color, results) {\n    results = results || 6;\n    var hsv = tinycolor(color).toHsv();\n    var h = hsv.h, s = hsv.s, v = hsv.v;\n    var ret = [];\n    var modification = 1 / results;\n\n    while (results--) {\n        ret.push(tinycolor({ h: h, s: s, v: v}));\n        v = (v + modification) % 1;\n    }\n\n    return ret;\n}\n\n// Utility Functions\n// ---------------------\n\ntinycolor.mix = function(color1, color2, amount) {\n    amount = (amount === 0) ? 0 : (amount || 50);\n\n    var rgb1 = tinycolor(color1).toRgb();\n    var rgb2 = tinycolor(color2).toRgb();\n\n    var p = amount / 100;\n\n    var rgba = {\n        r: ((rgb2.r - rgb1.r) * p) + rgb1.r,\n        g: ((rgb2.g - rgb1.g) * p) + rgb1.g,\n        b: ((rgb2.b - rgb1.b) * p) + rgb1.b,\n        a: ((rgb2.a - rgb1.a) * p) + rgb1.a\n    };\n\n    return tinycolor(rgba);\n};\n\n\n// Readability Functions\n// ---------------------\n// <http://www.w3.org/TR/2008/REC-WCAG20-20081211/#contrast-ratiodef (WCAG Version 2)\n\n// `contrast`\n// Analyze the 2 colors and returns the color contrast defined by (WCAG Version 2)\ntinycolor.readability = function(color1, color2) {\n    var c1 = tinycolor(color1);\n    var c2 = tinycolor(color2);\n    return (Math.max(c1.getLuminance(),c2.getLuminance())+0.05) / (Math.min(c1.getLuminance(),c2.getLuminance())+0.05);\n};\n\n// `isReadable`\n// Ensure that foreground and background color combinations meet WCAG2 guidelines.\n// The third argument is an optional Object.\n//      the 'level' property states 'AA' or 'AAA' - if missing or invalid, it defaults to 'AA';\n//      the 'size' property states 'large' or 'small' - if missing or invalid, it defaults to 'small'.\n// If the entire object is absent, isReadable defaults to {level:\"AA\",size:\"small\"}.\n\n// *Example*\n//    tinycolor.isReadable(\"#000\", \"#111\") => false\n//    tinycolor.isReadable(\"#000\", \"#111\",{level:\"AA\",size:\"large\"}) => false\ntinycolor.isReadable = function(color1, color2, wcag2) {\n    var readability = tinycolor.readability(color1, color2);\n    var wcag2Parms, out;\n\n    out = false;\n\n    wcag2Parms = validateWCAG2Parms(wcag2);\n    switch (wcag2Parms.level + wcag2Parms.size) {\n        case \"AAsmall\":\n        case \"AAAlarge\":\n            out = readability >= 4.5;\n            break;\n        case \"AAlarge\":\n            out = readability >= 3;\n            break;\n        case \"AAAsmall\":\n            out = readability >= 7;\n            break;\n    }\n    return out;\n\n};\n\n// `mostReadable`\n// Given a base color and a list of possible foreground or background\n// colors for that base, returns the most readable color.\n// Optionally returns Black or White if the most readable color is unreadable.\n// *Example*\n//    tinycolor.mostReadable(tinycolor.mostReadable(\"#123\", [\"#124\", \"#125\"],{includeFallbackColors:false}).toHexString(); // \"#112255\"\n//    tinycolor.mostReadable(tinycolor.mostReadable(\"#123\", [\"#124\", \"#125\"],{includeFallbackColors:true}).toHexString();  // \"#ffffff\"\n//    tinycolor.mostReadable(\"#a8015a\", [\"#faf3f3\"],{includeFallbackColors:true,level:\"AAA\",size:\"large\"}).toHexString(); // \"#faf3f3\"\n//    tinycolor.mostReadable(\"#a8015a\", [\"#faf3f3\"],{includeFallbackColors:true,level:\"AAA\",size:\"small\"}).toHexString(); // \"#ffffff\"\ntinycolor.mostReadable = function(baseColor, colorList, args) {\n    var bestColor = null;\n    var bestScore = 0;\n    var readability;\n    var includeFallbackColors, level, size ;\n    args = args || {};\n    includeFallbackColors = args.includeFallbackColors ;\n    level = args.level;\n    size = args.size;\n\n    for (var i= 0; i < colorList.length ; i++) {\n        readability = tinycolor.readability(baseColor, colorList[i]);\n        if (readability > bestScore) {\n            bestScore = readability;\n            bestColor = tinycolor(colorList[i]);\n        }\n    }\n\n    if (tinycolor.isReadable(baseColor, bestColor, {\"level\":level,\"size\":size}) || !includeFallbackColors) {\n        return bestColor;\n    }\n    else {\n        args.includeFallbackColors=false;\n        return tinycolor.mostReadable(baseColor,[\"#fff\", \"#000\"],args);\n    }\n};\n\n\n// Big List of Colors\n// ------------------\n// <http://www.w3.org/TR/css3-color/#svg-color>\nvar names = tinycolor.names = {\n    aliceblue: \"f0f8ff\",\n    antiquewhite: \"faebd7\",\n    aqua: \"0ff\",\n    aquamarine: \"7fffd4\",\n    azure: \"f0ffff\",\n    beige: \"f5f5dc\",\n    bisque: \"ffe4c4\",\n    black: \"000\",\n    blanchedalmond: \"ffebcd\",\n    blue: \"00f\",\n    blueviolet: \"8a2be2\",\n    brown: \"a52a2a\",\n    burlywood: \"deb887\",\n    burntsienna: \"ea7e5d\",\n    cadetblue: \"5f9ea0\",\n    chartreuse: \"7fff00\",\n    chocolate: \"d2691e\",\n    coral: \"ff7f50\",\n    cornflowerblue: \"6495ed\",\n    cornsilk: \"fff8dc\",\n    crimson: \"dc143c\",\n    cyan: \"0ff\",\n    darkblue: \"00008b\",\n    darkcyan: \"008b8b\",\n    darkgoldenrod: \"b8860b\",\n    darkgray: \"a9a9a9\",\n    darkgreen: \"006400\",\n    darkgrey: \"a9a9a9\",\n    darkkhaki: \"bdb76b\",\n    darkmagenta: \"8b008b\",\n    darkolivegreen: \"556b2f\",\n    darkorange: \"ff8c00\",\n    darkorchid: \"9932cc\",\n    darkred: \"8b0000\",\n    darksalmon: \"e9967a\",\n    darkseagreen: \"8fbc8f\",\n    darkslateblue: \"483d8b\",\n    darkslategray: \"2f4f4f\",\n    darkslategrey: \"2f4f4f\",\n    darkturquoise: \"00ced1\",\n    darkviolet: \"9400d3\",\n    deeppink: \"ff1493\",\n    deepskyblue: \"00bfff\",\n    dimgray: \"696969\",\n    dimgrey: \"696969\",\n    dodgerblue: \"1e90ff\",\n    firebrick: \"b22222\",\n    floralwhite: \"fffaf0\",\n    forestgreen: \"228b22\",\n    fuchsia: \"f0f\",\n    gainsboro: \"dcdcdc\",\n    ghostwhite: \"f8f8ff\",\n    gold: \"ffd700\",\n    goldenrod: \"daa520\",\n    gray: \"808080\",\n    green: \"008000\",\n    greenyellow: \"adff2f\",\n    grey: \"808080\",\n    honeydew: \"f0fff0\",\n    hotpink: \"ff69b4\",\n    indianred: \"cd5c5c\",\n    indigo: \"4b0082\",\n    ivory: \"fffff0\",\n    khaki: \"f0e68c\",\n    lavender: \"e6e6fa\",\n    lavenderblush: \"fff0f5\",\n    lawngreen: \"7cfc00\",\n    lemonchiffon: \"fffacd\",\n    lightblue: \"add8e6\",\n    lightcoral: \"f08080\",\n    lightcyan: \"e0ffff\",\n    lightgoldenrodyellow: \"fafad2\",\n    lightgray: \"d3d3d3\",\n    lightgreen: \"90ee90\",\n    lightgrey: \"d3d3d3\",\n    lightpink: \"ffb6c1\",\n    lightsalmon: \"ffa07a\",\n    lightseagreen: \"20b2aa\",\n    lightskyblue: \"87cefa\",\n    lightslategray: \"789\",\n    lightslategrey: \"789\",\n    lightsteelblue: \"b0c4de\",\n    lightyellow: \"ffffe0\",\n    lime: \"0f0\",\n    limegreen: \"32cd32\",\n    linen: \"faf0e6\",\n    magenta: \"f0f\",\n    maroon: \"800000\",\n    mediumaquamarine: \"66cdaa\",\n    mediumblue: \"0000cd\",\n    mediumorchid: \"ba55d3\",\n    mediumpurple: \"9370db\",\n    mediumseagreen: \"3cb371\",\n    mediumslateblue: \"7b68ee\",\n    mediumspringgreen: \"00fa9a\",\n    mediumturquoise: \"48d1cc\",\n    mediumvioletred: \"c71585\",\n    midnightblue: \"191970\",\n    mintcream: \"f5fffa\",\n    mistyrose: \"ffe4e1\",\n    moccasin: \"ffe4b5\",\n    navajowhite: \"ffdead\",\n    navy: \"000080\",\n    oldlace: \"fdf5e6\",\n    olive: \"808000\",\n    olivedrab: \"6b8e23\",\n    orange: \"ffa500\",\n    orangered: \"ff4500\",\n    orchid: \"da70d6\",\n    palegoldenrod: \"eee8aa\",\n    palegreen: \"98fb98\",\n    paleturquoise: \"afeeee\",\n    palevioletred: \"db7093\",\n    papayawhip: \"ffefd5\",\n    peachpuff: \"ffdab9\",\n    peru: \"cd853f\",\n    pink: \"ffc0cb\",\n    plum: \"dda0dd\",\n    powderblue: \"b0e0e6\",\n    purple: \"800080\",\n    rebeccapurple: \"663399\",\n    red: \"f00\",\n    rosybrown: \"bc8f8f\",\n    royalblue: \"4169e1\",\n    saddlebrown: \"8b4513\",\n    salmon: \"fa8072\",\n    sandybrown: \"f4a460\",\n    seagreen: \"2e8b57\",\n    seashell: \"fff5ee\",\n    sienna: \"a0522d\",\n    silver: \"c0c0c0\",\n    skyblue: \"87ceeb\",\n    slateblue: \"6a5acd\",\n    slategray: \"708090\",\n    slategrey: \"708090\",\n    snow: \"fffafa\",\n    springgreen: \"00ff7f\",\n    steelblue: \"4682b4\",\n    tan: \"d2b48c\",\n    teal: \"008080\",\n    thistle: \"d8bfd8\",\n    tomato: \"ff6347\",\n    turquoise: \"40e0d0\",\n    violet: \"ee82ee\",\n    wheat: \"f5deb3\",\n    white: \"fff\",\n    whitesmoke: \"f5f5f5\",\n    yellow: \"ff0\",\n    yellowgreen: \"9acd32\"\n};\n\n// Make it easy to access colors via `hexNames[hex]`\nvar hexNames = tinycolor.hexNames = flip(names);\n\n\n// Utilities\n// ---------\n\n// `{ 'name1': 'val1' }` becomes `{ 'val1': 'name1' }`\nfunction flip(o) {\n    var flipped = { };\n    for (var i in o) {\n        if (o.hasOwnProperty(i)) {\n            flipped[o[i]] = i;\n        }\n    }\n    return flipped;\n}\n\n// Return a valid alpha value [0,1] with all invalid values being set to 1\nfunction boundAlpha(a) {\n    a = parseFloat(a);\n\n    if (isNaN(a) || a < 0 || a > 1) {\n        a = 1;\n    }\n\n    return a;\n}\n\n// Take input from [0, n] and return it as [0, 1]\nfunction bound01(n, max) {\n    if (isOnePointZero(n)) { n = \"100%\"; }\n\n    var processPercent = isPercentage(n);\n    n = mathMin(max, mathMax(0, parseFloat(n)));\n\n    // Automatically convert percentage into number\n    if (processPercent) {\n        n = parseInt(n * max, 10) / 100;\n    }\n\n    // Handle floating point rounding errors\n    if ((Math.abs(n - max) < 0.000001)) {\n        return 1;\n    }\n\n    // Convert into [0, 1] range if it isn't already\n    return (n % max) / parseFloat(max);\n}\n\n// Force a number between 0 and 1\nfunction clamp01(val) {\n    return mathMin(1, mathMax(0, val));\n}\n\n// Parse a base-16 hex value into a base-10 integer\nfunction parseIntFromHex(val) {\n    return parseInt(val, 16);\n}\n\n// Need to handle 1.0 as 100%, since once it is a number, there is no difference between it and 1\n// <http://stackoverflow.com/questions/7422072/javascript-how-to-detect-number-as-a-decimal-including-1-0>\nfunction isOnePointZero(n) {\n    return typeof n == \"string\" && n.indexOf('.') != -1 && parseFloat(n) === 1;\n}\n\n// Check to see if string passed in is a percentage\nfunction isPercentage(n) {\n    return typeof n === \"string\" && n.indexOf('%') != -1;\n}\n\n// Force a hex value to have 2 characters\nfunction pad2(c) {\n    return c.length == 1 ? '0' + c : '' + c;\n}\n\n// Replace a decimal with it's percentage value\nfunction convertToPercentage(n) {\n    if (n <= 1) {\n        n = (n * 100) + \"%\";\n    }\n\n    return n;\n}\n\n// Converts a decimal to a hex value\nfunction convertDecimalToHex(d) {\n    return Math.round(parseFloat(d) * 255).toString(16);\n}\n// Converts a hex value to a decimal\nfunction convertHexToDecimal(h) {\n    return (parseIntFromHex(h) / 255);\n}\n\nvar matchers = (function() {\n\n    // <http://www.w3.org/TR/css3-values/#integers>\n    var CSS_INTEGER = \"[-\\\\+]?\\\\d+%?\";\n\n    // <http://www.w3.org/TR/css3-values/#number-value>\n    var CSS_NUMBER = \"[-\\\\+]?\\\\d*\\\\.\\\\d+%?\";\n\n    // Allow positive/negative integer/number.  Don't capture the either/or, just the entire outcome.\n    var CSS_UNIT = \"(?:\" + CSS_NUMBER + \")|(?:\" + CSS_INTEGER + \")\";\n\n    // Actual matching.\n    // Parentheses and commas are optional, but not required.\n    // Whitespace can take the place of commas or opening paren\n    var PERMISSIVE_MATCH3 = \"[\\\\s|\\\\(]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")\\\\s*\\\\)?\";\n    var PERMISSIVE_MATCH4 = \"[\\\\s|\\\\(]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")\\\\s*\\\\)?\";\n\n    return {\n        CSS_UNIT: new RegExp(CSS_UNIT),\n        rgb: new RegExp(\"rgb\" + PERMISSIVE_MATCH3),\n        rgba: new RegExp(\"rgba\" + PERMISSIVE_MATCH4),\n        hsl: new RegExp(\"hsl\" + PERMISSIVE_MATCH3),\n        hsla: new RegExp(\"hsla\" + PERMISSIVE_MATCH4),\n        hsv: new RegExp(\"hsv\" + PERMISSIVE_MATCH3),\n        hsva: new RegExp(\"hsva\" + PERMISSIVE_MATCH4),\n        hex3: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\n        hex6: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,\n        hex4: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\n        hex8: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/\n    };\n})();\n\n// `isValidCSSUnit`\n// Take in a single string / number and check to see if it looks like a CSS unit\n// (see `matchers` above for definition).\nfunction isValidCSSUnit(color) {\n    return !!matchers.CSS_UNIT.exec(color);\n}\n\n// `stringInputToObject`\n// Permissive string parsing.  Take in a number of formats, and output an object\n// based on detected format.  Returns `{ r, g, b }` or `{ h, s, l }` or `{ h, s, v}`\nfunction stringInputToObject(color) {\n\n    color = color.replace(trimLeft,'').replace(trimRight, '').toLowerCase();\n    var named = false;\n    if (names[color]) {\n        color = names[color];\n        named = true;\n    }\n    else if (color == 'transparent') {\n        return { r: 0, g: 0, b: 0, a: 0, format: \"name\" };\n    }\n\n    // Try to match string input using regular expressions.\n    // Keep most of the number bounding out of this function - don't worry about [0,1] or [0,100] or [0,360]\n    // Just return an object and let the conversion functions handle that.\n    // This way the result will be the same whether the tinycolor is initialized with string or object.\n    var match;\n    if ((match = matchers.rgb.exec(color))) {\n        return { r: match[1], g: match[2], b: match[3] };\n    }\n    if ((match = matchers.rgba.exec(color))) {\n        return { r: match[1], g: match[2], b: match[3], a: match[4] };\n    }\n    if ((match = matchers.hsl.exec(color))) {\n        return { h: match[1], s: match[2], l: match[3] };\n    }\n    if ((match = matchers.hsla.exec(color))) {\n        return { h: match[1], s: match[2], l: match[3], a: match[4] };\n    }\n    if ((match = matchers.hsv.exec(color))) {\n        return { h: match[1], s: match[2], v: match[3] };\n    }\n    if ((match = matchers.hsva.exec(color))) {\n        return { h: match[1], s: match[2], v: match[3], a: match[4] };\n    }\n    if ((match = matchers.hex8.exec(color))) {\n        return {\n            r: parseIntFromHex(match[1]),\n            g: parseIntFromHex(match[2]),\n            b: parseIntFromHex(match[3]),\n            a: convertHexToDecimal(match[4]),\n            format: named ? \"name\" : \"hex8\"\n        };\n    }\n    if ((match = matchers.hex6.exec(color))) {\n        return {\n            r: parseIntFromHex(match[1]),\n            g: parseIntFromHex(match[2]),\n            b: parseIntFromHex(match[3]),\n            format: named ? \"name\" : \"hex\"\n        };\n    }\n    if ((match = matchers.hex4.exec(color))) {\n        return {\n            r: parseIntFromHex(match[1] + '' + match[1]),\n            g: parseIntFromHex(match[2] + '' + match[2]),\n            b: parseIntFromHex(match[3] + '' + match[3]),\n            a: convertHexToDecimal(match[4] + '' + match[4]),\n            format: named ? \"name\" : \"hex8\"\n        };\n    }\n    if ((match = matchers.hex3.exec(color))) {\n        return {\n            r: parseIntFromHex(match[1] + '' + match[1]),\n            g: parseIntFromHex(match[2] + '' + match[2]),\n            b: parseIntFromHex(match[3] + '' + match[3]),\n            format: named ? \"name\" : \"hex\"\n        };\n    }\n\n    return false;\n}\n\nfunction validateWCAG2Parms(parms) {\n    // return valid WCAG2 parms for isReadable.\n    // If input parms are invalid, return {\"level\":\"AA\", \"size\":\"small\"}\n    var level, size;\n    parms = parms || {\"level\":\"AA\", \"size\":\"small\"};\n    level = (parms.level || \"AA\").toUpperCase();\n    size = (parms.size || \"small\").toLowerCase();\n    if (level !== \"AA\" && level !== \"AAA\") {\n        level = \"AA\";\n    }\n    if (size !== \"small\" && size !== \"large\") {\n        size = \"small\";\n    }\n    return {\"level\":level, \"size\":size};\n}\n\n/*// Node: Export function\nif (typeof module !== \"undefined\" && module.exports) {\n    module.exports = tinycolor;\n}\n// AMD/requirejs: Define the module\nelse if (typeof define === 'function' && define.amd) {\n    define(function () {return tinycolor;});\n}\n// Browser: Expose to window\nelse {\n    window.tinycolor = tinycolor;\n}*/\n\nreturn tinycolor;\n\n})(Math);\n\nexport default tinycolor;\n"],"mappings":";;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACPA;AAAA;;;;;;;;;;;;ACAA;AAAA;;;;;;;;;;;;ACAA;AAAA;;;;;;;;;;;;ACAA;AAAA;;;;;;;;;;;;ACAA;AAAA;;;;;;;;;;;;ACAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AADA;;;;;;;;;;;;ACFA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;;;;;;;;;;;;AClBA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AADA;;;;;;;;;;;;ACFA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACXA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AADA;;;;;;;;;;;;ACFA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAGA;AACA;AACA;AAEA;AADA;AAKA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;AAEA;AACA;AAAA;AACA;AACA;AAEA;AAEA;AAQA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACtGA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACVA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AADA;;;;;;;;;;;;ACFA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC9PA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AADA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AAGA;AACA;AAAA;AAAA;AAFA;AAKA;AACA;AAAA;AAAA;AAFA;AAKA;AACA;AAAA;AAAA;AAFA;AAKA;AAEA;AACA;AAAA;AAAA;AAFA;AAMA;AACA;AAAA;AAAA;AAFA;AAKA;AACA;AAAA;AAAA;AAFA;AAKA;AAEA;AACA;AAAA;AAAA;AAFA;AAKA;AACA;AAAA;AAAA;AAFA;AAMA;AACA;AAAA;AAAA;AAFA;AAKA;AAEA;AACA;AAAA;AAAA;AAFA;AAKA;AACA;AAAA;AAAA;AAFA;AAKA;AACA;AAAA;AAAA;AAFA;AAMA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AACA;AACA;AACA;AAGA;AACA;AAAA;AAAA;AAFA;AAKA;AAEA;AACA;AAAA;AAAA;AAFA;AAMA;AAGA;AACA;AAAA;AAAA;AAFA;AAKA;AAEA;AACA;AAAA;AAAA;AAFA;AAMA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AACA;AACA;AACA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AACA;AACA;AACA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AACA;AACA;AACA;AAGA;AADA;AAIA;AAEA;AACA;AAAA;AAAA;AAFA;AAMA;AAGA;AACA;AAAA;AAAA;AAFA;AAKA;AACA;AAAA;AAAA;AAFA;AAKA;AAEA;AADA;AAKA;AAEA;AADA;AAKA;AACA;AACA;AACA;AAEA;AADA;AAKA;AADA;AAIA;AAGA;AADA;AAIA;AADA;AAIA;AAEA;AADA;AAIA;AADA;AAKA;AAGA;AADA;AAIA;AADA;AAIA;AADA;AAIA;AADA;AAIA;AAEA;AADA;AAKA;AADA;AAIA;AADA;AAIA;AADA;AAIA;AAEA;AADA;AAIA;AADA;AAKA;AADA;AAIA;AADA;AAIA;AAEA;AADA;AAIA;AADA;AAIA;AADA;AAKA;AADA;AAIA;AAEA;AADA;AAIA;AADA;AAIA;AADA;AAIA;AADA;AAKA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AACA;AACA;AACA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AACA;AACA;AACA;AAGA;AACA;AAAA;AAAA;AAFA;AAKA;AAEA;AACA;AAAA;AAAA;AAFA;AAMA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AACA;AACA;AACA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AAGA;AADA;AAIA;AAEA;AADA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AAJA;AAMA;AACA;AACA;AADA;AAGA;AAJA;AAMA;AACA;AACA;AADA;AAGA;AAJA;AAMA;AAEA;AACA;AAFA;AAOA;AAGA;AACA;AAFA;AAMA;AAIA;AACA;AAFA;AAKA;AAGA;AACA;AACA;AADA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAAA;AAIA;AAEA;AACA;AAAA;AACA;AACA;AACA;AAGA;AACA;AAAA;AACA;AAGA;AAVA;AAYA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AANA;AAQA;AACA;AAAA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAIA;AACA;AAAA;AACA;AAMA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;;;;;;;;;;;;AC90BA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AAPA;AASA;AAGA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACvFA;AAAA;AAAA;AAEA;AACA;AACA;;;;;;;;;;;;ACJA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAGA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAIA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAEA;AAGA;AACA;AACA;AAEA;AADA;AAIA;;;;;;;;;;;;ACrJA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;;;;;;;;;;;;ACHA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAjCA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAKA;AAPA;AASA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAHA;AAOA;AACA;AACA;AACA;AAnBA;AAqBA;AACA;AACA;AAAA;AAEA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAUA;AACA;AACA;AACA;AACA;AACA;AANA;AASA;AACA;AACA;AACA;AACA;AALA;AAQA;AACA;AACA;AACA;AACA;AALA;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAXA;AAaA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AAEA;AACA;AACA;AAGA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAEA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AADA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AADA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAEA;AACA;AACA;AADA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AAAA;AAEA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAQA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAGA;AACA;AACA;AADA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AASA;AADA;AAWA;AACA;AACA;AAEA;AACA;AACA;AAGA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAKA;AAEA;AACA;AACA;AAGA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAKA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AANA;AAQA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAGA;AAEA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAGA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AAEA;AACA;AAEA;AACA;AAGA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AAKA;AAMA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAaA;AADA;AAkBA;AACA;AACA;AACA;AACA;AAGA;AACA;AAAA;AACA;AACA;AAEA;AAOA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AA/rEA;AACA;AAgsEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AArCA;AACA;AAsCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AArBA;AACA;AAsBA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC/wEA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AA7FA;AA+FA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;;;;;;;;;;;;AClGA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAvBA;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;;;;;;;;;;;;ACHA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AArCA;AAuCA;AAAA;AAAA;AAAA;;;;;;;;;;;;AC1CA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AAEA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AA3BA;AA6BA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;;;;;;;;;;;;AC9CA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AADA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AAAA;AACA;AADA;AAEA;AAFA;AAAA;AAAA;AAAA;AAMA;AANA;AACA;AAOA;AAMA;AACA;AAAA;AAEA;AAEA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAzHA;AACA;AA0HA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AAAA;AAGA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAGA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAIA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAEA;AAAA;AAGA;AAAA;AAGA;AACA;AACA;AAtFA;AACA;AAuFA;AACA;AACA;;;;;;;;;;;;AC1NA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAOA;AADA;AA+BA;AACA;AACA;;;;;;;;;;;;AClDA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;AAKA;AAGA;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AAGA;AACA;AAFA;AAIA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AArCA;AAuCA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAEA;AACA;AAFA;AAIA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;;;;;;;;;;;;ACnTA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;;;;;;;;;;;;;;;;;;;;ACHA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AAEA;AAEA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AANA;AACA;AAQA;AAMA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAYA;AACA;AACA;AACA;AACA;AACA;AAaA;AACA;AACA;AACA;AACA;AACA;AASA;AACA;AACA;AACA;AACA;AACA;AAAA;AAIA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AApCA;AACA;AAqCA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAKA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAKA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AADA;AAIA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAFA;AAQA;AACA;AACA;AACA;AACA;AACA;AALA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AALA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAIA;AACA;AAAA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AADA;AAGA;AACA;AAAA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAIA;AAAA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AALA;AAQA;AACA;AACA;AACA;AACA;AALA;AAQA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AANA;AASA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AAAA;AAIA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AAPA;AASA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlBA;AAuBA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAfA;AAoBA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAfA;AAoBA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AClyCA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AADA;;;;;;;;;;;;ACFA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AALA;AAQA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AALA;AAQA;;;;;;;;;;;;AC/CA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAHA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AACA;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AAGA;AACA;AACA;AACA;AADA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAGA;AACA;AACA;AADA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AAGA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AADA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AADA;AACA;AAAA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AADA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AATA;AAWA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAGA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAOA;AATA;AAYA;AACA;AAGA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACr0BA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;;;;;;;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAxBA;AA0BA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;;;;;;;;;;;;AC1DA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AADA;;;;;;;;;;;;ACFA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AACA;AAAA;AACA;AACA;AAAA;AAIA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AADA;AACA;AAGA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAGA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAEA;AAIA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC/LA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;;;;;;;;;;;;ACXA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvBA;;;;;;;;;;;;ACAA;AAAA;AACA;AACA;AACA;AAEA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAOA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAOA;AAGA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAGA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAGA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvNA;AA2NA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAQA;AAIA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AAHA;AAKA;AAGA;AACA;AACA;AACA;AACA;AADA;AAEA;AACA;AACA;AAEA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAHA;AACA;AAKA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AACA;AACA;AACA;AADA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AACA;AACA;AACA;AADA;AAEA;AACA;AACA;AAEA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAHA;AACA;AAIA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AACA;AACA;AACA;AADA;AAEA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA;AAAA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AACA;AACA;AACA;AADA;AAEA;AACA;AAMA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AADA;AAEA;AACA;AAOA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AADA;AAEA;AAOA;AACA;AAGA;AACA;AACA;AADA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AAIA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AAAA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAJA;AAOA;AACA;AAIA;AACA;AAEA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AAEA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAVA;AACA;AAWA;AAEA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AArJA;AACA;AAwJA;AAIA;AAEA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AAGA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAXA;AAaA;AAGA;AACA;AACA;AACA;AADA;AACA;AACA;AAGA;AACA;AACA;AACA;AADA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AACA;AACA;AACA;AADA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;AACA;;;;A","sourceRoot":""}